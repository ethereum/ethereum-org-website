---
title: "Газ та комісії"
metaTitle: "Газ та комісії Ethereum: технічний огляд"
description: "Дізнайтеся про комісії за газ в Ethereum, як вони розраховуються та яку роль відіграють у безпеці мережі й обробці транзакцій."
lang: uk
---

Газ має важливе значення для мережі Ethereum. Це паливо, яке дозволяє йому працювати, так само, як автомобілю потрібен бензин, щоб їхати.

## Передумови {#prerequisites}

Щоб краще зрозуміти цю сторінку, радимо спочатку ознайомитися з [транзакціями](/developers/docs/transactions/) та [EVM](/developers/docs/evm/).

## Що таке газ? {#what-is-gas}

Газ - це одиниця вимірювання кількості обчислювальних ресурсів, необхідних для виконання конкретних операцій у мережі Ethereum.

Оскільки кожна транзакція Ethereum вимагає обчислювальних ресурсів для її виконання, ці ресурси повинні бути оплачені, щоб гарантувати, що Ethereum не буде вразливим до спаму і не застрягне в нескінченних обчислювальних циклах. Оплата за обчислення здійснюється у вигляді плати за газ.

Плата за газ — це **кількість газу, використаного для виконання операції, помножена на вартість одиниці газу**. Плата сплачується незалежно від того, успішна транзакція чи ні.

![Схема, що показує, де потрібен газ в операціях EVM](./gas.png)
_Схема адаптована з [Ethereum EVM illustrated](https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf)_

Плата за газ сплачується в нативній валюті Ethereum - ефірі (ETH). Ціни на газ зазвичай вказуються в gwei, які є номіналом ETH. Кожен gwei дорівнює одній мільярдній ETH (0.000000001 ETH або 10<sup>-9</sup> ETH).

Наприклад, замість того, щоб сказати, що ваш газ коштує 0.000000001 ефіру, ви можете сказати, що ваш газ коштує 1 gwei.

Слово "gwei" є скороченням від "giga-wei", що означає "мільярд wei". Один gwei дорівнює одному мільярду wei. Сам Wei (названий на честь [Вея Дая](https://wikipedia.org/wiki/Wei_Dai), автора [b-money](https://www.investopedia.com/terms/b/bmoney.asp)) є найменшою одиницею ETH.

## Як розраховується плата за газ? {#how-are-gas-fees-calculated}

Ви можете встановити кількість газу, яку ви готові сплатити, коли надсилаєте транзакцію. Пропонуючи певну кількість газу, ви претендуєте на те, щоб ваша транзакція була включена в наступний блок. Якщо ви запропонуєте занадто мало, валідатори з меншою ймовірністю виберуть вашу транзакцію для включення, а це означає, що ваша транзакція може бути проведена із затримкою або взагалі не буде виконана. Якщо ви запропонуєте занадто багато, ви можете втратити частину ETH. Отже, як визначити, скільки платити?

Загальна сума газу, яку ви сплачуєте, поділяється на два компоненти: `базова комісія` та `пріоритетна комісія` (чайові).

`Базова комісія` встановлюється протоколом — ви повинні заплатити принаймні цю суму, щоб ваша транзакція вважалася дійсною. `Пріоритетна комісія` — це чайові, які ви додаєте до базової комісії, щоб зробити вашу транзакцію привабливою для валідаторів, аби вони обрали її для включення до наступного блоку.

Транзакція, у якій сплачується лише `базова комісія`, є технічно дійсною, але навряд чи буде включена, оскільки вона не пропонує валідаторам жодних стимулів, щоб обрати її замість будь-якої іншої транзакції. «Правильна» `пріоритетна` комісія визначається завантаженістю мережі на момент надсилання вашої транзакції — якщо попит високий, вам, можливо, доведеться встановити вищу `пріоритетну` комісію, але коли попит менший, ви можете платити менше.

Наприклад, скажімо, Джордан повинен заплатити Тейлору 1 ETH. Для здійснення переказу ETH потрібно 21 000 одиниць газу, а базова комісія становить 10 gwei. Джордан включає чайові у розмірі 2 gwei.

Загальна плата тепер дорівнюватиме:

`використані одиниці газу * (базова комісія + пріоритетна комісія)`

де `базова комісія` — це значення, встановлене протоколом, а `пріоритетна комісія` — це значення, встановлене користувачем як чайові для валідатора.

наприклад, `21 000 * (10 + 2) = 252 000 gwei` (0,000252 ETH).

Коли Джордан надішле гроші, з його рахунку буде знято 1.000252 ETH. Тейлору буде зараховано 1.0000 ETH. Валідатор отримає чайові в розмірі 0.000042 ETH. `Базова комісія` в розмірі 0,00021 ETH спалюється.

### Базова комісія {#base-fee}

Кожен блок має базову комісію, яка слугує як резервна ціна. Щоб мати можливість доєднатися в блок, запропонована ціна за газ повинна бути також, як ціна за базову комісію. Базова комісія розраховується незалежно від поточного блоку й натомість визначається попередніми блоками, що робить комісії за транзакції більш передбачуваними для користувачів. Коли блок створюється, ця **базова комісія «спалюється»**, вилучаючи її з обігу.

Базова комісія розраховується за формулою, яка порівнює розмір попереднього блоку (кількість газу, використаного для всіх транзакцій) із цільовим розміром (половина ліміту газу). Базова комісія буде збільшуватися або зменшуватися максимум на 12,5 % за блок, якщо цільовий розмір блоку відповідно перевищує або є меншим за цільовий. Таке експоненціальне зростання комісії робить економічно невигідним, щоб розмір блоку залишався високим нескінченно довго.

| Номер блоку | Включений газ |    Збільшення комісії |  Поточна фіксована комісія |
| ----------- | ------------: | --------------------: | -------------------------: |
| 1           |        18 млн |                   0 % |                   100 гвей |
| 2           |        36 млн |                   0 % |                   100 гвей |
| 3           |        36 млн | 12.5% | 112.5 гвей |
| 4           |        36 млн | 12.5% | 126.6 гвей |
| 5           |        36 млн | 12.5% | 142.4 гвей |
| 6           |        36 млн | 12.5% | 160.2 гвей |
| 7           |        36 млн | 12.5% | 180.2 гвей |
| 8           |        36 млн | 12.5% | 202.7 гвей |

У таблиці вище наведено приклад з використанням 36 мільйонів як ліміту газу. Дотримуючись цього прикладу, для створення транзакції в блоці номер 9 гаманець повідомить користувачеві з упевненістю, що **максимальна базова комісія**, яка буде додана до наступного блоку, становить `поточна базова комісія * 112,5%` або `202,7 gwei * 112,5% = 228,1 gwei`.

Також важливо відзначити, що ми навряд чи побачимо тривалі періоди повних блоків через швидкість, з якою збільшується базова плата перед повним блоком.

| Номер блоку                                         |                                       Включений газ |    Збільшення комісії |                           Поточна фіксована комісія |
| --------------------------------------------------- | --------------------------------------------------: | --------------------: | --------------------------------------------------: |
| 30                                                  |                                              36 млн | 12.5% |                         2705.6 гвей |
| ... | ... | 12.5% | ... |
| 50                                                  |                                              36 млн | 12.5% |                        28531.3 гвей |
| ... | ... | 12.5% | ... |
| 100                                                 |                                              36 млн | 12.5% |                     10302608.6 гвей |

### Пріоритетна комісія (чайові) {#priority-fee}

Пріоритетна комісія (чайові) стимулює валідаторів максимізувати кількість транзакцій у блоці, обмежуючись лише лімітом газу блоку. Без чайових раціональний валідатор може включати менше або навіть нуль транзакцій без жодних прямих штрафів на рівні виконання або консенсусу, оскільки винагороди за стейкінг не залежать від того, скільки транзакцій знаходиться в блоці. Крім того, чайові дозволяють користувачам перебивати ставки інших за пріоритет у тому ж блоці, ефективно сигналізуючи про терміновість.

### Максимальна комісія {#maxfee}

Для виконання транзакції в мережі, користувачі можуть задати максимальний ліміт, який вони готові заплатити за те, щоб транзакція відбулась. Цей необов'язковий параметр відомий як `maxFeePerGas`. Щоб транзакція була виконана, максимальна комісія повинна перевищувати суму фіксованої комісії та чайових. Відправнику транзакції повертається різниця між максимальною комісією та сумою базової комісії з чайовими.

### Розмір блоку {#block-size}

Кожен блок має цільовий розмір, що дорівнює половині поточного ліміту газу, але розмір блоків буде збільшуватися або зменшуватися відповідно до попиту в мережі, доки не буде досягнуто ліміту блоку (2x цільового розміру блоку). Протокол досягає рівноважного середнього розміру блоку на цільовому рівні через процес _tâtonnement_. Це означає, що якщо розмір блоку перевищує цільовий розмір блоку, протокол збільшить базову плату за наступний блок. Аналогічно, протокол зменшить базову плату, якщо розмір блоку менше цільового розміру блоку.

Сума коригування базової плати пропорційна тому, наскільки сильно відрізняється розмір поточного блоку від цільового. Це лінійний розрахунок від -12,5 % для порожнього блоку, 0 % для цільового розміру, до +12,5 % для блоку, що досягає ліміту газу. Ліміт газу може з часом коливатися на основі сигналів валідаторів, а також через оновлення мережі. Ви можете [переглянути зміни ліміту газу з часом тут](https://eth.blockscout.com/stats/averageGasLimit?interval=threeMonths).

[Детальніше про блоки](/developers/docs/blocks/)

### Розрахунок плати за газ на практиці {#calculating-fees-in-practice}

Ви можете чітко вказати, скільки ви готові заплатити, щоб ваша транзакція була виконана. Однак більшість провайдерів гаманців автоматично встановлюють рекомендовану комісію за транзакцію (базова комісія + рекомендована комісія за пріоритет), щоб зменшити кількість складнощів, які доводиться долати своїм користувачам.

## Чому існує газовий збір? {#why-do-gas-fees-exist}

Якщо коротко, то газовий збір допомагає підтримувати безпеку мережі Ethereum. Вимагаючи плату за кожне обчислення, виконане в мережі, ми запобігаємо розсилці спаму зловмисними особами. Щоб уникнути випадкових або ворожих нескінченних циклів або інших обчислювальних витрат у коді, кожна транзакція повинна встановлювати обмеження на кількість обчислювальних кроків виконання коду. Основною одиницею вимірювання є "газ".

Хоча транзакція має ліміт, будь-який газ, не використаний у транзакції, повертається користувачеві (наприклад, повертається `максимальна комісія - (базова комісія + чайові)`).

![Схема, що показує, як відшкодовується невикористаний газ](../transactions/gas-tx.png)
_Схема адаптована з [Ethereum EVM illustrated](https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf)_

## Що таке ліміт газу? {#what-is-gas-limit}

Ліміт газу - це максимальна кількість газу, яку ви готові витратити за конкретну транзакцію. Складніші транзакції, що включають [смарт-контракти](/developers/docs/smart-contracts/), потребують більшої обчислювальної роботи, тому для них потрібен вищий ліміт газу, ніж для простого платежу. Стандартний переказ ETH вимагає обмеження газу в 21 000 одиниць газу.

Наприклад, якщо ви встановите ліміт газу 50,000 для простого переказу ETH, EVM споживатиме 21,000, а ви отримаєте решту 29,000. Однак, якщо ви вкажете занадто мало газу, наприклад, ліміт газу 20 000 для простого переказу ETH, транзакція зазнає невдачі на етапі перевірки. Її буде відхилено до включення в блок, і газ не буде спожито. З іншого боку, якщо під час виконання транзакції закінчується газ (наприклад, смарт-контракт використовує весь газ на півдорозі), EVM скасує будь-які зміни, але весь наданий газ все одно буде спожито за виконану роботу.

## Які причини високої оплати газу? {#why-can-gas-fees-get-so-high}

Висока вартість газу спричинена популярністю Ethereum. Якщо попит занадто великий, користувачі повинні пропонувати більші суми чайових, щоб спробувати перебити ставки інших користувачів. Вищі чайові можуть збільшити ймовірність того, що ваша транзакція потрапить у наступний блок. Крім того, складніші додатки для смарт-контрактів можуть виконувати багато операцій для підтримки своїх функцій, що змушує їх споживати багато газу.

## Ініціативи щодо зниження витрат на газ {#initiatives-to-reduce-gas-costs}

[Оновлення масштабованості](/roadmap/) Ethereum мають зрештою вирішити деякі проблеми з комісією за газ, що, своєю чергою, дасть змогу платформі обробляти тисячі транзакцій на секунду та масштабуватися в усьому світі.

Масштабування рівня 2 є основною ініціативою для значного покращення витрат на газ, користувацького досвіду та масштабування.

[Детальніше про масштабування на рівні 2](/developers/docs/scaling/#layer-2-scaling)

## Моніторинг плати за газ {#monitoring-gas-fees}

Якщо ви хочете слідкувати за цінами на газ, щоб мати можливість надсилати ETH дешевше, ви можете використовувати багато різних інструментів, таких як:

- [Etherscan](https://etherscan.io/gastracker) _Оцінювач ціни на газ для транзакцій_
- [Blockscout](https://eth.blockscout.com/gas-tracker) _Оцінювач ціни на газ для транзакцій з відкритим вихідним кодом_
- [ETH Gas Tracker](https://www.ethgastracker.com/) _Відстежуйте ціни на газ в Ethereum та на L2, щоб зменшити комісії за транзакції та заощадити гроші_
- [Blocknative ETH Gas Estimator](https://chrome.google.com/webstore/detail/blocknative-eth-gas-estim/ablbagjepecncofimgjmdpnhnfjiecfm) _Розширення для Chrome для оцінки газу, що підтримує як застарілі транзакції типу 0, так і транзакції типу 2 EIP-1559._
- [Cryptoneur Gas Fees Calculator](https://www.cryptoneur.xyz/gas-fees-calculator) _Розраховуйте комісії за газ у вашій місцевій валюті для різних типів транзакцій у мережах Mainnet, Arbitrum і Polygon._

## Пов’язані інструменти {#related-tools}

- [Blocknative's Gas Platform](https://www.blocknative.com/gas) _API для оцінки газу на основі глобальної платформи даних мемпулу від Blocknative_
- [Gas Network](https://gas.network) Ончейн-оракули газу. Підтримка понад 35 мереж.

## Для подальшого читання {#further-reading}

- [Пояснення газу в Ethereum](https://defiprime.com/gas)
- [Зменшення споживання газу вашими смарт-контрактами](https://medium.com/coinmonks/8-ways-of-reducing-the-gas-consumption-of-your-smart-contracts-9a506b339c0a)
- [Стратегії оптимізації газу для розробників](https://www.alchemy.com/overviews/solidity-gas-optimization)
- [Документація EIP-1559](https://eips.ethereum.org/EIPS/eip-1559).
- [Ресурси EIP-1559 від Тіма Бейко](https://hackmd.io/@timbeiko/1559-resources)
- [EIP-1559: відділення механізмів від мемів](https://web.archive.org/web/20241126205908/https://research.2077.xyz/eip-1559-separating-mechanisms-from-memes)
