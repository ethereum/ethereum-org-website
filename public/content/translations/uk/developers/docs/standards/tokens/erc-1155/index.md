---
title: Стандарт Мультитокена ERC-1155
description: Дізнайтеся про ERC-1155, стандарт мультитокенів, що поєднує взаємозамінні та невзаємозамінні токени в одному контракті.
lang: uk
---

## Вступ {#introduction}

Стандартний інтерфейс для контрактів, які керують кількома типами маркерів. Один розгорнутий контракт може містити будь-яку комбінацію взаємозамінних токенів, невзаємозамінних токенів або інших конфігурацій (наприклад, напіввзаємозамінних токенів).

**Що означає Стандарт Мультитокенів?**

Ідея проста і спрямована на створення інтерфейсу смарт-контракту, який може представляти та керувати будь-якою кількістю взаємозамінних і незмінних типів маркерів. Таким чином, токен ERC-1155 може виконувати ті самі функції, що й токени [ERC-20](/developers/docs/standards/tokens/erc-20/) та [ERC-721](/developers/docs/standards/tokens/erc-721/), і навіть обидва одночасно. Він покращує функціональність стандартів ERC-20 і ERC-721, роблячи його більш ефективним і виправляючи очевидні помилки впровадження.

Токен ERC-1155 повністю описаний у [EIP-1155](https://eips.ethereum.org/EIPS/eip-1155).

## Передумови {#prerequisites}

Щоб краще зрозуміти цю сторінку, ми рекомендуємо вам спочатку прочитати про [стандарти токенів](/developers/docs/standards/tokens/), [ERC-20](/developers/docs/standards/tokens/erc-20/) та [ERC-721](/developers/docs/standards/tokens/erc-721/).

## Функції та особливості ERC-1155: {#body}

- [Пакетна передача](#batch_transfers): передача кількох активів за один виклик.
- [Пакетний баланс](#batch_balance): отримання балансів кількох активів за один виклик.
- [Пакетне затвердження](#batch_approval): затвердження всіх токенів для адреси.
- [Хуки](#receive_hook): хук для отримання токенів.
- [Підтримка NFT](#nft_support): якщо пропозиція дорівнює 1, токен розглядається як NFT.
- [Правила безпечного переказу](#safe_transfer_rule): набір правил для безпечного переказу.

### Пакетні перекази {#batch-transfers}

Пакетна передача працює дуже схоже на звичайну передачу ERC-20. Розгляньмо звичайну функцію `transferFrom` ERC-20:

```solidity
// ERC-20
function transferFrom(address from, address to, uint256 value) external returns (bool);

// ERC-1155
function safeBatchTransferFrom(
    address _from,
    address _to,
    uint256[] calldata _ids,
    uint256[] calldata _values,
    bytes calldata _data
) external;
```

Єдина відмінність у ERC-1155 полягає в тому, що ми передаємо значення у вигляді масиву, а також передаємо масив ідентифікаторів. Наприклад, якщо задано `ids=[3, 6, 13]` та `values=[100, 200, 5]`, то перекази будуть такими:

1. Переказ 100 токенів з ідентифікатором 3 з адреси `_from` на адресу `_to`.
2. Переказ 200 токенів з ідентифікатором 6 з адреси `_from` на адресу `_to`.
3. Переказ 5 токенів з ідентифікатором 13 з адреси `_from` на адресу `_to`.

У ERC-1155 є лише `transferFrom`, немає `transfer`. Щоб використовувати цю функцію як звичайний `transfer`, просто вкажіть адресу відправника (`from`) як адресу, що викликає функцію.

### Пакетний баланс {#batch-balance}

Відповідний виклик `balanceOf` в ERC-20 так само має партнерську функцію з пакетною підтримкою. Нагадуємо, це версія ERC-20:

```solidity
// ERC-20
function balanceOf(address owner) external view returns (uint256);

// ERC-1155
function balanceOfBatch(
    address[] calldata _owners,
    uint256[] calldata _ids
) external view returns (uint256[] memory);
```

Ще простіше для виклику балансу, ми можемо отримати кілька балансів за один виклик. Ми передаємо масив власників, а потім масив ідентифікаторів токенів.

Наприклад, для `_ids=[3, 6, 13]` та `_owners=[0xbeef..., 0x1337..., 0x1111...]` повернене значення буде таким:

```solidity
[
    balanceOf(0xbeef...),
    balanceOf(0x1337...),
    balanceOf(0x1111...)
]
```

### Пакетне затвердження {#batch-approval}

```solidity
// ERC-1155
function setApprovalForAll(
    address _operator,
    bool _approved
) external;

function isApprovedForAll(
    address _owner,
    address _operator
) external view returns (bool);
```

Затвердження дещо відрізняються від ERC-20. Замість затвердження певних сум, ви встановлюєте оператора як затвердженого або не затвердженого через `setApprovalForAll`.

Перевірити поточний статус можна за допомогою `isApprovedForAll`. Як бачите, це операція «все або нічого». Ви не можете визначити, скільки токенів затвердити або навіть який клас токену.

Це навмисно розроблено з урахуванням простоти. Ви можете схвалити все лише для однієї адреси.

### Хук отримання {#receive-hook}

```solidity
function onERC1155BatchReceived(
    address _operator,
    address _from,
    uint256[] calldata _ids,
    uint256[] calldata _values,
    bytes calldata _data
) external returns(bytes4);
```

Завдяки підтримці [EIP-165](https://eips.ethereum.org/EIPS/eip-165) стандарт ERC-1155 підтримує хуки отримання лише для смарт-контрактів. Функція хуку повинна повертати магічне попередньо визначене значення bytes4, яке задається як:

```solidity
bytes4(keccak256("onERC1155BatchReceived(address,address,uint256[],uint256[],bytes)"))
```

Коли приймаючий контракт повертає це значення, передбачається, що контракт приймає передачу і знає, як поводитися з токенами ERC-1155. Чудово, більше жодних застряглих токенів у контракті!

### Підтримка NFT {#nft-support}

Коли запас тільки один, токен по суті є невзаємозамінним токеном (NFT). І як стандарт для ERC-721, ви можете визначити URL-адресу метаданих. URL-адресу можуть читати й змінювати клієнти; дивіться [тут](https://eips.ethereum.org/EIPS/eip-1155#metadata).

### Правило безпечного переказу {#safe-transfer-rule}

У попередніх поясненнях ми вже торкнулися кількох правил безпечного перенесення. Але давайте розглянемо найважливіші з правил:

1. Той, хто викликає, має бути затверджений для витрати токенів з адреси `_from`, або той, хто викликає, має бути `_from`.
2. Виклик переадресації має повернутися, якщо
   1. Адреса `_to` — 0.
   2. Довжина `_ids` не дорівнює довжині `_values`.
   3. будь-який із балансів власника(-ів) для токена(-ів) у `_ids` є меншим за відповідну суму(-и) у `_values`, що надсилається одержувачу.
   4. виникає будь-яка інша помилка.

_Примітка_: усі пакетні функції, включно з хуком, також існують у версіях без пакетної обробки. Це зроблено для ефективності використання газу, оскільки передача лише одного активу, ймовірно, все ще буде найбільш поширеним способом. Ми виключили їх для простоти в поясненнях, включаючи правила безпечного перенесення. Назви ідентичні, просто видаліть «Пакет».

## Для подальшого читання {#further-reading}

- [EIP-1155: стандарт мультитокенів](https://eips.ethereum.org/EIPS/eip-1155)
- [ERC-1155: документація OpenZeppelin](https://docs.openzeppelin.com/contracts/5.x/erc1155)
- [ERC-1155: репозиторій на GitHub](https://github.com/enjin/erc-1155)
- [Alchemy NFT API](https://www.alchemy.com/docs/reference/nft-api-quickstart)
