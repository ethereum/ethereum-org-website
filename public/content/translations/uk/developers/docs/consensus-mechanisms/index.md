---
title: "Механізми консенсусу"
description: "Пояснення консенсусних протоколів у розподілених системах та їхньої ролі в Ethereum."
lang: uk
---

Термін «механізм консенсусу» часто використовується в розмовній мові для позначення протоколів «доказ частки», «підтвердження роботи» або «доказ повноважень». Однак це лише компоненти в механізмах консенсусу, які захищають від [Sybil-атак](/glossary/#sybil-attack). Механізми консенсусу — це повний набір ідей, протоколів і стимулів, які дають змогу розподіленому набору вузлів узгодити стан блокчейну.

## Передумови {#prerequisites}

Щоб краще зрозуміти цю сторінку, радимо спершу прочитати наш [вступ до Ethereum](/developers/docs/intro-to-ethereum/).

## Що таке консенсус? {#what-is-consensus}

Під консенсусом маємо на увазі досягнення загальної угоди. Уявіть групу людей що йдуть в кіно. Якщо немає розбіжностей щодо запропонованого вибору фільму, то консенсус досягнуто. Якщо є розбіжності, група повинна мати засоби, щоб вирішити, який фільм дивитися. В крайніх випадках група врешті-решт розколеться.

Що стосується блокчейну Ethereum, процес є формалізованим, і досягнення консенсусу означає, що принаймні 66% вузлів у мережі погоджуються щодо глобального стану мережі.

## Що таке механізм консенсусу? {#what-is-a-consensus-mechanism}

Термін «механізм консенсусу» стосується всього набору протоколів, стимулів та ідей, які дають змогу мережі вузлів погодитися зі станом блокчейну.

Ethereum використовує механізм консенсусу на основі доказу частки, криптоекономічна безпека якого забезпечується набором винагород і штрафів, що застосовуються до капіталу, заблокованого стейкерами. Ця структура стимулів заохочує окремих стейкерів керувати чесними валідаторами, карає тих, хто цього не робить, і створює надзвичайно високу вартість атаки на мережу.

Потім існує протокол, який регулює, як обираються чесні валідатори для пропозиції чи перевірки блоків, обробки транзакцій та голосування за їхнє бачення верхівки ланцюга. У рідкісних ситуаціях, коли кілька блоків знаходяться в одній позиції поблизу голови ланцюжка, існує механізм вибору форку, який вибирає блоки, що утворюють «найважчий» ланцюжок, виміряний за кількістю валідаторів, які проголосували за блоки, зважені за балансом їхнього застейканого ефіру.

Деякі поняття, важливі для консенсусу, не визначені явно в коді, наприклад, додаткова безпека, що забезпечується потенційною позасмуговою соціальною координацією як останньою лінією захисту від атак на мережу.

Ці компоненти разом утворюють механізм консенсусу.

## Типи механізмів консенсусу {#types-of-consensus-mechanisms}

### На основі підтвердження роботи {#proof-of-work}

Як і Bitcoin, Ethereum колись використовував протокол консенсусу на основі **підтвердження роботи (PoW)**.

#### Створення блоків {#pow-block-creation}

Майнери змагаються за створення нових блоків, заповнених обробленими транзакціями. Переможець ділиться новим блоком з рештою мережі та заробляє свіжо випущений ETH. Перемагає в гонці той комп'ютер, який найшвидше розв'яже математичну головоломку. Це створює криптографічний зв'язок між поточним блоком і попереднім блоком. Розгадування цієї головоломки-це робота в "доказовій роботі". Потім канонічний ланцюжок визначається за правилом вибору форка, яке вибирає набір блоків, для майнінгу яких було виконано найбільше роботи.

#### Безпека {#pow-security}

Мережа захищена тим фактом, що для обману ланцюга вам знадобиться 51% обчислювальної потужності мережі. Це вимагало б таких величезних інвестицій у обладнання та енергію; ви, ймовірно, витратите більше, ніж отримаєте.

Докладніше про [підтвердження роботи](/developers/docs/consensus-mechanisms/pow/)

### На основі доказу частки {#proof-of-stake}

Зараз Ethereum використовує протокол консенсусу на основі **доказу частки (PoS)**.

#### Створення блоків {#pos-block-creation}

Валідатори створюють блоки. У кожному слоті випадковим чином обирається один валідатор, який буде пропонувати блок. Їхній консенсус-клієнт запитує пакет транзакцій як «корисне навантаження для виконання» у свого парного клієнта виконання. Вони загортають це в дані консенсусу, щоб сформувати блок, який вони надсилають іншим вузлам у мережі Ethereum. За створення цього блоку надається винагорода в ETH. У рідкісних випадках, коли для одного слоту існує кілька можливих блоків, або вузли дізнаються про блоки в різний час, алгоритм вибору форку обирає блок, який утворює ланцюжок із найбільшою вагою атестацій (де вага — це кількість валідаторів, що атестують, масштабована за їхнім балансом ETH).

#### Безпека {#pos-security}

Система доказу частки є крипто-економічно безпечною, оскільки зловмисник, який намагається взяти під контроль ланцюжок, повинен знищити величезну кількість ETH. Система винагород стимулює окремих стейкерів поводитися чесно, а штрафи перешкоджають стейкерам діяти зловмисно.

Докладніше про [доказ частки](/developers/docs/consensus-mechanisms/pos/)

### Наочний посібник {#types-of-consensus-video}

Докладніше про різні типи механізмів консенсусу, які використовуються в Ethereum:

<YouTube id="ojxfbN78WFQ" />

### Стійкість до Sybil-атак і вибір ланцюжка {#sybil-chain}

Самі по собі підтвердження роботи та доказ частки не є протоколами консенсусу, але їх часто так називають для простоти. Вони насправді є механізмами опору Sybil і блокують авторів; це спосіб вирішити, хто є автором останнього блоку. Іншим важливим компонентом є алгоритм вибору ланцюжка (також відомий як вибір форку), який дає змогу вузлам вибирати один єдиний правильний блок на початку ланцюжка в сценаріях, коли кілька блоків існують в одній позиції.

**Стійкість до Sybil-атак** вимірює, як протокол протистоїть Sybil-атаці. Стійкість до такого типу атак є важливою для децентралізованого блокчейна і дозволяє майнерам та валідаторам винагороджуватись однаково на основі вкладених ресурсів. Докази роботи та підтвердження ставки захищають від цього, змушуючи користувачів витрачати багато енергії або вносити багато застави. Ці засоби захисту є економічним стримуючим фактором для атак Сибіли.

**Правило вибору ланцюжка** використовується для визначення того, який ланцюжок є "правильним". Bitcoin використовує правило "найдовшого ланцюжка", що означає, що який би блокчейн не був найдовшим, він буде тим, який інші вузли приймуть як дійсний і з яким працюватимуть. Для ланцюжків доведення роботи найдовший ланцюг визначається загальною сукупною складністю доказування роботи. Ethereum також використовував правило найдовшого ланцюжка; однак тепер, коли Ethereum працює на доказі частки, він прийняв оновлений алгоритм вибору форку, який вимірює «вагу» ланцюжка. Вага — це накопичена сума голосів валідаторів, зважена за балансами застейканого ефіру валідаторів.

Ethereum використовує механізм консенсусу, відомий як [Gasper](/developers/docs/consensus-mechanisms/pos/gasper/), який поєднує [доказ частки Casper FFG](https://arxiv.org/abs/1710.09437) з [правилом вибору форку GHOST](https://arxiv.org/abs/2003.03052).

## Для подальшого читання {#further-reading}

- [Що таке алгоритм консенсусу блокчейну?](https://academy.binance.com/en/articles/what-is-a-blockchain-consensus-algorithm)
- [Що таке Накамото консенсус? Повний посібник для початківців](https://blockonomi.com/nakamoto-consensus/)
- [Як працює Casper?](https://medium.com/unitychain/intro-to-casper-ffg-9ed944d98b2d)
- [Про безпеку та продуктивність блокчейнів на основі доказу виконання роботи](https://eprint.iacr.org/2016/555.pdf)
- [Візантійська відмова](https://en.wikipedia.org/wiki/Byzantine_fault)

_Знайшли ресурс, який допоміг з цією темою? Відредагуйте цю сторінку і додайте його!_

## Пов'язані теми {#related-topics}

- [Підтвердження роботи](/developers/docs/consensus-mechanisms/pow/)
- [Майнінг](/developers/docs/consensus-mechanisms/pow/mining/)
- [Доказ частки](/developers/docs/consensus-mechanisms/pos/)
- [Доказ повноважень](/developers/docs/consensus-mechanisms/poa/)
