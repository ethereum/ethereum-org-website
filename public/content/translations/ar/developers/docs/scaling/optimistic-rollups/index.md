---
title: التجميعات التراكمية المتفائلة
description: مقدمة عن التجميعات التراكمية المتفائلة- وهي من الحلول التوسعية المستخدمة من قبل مجتمع الإيثيريوم.
lang: ar
---

التجميعات التراكمية المتفائلة هي من بروتوكولات الطبقة الثانية (L2) صُممت لتوسيع نطاق إنتاجية طبقة إثيريوم الأساسية. إنهم يقللون من العمليات الحسابية على سلسلة Ethereum الرئيسية من خلال معالجة المعاملات خارج السلسلة، مما يوفر تحسينات كبيرة في سرعات المعالجة. على عكس حلول التوسع الأخرى، مثل [السلاسل الجانبية](/developers/docs/scaling/sidechains/)، تستمد عمليات الرول أب التفائلية الأمان من الشبكة الرئيسية عن طريق نشر نتائج المعاملات على السلسلة، أو [سلاسل البلازما](/developers/docs/scaling/plasma/)، والتي تتحقق أيضًا من المعاملات على إيثريوم باستخدام إثباتات الاحتيال، ولكنها تخزن بيانات المعاملات في مكان آخر.

و بما أن الحساب هو الجزء البطيء و المُكلف من استخدام إثيريوم، فإن التجميعات التراكمية المتفائلة يمكن أن تقدم تحسينات قد تصل إلى 10-100 ضعف في عملية التوسع. تكتب عمليات الرول أب التفائلية أيضًا المعاملات إلى إيثريوم كـ `calldata` أو في [blobs](/roadmap/danksharding/)، مما يقلل من تكاليف الغاز للمستخدمين.

## المتطلبات الأساسية {#prerequisites}

كان يجب عليك قراءة وفهم صفحاتنا عن [تحجيم إيثريوم](/developers/docs/scaling/) و [الطبقة الثانية](/layer-2/).

## ما هي التجميعات التراكمية المتفائلة؟ ما هو الرول أب التفائلي؟ {#what-is-an-optimistic-rollup}

التجميع المتفائل هو نهج لتوسيع نطاق Ethereum والذي يتضمن نقل الحوسبة وتخزين الحالة خارج السلسلة. تنفذ عمليات الرول أب التفائلية المعاملات خارج إيثريوم، ولكنها تنشر بيانات المعاملات على الشبكة الرئيسية كـ `calldata` أو في [blobs](/roadmap/danksharding/).

يقوم مشغلو التجميع المتفائلون بتجميع معاملات متعددة خارج السلسلة معًا في دفعات كبيرة قبل إرسالها إلى Ethereum. هذا النهج يتيح توزيع التكايف الثابتة على معاملات متعددة في كل دفعة و تخفيض الرسوم على المستخدمين النهائيين. كذلك فإن التجميعات التراكمية المتفائلة تستخدم تقنيات الضغط لتخفيض كميات البيانات المنشورة على إثيريوم.

يعتبر التجميعات المتفائلة "متفائلة" لأنها تفترض أن المعاملات خارج السلسلة صالحة ولا تنشر أدلة على صحة دفعات المعاملات المنشورة على السلسلة. وهذا يفصل عمليات الرول أب التفائلية عن [رول أب المعرفة الصفرية](/developers/docs/scaling/zk-rollups) التي تنشر [إثباتات الصلاحية](/glossary/#validity-proof) المشفرة للمعاملات خارج السلسلة.

وتعتمد عمليات التجميع المتفائلة بدلاً من ذلك على مخطط لإثبات الاحتيال للكشف عن الحالات التي لا يتم فيها حساب المعاملات بشكل صحيح. بعد تقديم دفعة رول أب على إيثريوم، هناك نافذة زمنية (تسمى فترة التحدي) يمكن خلالها لأي شخص الطعن في نتائج معاملة الرول أب عن طريق حساب [إثبات الاحتيال](/glossary/#fraud-proof).

إذا نجح إثبات الاحتيال، يقوم بروتوكول التجميع بإعادة تنفيذ المعاملة (المعاملات) تحديث حالة التجميع وفقًا لذلك. التأثير الآخر لإثبات الاحتيال الناجح هو أن المُسلسل المسؤول عن تضمين المعاملة التي تم تنفيذها بشكل غير صحيح في كتلة يتلقى عقوبة.

إذا ظلت الدفعة المجمعة دون تحدي (أي، تم تنفيذ جميع المعاملات بشكل صحيح) بعد انقضاء فترة التحدي، فسيتم اعتبارها صالحة ومقبولة على Ethereum. يمكن للآخرين الاستمرار في البناء على كتلة تجميع غير مؤكدة، ولكن مع تحذير: سيتم معكوس نتائج المعاملات إذا كانت تستند إلى معاملة تم تنفيذها بشكل غير صحيح وتم نشرها مسبقًا.

## كيف تتفاعل التجميعات المتفائلة مع الإيثريوم؟ الرول أب التفائلي وإيثريوم {#optimistic-rollups-and-Ethereum}

عمليات الرول أب التفائلية هي [حلول توسع خارج السلسلة](/developers/docs/scaling/#offchain-scaling) مصممة للعمل فوق إيثريوم. يتم إدارة كل عملية تجميع متفائلة من خلال مجموعة من العقود الذكية المنتشرة على شبكة Ethereum. تعمل عمليات التجميع المتفائلة على معالجة المعاملات خارج سلسلة Ethereum الرئيسية، ولكنها تنشر المعاملات خارج السلسلة (على دفعات) إلى عقد تجميع على السلسلة. كما هو الحال مع سلسلة بلوك شين الإيثريوم، فإن سجل المعاملات هذا غير قابل للتغيير و يشكل "سلسلة التجميع المتفائلة".

يشتمل على بنية التجميع المتفائل على الأجزاء التالية:

**العقود على السلسلة**: يتم التحكم في تشغيل الرول أب التفائلي بواسطة العقود الذكية التي تعمل على إيثريوم. يتضمن ذلك العقود التي تخزن كتل التجميع، وتراقب تحديثات الحالة على التجميع، وتتبع ودائع المستخدم. بهذا المعنى، يعمل الإيثريوم بمثابة الطبقة الأساسية أو "الطبقة 1" لعمليات التجميع المتفائلة.

**آلة افتراضية خارج السلسلة (VM)**: على الرغم من أن العقود التي تدير بروتوكول الرول أب التفائلي تعمل على إيثريوم، فإن بروتوكول الرول أب يقوم بالحسابات وتخزين الحالة على آلة افتراضية أخرى منفصلة عن [آلة إيثريوم الافتراضية](/developers/docs/evm/). يعتبر الآلة الافتراضية خارج السلسلة هي المكان الذي تعيش فيه التطبيقات ويتم تنفيذ تغييرات الحالة فيه؛ وهي بمثابة الطبقة العليا أو "الطبقة 2" للتجميع المتفائل.

نظرًا لأن عمليات التجميع المتفائلة مصممة لتشغيل البرامج المكتوبة أو المترجمة لـ EVM، فإن VM خارج السلسلة تتضمن العديد من مواصفات تصميم EVM. بالإضافة إلى ذلك، تسمح إثباتات الاحتيال المحسوبة على السلسلة لشبكة إيثريوم بفرض صلاحية تغييرات الحالة المحسوبة في الجهاز الافتراضي خارج السلسلة.

يتم وصف عمليات التجميع المتفائلة بأنها "حلول التوسع الهجينة" لأنه على الرغم من وجودها كبروتوكولات منفصلة، ​​فإن خصائص الأمان الخاصة بها مستمدة من Ethereum. من بين أمور أخرى، يضمن الإيثريوم صحة حسابات التجميع خارج السلسلة وتوافر البيانات وراء الحساب. وهذا يجعل عمليات الرول أب التفائلية أكثر أمانًا من بروتوكولات التوسع خارج السلسلة البحتة (على سبيل المثال، [السلاسل الجانبية](/developers/docs/scaling/sidechains/)) التي لا تعتمد على إيثريوم للأمان.

تعتمد عمليات التجميع المتفائلة على بروتوكول Ethereum الرئيسي يأتي:

### توفر البيانات {#data-availability}

كما ذكرنا، تنشر عمليات الرول أب التفائلية بيانات المعاملات إلى إيثريوم كـ `calldata` أو [blobs](/roadmap/danksharding/). نظرًا لأن تنفيذ سلسلة التجميع يعتمد على المعاملات المرسلة، يمكن لأي شخص استخدام هذه المعلومات - المرتكزة على الطبقة الأساسية لـ Ethereum - لتنفيذ حالة التجميع والتحقق من صحة انتقالات الحالة.

تعتبر [إتاحة البيانات](/developers/docs/data-availability/) أمرًا بالغ الأهمية لأنه بدون الوصول إلى بيانات الحالة، لا يمكن للمتحدين إنشاء إثباتات الاحتيال للطعن في عمليات الرول أب غير الصالحة. مع توفير Ethereum لإمكانية توفر البيانات، يتم تقليل خطر هروب مشغلي التجميع من الأعمال الضارة (على سبيل المثال، إرسال كتل غير صالحة).

### مقاومة الرقابة {#censorship-resistance}

تعتمد عمليات التجميع المتفائلة أيضًا على Ethereum لمقاومة الرقابة. في التجميع المتفائل، تكون الكيان المركزي (المشغل) مسؤولاً عن معالجة المعاملات وإرسال كتل التجميع إلى Ethereum. وهذا له بعض الآثار:

- يمكن لمشغلي التجميع فرض رِقابة على المستخدمين من خلال قطع الاتصال بالإنترنت تمامًا، أو من خلال رفض إنتاج الكتل التي تتضمن معاملات معينة فيها.

- يمكن لمشغلي التجميع منع المستخدمين من سحب الأموال المودعة في عقد التجميع عن طريق حجب بيانات الدولة اللازمة لإثباتات ملكية فيراكل. يمكن أن يؤدي حجب بيانات الحالة أيضًا إلى إخفاء حالة التجميع عن المستخدمين ومنعهم من التفاعل مع التجميع.

تحل عمليات التجميع المتفائلة هذه المشكلة عن طريق إجبار المشغلين على نشر البيانات المرتبطة بتحديثات الحالة على Ethereum. تتمتع عملية نشر بيانات التجميع على السلسلة بالفوائد التالية:

- إذا أصبح مشغل التجميع المتفائل غير متصل بالإنترنت أو توقف عن إنتاج دفعات المعاملات، فيمكن لعقدة أخرى استخدام البيانات المتاحة لإعادة إنتاج الحالة الأخيرة للتجميع ومواصلة إنتاج الكتلة.

- يمكن للمستخدمين استخدام بيانات المعاملات لإنشاء أدلة ميرال التي تثبت ملكية الأموال وسحب أصولهم من التجميع.

- يمكن للمستخدمين أيضًا إرسال معاملاتهم على L1 بدلاً من إرسالها إلى جهاز التسلسل، وفي هذه الحالة يتعين على جهاز التسلسل تضمين المعاملة ضمن حد زمني معين لمواصلة إنتاج الكتل الصالحة.

### التسوية {#settlement}

هناك دور آخر يلعبه الإيثريوم في سياق التجميعات المتفائلة وهو طبقة التسوية. تعمل طبقة التسوية على ترسيخ النظام البيئي الكامل لسلسلة الكتل، وتؤسس الأمان، وتوفر النهاية الموضوعية إذا حدث نزاع على سلسلة أخرى (عمليات تجميع متفائلة في هذه الحالة) تتطلب التحكيم.

توفر شبكة Ethereum الشبكة الرئيسية مركزًا لعمليات التجميع المتفائلة للتحقق من أدلة الاحتيال وحل النزاعات. علاوة على ذلك، لا تكون المعاملات التي تتم على الرول أب نهائية _إلا بعد_ قبول كتلة الرول أب على إيثريوم. بمجرد تثبيت معاملة التجميع على الطبقة الأساسية لـ Ethereum، لا يمكن التراجع عنها (باستثناء الحالة غير المحتملة للغاية لإعادة تنظيم السلسلة).

## كيف تعمل التجميعات المتفائلة؟ {#how-optimistic-rollups-work}

### تنفيذ المعاملات وتجميعها {#transaction-execution-and-aggregation}

يقوم المستخدمون بإرسال المعاملات إلى "المشغلين"، وهي العقد المسؤولة عن معالجة المعاملات على التجميع المتفائل. يُعرف أيضًا باسم "المحقق" أو "المجمع"، حيث يقوم المشغل بتجميع المعاملات، وضغط البيانات الأساسية، ونشر الكتلة على Ethereum.

على الرغم من أن أي شخص يمكن أن يصبح مدققًا، يجب على مدققي الرول أب التفائلي تقديم سند قبل إنتاج الكتل، تمامًا مثل [نظام إثبات الحصة](/developers/docs/consensus-mechanisms/pos/). يمكن قطع هذا الرابط إذا قام المحقق بنشر كتلة غير صالحة أو قام بالبناء على كتلة قديمة ولكنها غير صالحة (حتى لو كانت كتلته صالحة). بهذه الطريقة، تستخدم عمليات التجميع المتفائلة الحوافز الاقتصادية المشفرة لضمان تصرف المحققين بأمانة.

ومن المتوقع أن يقوم المحققون الآخرون على سلسلة التجميع المتفائلة بتنفيذ المعاملات المرسلة باستخدام نسختهم من حالة التجميع. إذا كانت الحالة النهائية للمحقق مختلفة عن الحالة المقترحة من قبل المشغل، فيمكنه بدء التحدي وحساب دليل الاحتيال.

قد تتخلى بعض التجميعات المتفائلة عن نظام التحقق بدون إذن وتستخدم "متسلسلًا" واحدًا لتنفيذ السلسلة. مثل المحقق، يقوم التسلسل بمعالجة المعاملات، وإنتاج كتل التجميع، وإرسال معاملات التجميع إلى سلسلة L1 (Ethereum).

يختلف المُسلسل عن مشغل التجميع العادي لأنه يتمتع بقدر أكبر من التحكم في ترتيب المعاملات. بالإضافة إلى ذلك، يتمتع المُسلسل بالوصول الأولوي إلى سلسلة التجميع وهو الكيان الوحيد المُصرّح له بإرسال المعاملات إلى العقد على السلسلة. تتم ببساطة إدراج المعاملات من العقد غير التسلسلية أو المستخدمين العاديين في صندوق وارد منفصل حتى يقوم التسلسلي بتضمينها في دفعة جديدة.

#### تقديم كتل الرول أب إلى إيثريوم {#submitting-blocks-to-ethereum}

كما ذكرنا سابقًا، يقوم مشغل التجميع المتفائل بتجميع المعاملات خارج السلسلة في دفعة واحدة وإرسالها إلى Ethereum للتصديق عليها. تتضمن هذه العملية ضغط البيانات المتعلقة بالمعاملات ونشرها على إيثريوم كـ `calldata` أو في blobs.

`calldata` هي منطقة غير قابلة للتعديل وغير مستمرة في العقد الذكي تتصرف في الغالب مثل [الذاكرة](/developers/docs/smart-contracts/anatomy/#memory). بينما تستمر `calldata` على السلسلة كجزء من [سجلات تاريخ](https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html?highlight=memory#logs) البلوكتشين، إلا أنها لا تُخزَّن كجزء من حالة إيثريوم. نظرًا لأن `calldata` لا تمس أي جزء من حالة إيثريوم، فهي أرخص من الحالة لتخزين البيانات على السلسلة.

تُستخدم الكلمة الأساسية `calldata` أيضًا في Solidity لتمرير الوسائط إلى دالة العقد الذكي في وقت التنفيذ. تحدد `calldata` الدالة التي يتم استدعاؤها أثناء المعاملة وتحتفظ بالمدخلات للدالة في شكل تسلسل عشوائي من البايتات.

في سياق عمليات الرول أب التفائلية، تُستخدم `calldata` لإرسال بيانات المعاملات المضغوطة إلى العقد على السلسلة. يضيف عامل التجميع دفعة جديدة عن طريق استدعاء الوظيفة المطلوبة في عقد التجميع وتمرير البيانات المضغوطة كوسائط وظيفة. يؤدي استخدام `calldata` إلى تقليل رسوم المستخدمين لأن معظم التكاليف التي تتكبدها عمليات الرول أب تأتي من تخزين البيانات على السلسلة.

إليك [مثال](https://eth.blockscout.com/tx/0x9102bfce17c58b5fc1c974c24b6bb7a924fb5fbd7c4cd2f675911c27422a5591) على تقديم دفعة رول أب لتوضيح كيفية عمل هذا المفهوم. استدعى المنسّق طريقة `appendSequencerBatch()` ومرر بيانات المعاملة المضغوطة كمدخلات باستخدام `calldata`.

تستخدم بعض التجميعات الآن الكتل لنشر دفعات من المعاملات إلى Ethereum.

الـ Blobs غير قابلة للتعديل وغير مستمرة (تمامًا مثل `calldata`) ولكن يتم حذفها من السجل بعد 18 يومًا تقريبًا. لمزيد من المعلومات حول blobs، راجع [Danksharding](/roadmap/danksharding).

### التزامات الحالة {#state-commitments}

في أي وقت، حالة الرول أب التفائلي (الحسابات، الأرصدة، كود العقد، إلخ) يتم تنظيمها على شكل [شجرة ميركل](/whitepaper/#merkle-trees) تسمى "شجرة الحالة". يتم تجزئة جذر شجرة Merkle هذه (جذر الحالة)، والتي تشير إلى أحدث حالة للتجميع، وتخزينها في عقد التجميع. يؤدي كل انتقال حالة على السلسلة إلى إنتاج حالة تجميع جديدة، والتي يلتزم بها المشغل عن طريق حساب جذر حالة جديد.

يجب على المشغل تقديم كل من جذور الحالة القديمة وجذور الحالة الجديدة عند نشر الدفعات. إذا كان جذر الحالة القديم يتطابق مع جذر الحالة الموجود في عقد onchain، فسيتم تجاهل الأخير واستبداله بجذر الحالة الجديد.

يُطلب من مشغل التجميع أيضًا الالتزام بجذر Merkle لدفعة المعاملة نفسها. يسمح هذا لأي شخص بإثبات إدراج معاملة في الدفعة (على L1) من خلال تقديم [إثبات ميركل](/developers/tutorials/merkle-proofs-for-offline-data-integrity/).

إن التزامات الدولة، وخاصة جذور الدولة، ضرورية لإثبات صحة التغييرات التي تطرأ على الدولة في إطار عملية تجميع متفائلة. يقبل عقد التجميع جذور الحالة الجديدة من المشغلين فورًا بعد نشرها، ولكن يمكنه لاحقًا حذف جذور الحالة غير الصالحة لاستعادة التجميع إلى حالته الصحيحة.

### إثبات الاحتيال {#fraud-proving}

كما تم شرحه، فإن التجميعات المتفائلة تسمح لأي شخص بنشر الكتل دون تقديم أدلة على صحتها. ومع ذلك، لضمان بقاء السلسلة آمنة، تحدد عمليات التجميع المتفائلة نافذة زمنية يمكن خلالها لأي شخص الاعتراض على انتقال الحالة. ومن ثم، تُسمى كتل التجميع "تأكيدات" نظرًا لأن أي شخص يمكنه التشكيك في صحتها.

إذا كان هناك شخص يشكك في تأكيد ما، فسوف يبدأ بروتوكول التجميع عملية حسابية للتأكد من عدم الاحتيال. كل أنواع إثبات الاحتيال تفاعلية - يجب على شخص ما نشر ادعاء قبل أن يتمكن شخص آخر من تحديه. الفرق يكمن في عدد جولات التفاعل المطلوبة لحساب إثبات الاحتيال.

تعيد مخططات الإثبات التفاعلية ذات الجولة الواحدة تشغيل المعاملات المتنازع عليها على L1 للكشف عن التأكيدات غير الصالحة. يحاكي بروتوكول التجميع إعادة تنفيذ المعاملة المتنازع عليها على L1 (Ethereum) باستخدام عقد التحقق، مع تحديد جذر الحالة المحسوبة من يفوز بالتحدي. إذا كان ادعاء المتحدي بشأن الحالة الصحيحة للفة صحيحًا، فسيتم معاقبة المشغل بخفض سندته.

ومع ذلك، فإن إعادة تنفيذ المعاملات على L1 للكشف عن الاحتيال يتطلب نشر التزامات الحالة للمعاملات الفردية ويزيد من مجموعات البيانات التي يجب نشرها على السلسلة. وتتسبب إعادة المعاملات أيضًا في تكاليف كبيرة للغاز. ولهذه الأسباب، تتحول عمليات التجميع المتفائلة إلى الإثبات التفاعلي متعدد الجولات، والذي يحقق نفس الهدف (أي اكتشاف عمليات التجميع غير الصالحة) بكفاءة أكبر.

#### الإثبات التفاعلي متعدد الجولات {#multi-round-interactive-proving}

يتضمن الإثبات التفاعلي متعدد الجولات بروتوكولًا ذهابًا وإيابًا بين المُدعي والمُتحدي تحت إشراف عقد التحقق من المستوى الأول، والذي يقرر في النهاية الطرف الكاذب. بعد أن تقوم عقدة L2 بتحدي تأكيد ما، يتعين على المُؤكد تقسيم التأكيد المتنازع عليه إلى نصفين متساويين. في هذه الحالة، سيحتوي كل تأكيد فردي على عدد من خطوات الحساب مثل الآخر.

بعد ذلك، يقوم المتحدي باختيار الادعاء الذي يريد تحديه. تستمر عملية التقسيم (المسماة "بروتوكول التنصيف") حتى يتنازع الطرفان على تأكيد بشأن خطوة تنفيذ _واحدة_. في هذه المرحلة، سوف يقوم عقد L1 بحل النزاع من خلال تقييم التعليمات (ونتيجتها) للقبض على الطرف الاحتيالي.

يُطلب من المُدعي تقديم "دليل من خطوة واحدة" للتحقق من صحة الحساب المتنازع عليه المكون من خطوة واحدة. إذا فشل المُؤكد في توفير الدليل المكون من خطوة واحدة، أو إذا اعتبر المُتحقق L1 الدليل غير صالح، فإنه يخسر التحدي.

بعض الملاحظات حول هذا النوع من إثبات الاحتيال:

1. يُعتبر إثبات الاحتيال التفاعلي متعدد الجولات فعالاً لأنه يقلل من العمل الذي يجب أن تقوم به سلسلة L1 في التحكيم في النزاعات. بدلاً من إعادة تشغيل المعاملة بأكملها، تحتاج سلسلة L1 فقط إلى إعادة تنفيذ خطوة واحدة في تنفيذ التجميع.

2. تعمل بروتوكولات التقسيم الثنائي على تقليل كمية البيانات المنشورة على السلسلة (لا حاجة إلى نشر التزامات الحالة لكل معاملة). بالإضافة إلى ذلك، فإن معاملات التجميع المتفائلة ليست مقيدة بحد غاز الإيثريوم. وعلى العكس من ذلك، يجب على عمليات التجميع المتفائلة التي تعيد تنفيذ المعاملات التأكد من أن معاملة L2 لها حد غاز أقل لمحاكاة تنفيذها داخل معاملة Ethereum واحدة.

3. يتم منح جزء من سند المدعي الخبيث للمتحدي، في حين يتم حرق الجزء الآخر. يمنع الحرق التواطؤ بين المحققين؛ إذا تواطأ اثنان من المحققين لبدء تحديات وهمية، فسيظلان يخسران جزءًا كبيرًا من الحصة بأكملها.

4. تتطلب عملية الإثبات التفاعلية متعددة الجولات من كلا الطرفين (المدعي والمتحدي) القيام بحركات خلال فترة زمنية محددة. إن عدم التصرف قبل انتهاء الموعد النهائي يجعل الطرف المتخلف عن السداد يتنازل عن التحدي.

#### لماذا تعتبر إثباتات الاحتيال مهمة لعمليات الرول أب التفائلية {#fraud-proof-benefits}

تعتبر إثباتات الاحتيال مهمة لأنها تسهل _النهائية غير المعتمدة على الثقة_ في عمليات الرول أب التفائلية. إن النهائية الخالية من الثقة هي جودة التجميعات المتفائلة التي تضمن أن المعاملة - طالما كانت صالحة - سيتم تأكيدها في النهاية.

يمكن للعقد الضارة أن تحاول تأخير تأكيد كتلة التجميع الصالحة عن طريق بدء تحديات خاطئة. ومع ذلك، فإن إثباتات الاحتيال سوف تثبت في نهاية المطاف صحة كتلة التجميع وتتسبب في تأكيدها.

يرتبط هذا أيضًا بخاصية أمان أخرى لعمليات الرول أب التفائلية: تعتمد صلاحية السلسلة على وجود عقدة _واحدة_ أمينة. يمكن للعقدة الصادقة تطوير السلسلة بشكل صحيح إما عن طريق نشر تأكيدات صالحة أو الطعن في التأكيدات غير الصالحة. مهما كانت الحالة، فإن العقد الخبيثة التي تدخل في نزاعات مع العقدة الصادقة سوف تخسر حصصها أثناء عملية إثبات الاحتيال.

### التشغيل البيني بين L1/L2 {#l1-l2-interoperability}

تم تصميم التجميعات المتفائلة للتوافق مع شبكة Ethereum Mainnet والسماح للمستخدمين بتمرير الرسائل والبيانات العشوائية بين L1 و L2. إنها متوافقة أيضًا مع آلة إيثريوم الافتراضية، لذا يمكنك نقل [التطبيقات اللامركزية](/developers/docs/dapps/) الحالية إلى عمليات الرول أب التفائلية أو إنشاء تطبيقات لامركزية جديدة باستخدام أدوات تطوير إيثريوم.

#### ١. حركة الأصول {#asset-movement}

##### الدخول إلى التجميع

لاستخدام الرول أب التفائلي، يقوم المستخدمون بإيداع ETH ورموز ERC-20 وغيرها من الأصول المقبولة في عقد [الجسر](/developers/docs/bridges/) الخاص بالرول أب على L1. سينقل عقد الجسر المعاملة إلى L2، حيث يتم سك مبلغ مكافئ من الأصول وإرساله إلى العنوان الذي اختاره المستخدم في التجميع المتفائل.

عادةً ما توضع المعاملات التي ينشئها المستخدم (مثل إيداع L1 > L2) في قائمة انتظار حتى يعيد المنسّق إرسالها إلى عقد الرول أب. ومع ذلك، للحفاظ على مقاومة الرقابة، تسمح عمليات التجميع المتفائلة للمستخدمين بإرسال معاملة مباشرة إلى عقد التجميع على السلسلة إذا تأخرت عن الحد الأقصى للوقت المسموح به.

تتبنى بعض عمليات التجميع المتفائلة نهجًا أكثر وضوحًا لمنع أجهزة التسلسل من مراقبة المستخدمين. هنا، يتم تعريف الكتلة من خلال جميع المعاملات المرسلة إلى عقد L1 منذ الكتلة السابقة (على سبيل المثال، الودائع) بالإضافة إلى المعاملات التي تتم معالجتها على سلسلة التجميع. إذا تجاهل جهاز التسلسل معاملة L1، فسوف ينشر حالة الجذر الخاطئة (التي يمكن إثباتها)؛ وبالتالي، لا يمكن لأجهزة التسلسل تأخير الرسائل التي ينشئها المستخدم بمجرد نشرها على L1.

##### الخروج من التجميع

يعد الانسحاب من التجميع المتفائل إلى Ethereum أكثر صعوبة بسبب مخطط إثبات الاحتيال. إذا بدأ مستخدم معاملة L2 > L1 لسحب الأموال المودعة على L1، فيجب عليه الانتظار حتى انقضاء فترة التحدي - التي تستمر حوالي سبعة أيام. ومع ذلك، فإن عملية الانسحاب في حد ذاتها بسيطة إلى حد ما.

بعد بدء طلب السحب على التجميع L2، يتم تضمين المعاملة في الدفعة التالية، بينما يتم حرق أصول المستخدم الموجودة على التجميع. بمجرد نشر الدفعة على Ethereum، يمكن للمستخدم حساب دليل Merkle للتحقق من تضمين معاملة الخروج الخاصة به في الكتلة. ثم يتعلق الأمر بالانتظار خلال فترة التأخير لإتمام المعاملة على L1 وسحب الأموال إلى Mainnet.

لتجنب الانتظار لمدة أسبوع قبل سحب الأموال إلى إيثريوم، يمكن لمستخدمي الرول أب التفائلي استخدام **مزود سيولة** (LP). يتولى مزود السيولة ملكية السحب المعلق L2 ويدفع للمستخدم على L1 (مقابل رسوم).

Liquidity providers can check the validity of the user’s withdrawal request (by executing the chain themselves) before releasing funds. بهذه الطريقة، يكون لديهم ضمانات بأن المعاملة سيتم تأكيدها في النهاية (أي، نهائية بدون ثقة).

#### ٢. التوافق مع EVM {#evm-compatibility}

بالنسبة للمطورين، فإن ميزة عمليات الرول أب التفائلية هي توافقها - أو الأفضل من ذلك، تكافؤها - مع [آلة إيثريوم الافتراضية (EVM)](/developers/docs/evm/). تتوافق عمليات الرول أب المتوافقة مع آلة إيثريوم الافتراضية مع المواصفات الواردة في [الورقة الصفراء لإيثريوم](https://ethereum.github.io/yellowpaper/paper.pdf) وتدعم آلة إيثريوم الافتراضية على مستوى البايت كود.

تتمتع التوافقية مع EVM في التجميعات المتفائلة بالفوائد التالية:

i. يمكن للمطورين نقل العقود الذكية الموجودة على Ethereum إلى سلاسل التجميع المتفائلة دون الحاجة إلى تعديل قواعد التعليمات البرمجية على نطاق واسع. يمكن أن يوفر هذا الوقت لفرق التطوير عند نشر عقود Ethereum الذكية على L2.

ii. يمكن للمطورين وفرق المشروع الذين يستخدمون التجميعات المتفائلة الاستفادة من البنية التحتية لـ Ethereum. يتضمن ذلك لغات البرمجة ومكتبات التعليمات البرمجية وأدوات الاختبار وبرامج العميل والبنية الأساسية للنشر وما إلى ذلك.

يعد استخدام الأدوات الموجودة أمرًا مهمًا لأن هذه الأدوات خضعت للتدقيق والتصحيح والتحسين على نطاق واسع على مر السنين. كما أنه يزيل الحاجة إلى أن يتعلم مطورو Ethereum كيفية البناء باستخدام مجموعة تطوير جديدة تمامًا.

#### 3. استدعاءات العقود عبر السلاسل {#cross-chain-contract-calls}

يتفاعل المستخدمون (الحسابات المملوكة خارجيًا) مع عقود L2 عن طريق إرسال معاملة إلى عقد التجميع أو عن طريق قيام جهاز تسلسل أو محقق بتلك نيابةً عنهم. تسمح عمليات التجميع المتفائلة أيضًا لحسابات العقود على Ethereum بالتفاعل مع عقود L2 باستخدام عقود الربط لنقل الرسائل وتمرير البيانات بين L1 و L2. يعني هذا أنه يمكنك برمجة عقد L1 على Ethereum Mainnet لاستدعاء وظائف تنتمي إلى العقود الموجودة في التجميع المتفائل L2.

تحدث مكالمات العقد عبر السلسلة بشكل غير متزامن - مما يعني أن المكالمة يتم بدءها أولاً، ثم تنفيذها في وقت لاحق. يختلف هذا عن المكالمات بين العقدين على Ethereum، حيث تنتج المكالمة نتائج على الفور.

أحد الأمثلة على مكالمة عقد عبر السلسلة هو إيداع الرمز المميز الموضح سابقًا. يقوم العقد على L1 بإيداع رموز المستخدم ويرسل رسالة إلى عقد L2 مقترنًا لإصدار كمية متساوية من الرموز في التجميع.

نظرًا لأن استدعاءات الرسائل عبر السلاسل تؤدي إلى تنفيذ العقد، فعادةً ما يُطلب من المرسل تغطية [تكاليف الغاز](/developers/docs/gas/) للحسابات. من المستحسن تعيين حد غاز مرتفع لمنع فشل المعاملة على السلسلة المستهدفة. يعد سيناريو ربط الرموز مثالاً جيدًا؛ إذا نجح الجانب L1 من المعاملة (إيداع الرموز)، ولكن فشل الجانب L2 (سك رموز جديدة) بسبب انخفاض الغاز، يصبح الإيداع غير قابل للاسترداد.

أخيرًا، يجب أن نلاحظ أن استدعاءات الرسائل L2 > L1 بين العقود تحتاج إلى مراعاة التأخيرات (عادةً ما يتم تنفيذ استدعاءات L1 > L2 بعد بضع دقائق). يرجع السبب في ذلك إلى أن الرسائل المرسلة إلى الشبكة الرئيسية من التجميع المتفائل لا يمكن تنفيذها حتى انتهاء صلاحية نافذة التحدي.

## كيف تعمل رسوم التجميع المتفائلة؟ {#how-do-optimistic-rollup-fees-work}

تستخدم عمليات التجميع المتفائلة مخطط رسوم الغاز، مثل Ethereum، للإشارة إلى المبلغ الذي يدفعه المستخدمون لكل معاملة. تعتمد الرسوم المفروضة على عمليات الرول أب التفائلية على المكونات التالية:

1. **كتابة الحالة**: تنشر عمليات الرول أب التفائلية بيانات المعاملات وترويسات الكتل (التي تتكون من تجزئة ترويسة الكتلة السابقة، وجذر الحالة، وجذر الدفعة) إلى إيثريوم كـ `blob`، أو "كائن ثنائي كبير". قدم [EIP-4844](https://eips.ethereum.org/EIPS/eip-4844) حلاً فعالاً من حيث التكلفة لتضمين البيانات على السلسلة. `blob` هو حقل معاملة جديد يسمح لعمليات الرول أب بنشر بيانات انتقال الحالة المضغوطة إلى إيثريوم L1. على عكس `calldata`، التي تظل بشكل دائم على السلسلة، فإن الـ blobs قصيرة العمر ويمكن حذفها من العملاء بعد [4096 حقبة](https://github.com/ethereum/consensus-specs/blob/81f3ea8322aff6b9fb15132d050f8f98b16bdba4/configs/mainnet.yaml#L147) (حوالي 18 يومًا). من خلال استخدام الكتل لنشر دفعات من المعاملات المضغوطة، يمكن لعمليات التجميع المتفائلة أن تقلل بشكل كبير من تكلفة كتابة المعاملات إلى L1.

2. **غاز الـ Blob المستخدم**: تستخدم المعاملات التي تحمل Blob آلية رسوم ديناميكية مشابهة لتلك التي قدمها [EIP-1559](https://eips.ethereum.org/EIPS/eip-1559). تأخذ رسوم الغاز للمعاملات من النوع 3 في الاعتبار الرسوم الأساسية للكتل، والتي يتم تحديدها بواسطة الشبكة بناءً على الطلب على مساحة الكتلة واستخدام مساحة الكتلة للمعاملة المرسلة.

3. **رسوم مشغل L2**: هذا هو المبلغ المدفوع لعُقد الرول أب كتعويض عن التكاليف الحسابية المتكبدة في معالجة المعاملات، مثل رسوم الغاز على إيثريوم. تفرض عقد التجميع رسوم معاملات أقل نظرًا لأن L2s تتمتع بقدرات معالجة أعلى ولا تواجه ازدحام الشبكة الذي يفرض على المحققين على Ethereum إعطاء الأولوية للمعاملات ذات الرسوم الأعلى.

تطبق عمليات الرول أب التفائلية عدة آليات لتقليل الرسوم للمستخدمين، بما في ذلك تجميع المعاملات وضغط `calldata` لتقليل تكاليف نشر البيانات. يمكنك التحقق من [متتبع رسوم L2](https://l2fees.info/) للحصول على نظرة عامة في الوقت الفعلي حول تكلفة استخدام عمليات الرول أب التفائلية القائمة على إيثريوم.

## كيف تساهم التجميعات المتفائلة في توسيع نطاق إيثريوم؟ توسيع نطاق إيثريوم باستخدام عمليات الرول أب التفائلية {#scaling-ethereum-with-optimistic-rollups}

As explained, optimistic rollups publish compressed transaction data on Ethereum to guarantee data availability. إن القدرة على ضغط البيانات المنشورة على السلسلة أمر بالغ الأهمية لتوسيع نطاق الإنتاجية على Ethereum مع التجميعات المتفائلة.

تضع سلسلة إيثريوم الرئيسية قيودًا على كمية البيانات التي يمكن أن تحتويها الكتل، مقومة بوحدات الغاز (يبلغ [متوسط حجم الكتلة](/developers/docs/blocks/#block-size) 15 مليون غاز). وفي حين أن هذا يقيد كمية الغاز التي يمكن لكل معاملة استخدامها، فإنه يعني أيضًا أنه يمكننا زيادة المعاملات التي تتم معالجتها لكل كتلة عن طريق تقليل البيانات المتعلقة بالمعاملات - مما يحسن قابلية التوسع بشكل مباشر.

تستخدم عمليات التجميع المتفائلة عدة تقنيات لتحقيق ضغط بيانات المعاملات وتحسين معدلات TPS. على سبيل المثال، تقارن هذه [المقالة](https://vitalik.eth.limo/general/2021/01/05/rollup.html) البيانات التي تولدها معاملة مستخدم أساسية (إرسال الإيثر) على الشبكة الرئيسية مقابل كمية البيانات التي تولدها نفس المعاملة على الرول أب:

| Parameter    | إيثريوم (L1)                      | الالتفاف (L2)     |
| ------------ | ---------------------------------------------------- | ------------------------------------ |
| نونس         | ~3                                   | 0                                    |
| سعر الغاز    | ~8                                   | 0-0.5                |
| الغاز        | 3                                                    | 0-0.5                |
| ل            | واحد وعشرون                                          | 4                                    |
| Value        | 9                                                    | ~3                   |
| التوقيع      | ~68 (2 + 33 + 33) | ~0.5 |
| من           | 0 (تم استرداده من سيج)            | 4                                    |
| **الإجمالي** | **~112 بايت**                        | **~12 bytes**        |

إن إجراء بعض الحسابات التقريبية على هذه الأرقام يمكن أن يساعد في إظهار تحسينات قابلية التوسع التي توفرها عملية التجميع المتفائلة:

1. الحجم المستهدف لكل كتلة هو 15 مليون غاز، ويتكلف التحقق من بيات واحد من البيانات 16 غازًا. يُظهر تقسيم متوسط حجم الكتلة على 16 غازًا (15,000,000/16) أن الكتلة المتوسطة يمكن أن تحتوي على **937,500 بايت من البيانات**.
2. إذا كانت معاملة الرول أب الأساسية تستخدم 12 بايت، فيمكن لكتلة إيثريوم المتوسطة معالجة **78,125 معاملة رول أب** (937,500/12) أو **39 دفعة رول أب** (إذا كانت كل دفعة تحتوي على 2,000 معاملة في المتوسط).
3. إذا تم إنتاج كتلة جديدة على إيثريوم كل 15 ثانية، فإن سرعات معالجة الرول أب ستصل إلى ما يقرب من **5,208 معاملات في الثانية**. يتم ذلك عن طريق قسمة عدد معاملات الرول أب الأساسية التي يمكن أن تحتويها كتلة إيثريوم (**78,125**) على متوسط وقت الكتلة (**15 ثانية**).

يعد هذا تقديرًا متفائلًا إلى حد ما، نظرًا لأن معاملات التجميع المتفائلة لا يمكنها بأي حال من الأحوال أن تشمل كتلة كاملة على Ethereum. ومع ذلك، يمكن أن يعطي فكرة تقريبية عن مقدار مكاسب التوسع التي يمكن أن توفرها التجميعات المتفائلة لمستخدمي Ethereum (تقدم التنفيذات الحالية ما يصل إلى 2000 TPS).

من المتوقع أن يؤدي إدخال [تجزئة البيانات](/roadmap/danksharding/) على إيثريوم إلى تحسين قابلية التوسع في عمليات الرول أب التفائلية. نظرًا لأن معاملات التجميع يجب أن تشترك في مساحة الكتلة مع معاملات أخرى غير تجميعية، فإن قدرتها على المعالجة محدودة بمعدل نقل البيانات على سلسلة Ethereum الرئيسية. ستزيد Danksharding المساحة المتاحة لسلاسل L2 لنشر البيانات لكل كتلة، باستخدام تخزين "blob" الأرخص وغير الدائم بدلاً من `CALLDATA` الدائم والمكلف.

### إيجابيات وسلبيات عمليات الرول أب التفائلية {#optimistic-rollups-pros-and-cons}

| الإيجابيات                                                                                                                                                            | السلبيات                                                                                                                                         |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| يقدم تحسينات هائلة في قابلية التوسع دون التضحية بالأمان أو انعدام الثقة.                                                                              | التأخير في إتمام المعاملة بسبب تحديات الاحتيال المحتملة.                                                                         |
| يتم تخزين بيانات المعاملات على سلسلة الطبقة 1، مما يحسن الشفافية والأمان ومقاومة الرقابة واللامركزية.                                                 | يمكن لمشغلي التجميع المركزي (المسلسلات) التأثير على ترتيب المعاملات.                                          |
| إن إثبات الاحتيال يضمن النهاية الخالية من الثقة ويسمح للأقليات الصادقة بتأمين السلسلة.                                                                | إذا لم تكن هناك عقد صادقة، فيمكن لمشغل خبيث سرقة الأموال عن طريق نشر كتل غير صالحة والتزامات الدولة.                             |
| إن حساب أدلة الاحتيال متاح لعقدة L2 العادية، على عكس أدلة الصحة (المستخدمة في ZK-rollups) التي تتطلب أجهزة خاصة.                   | يعتمد نموذج الأمان على عقدة صادقة واحدة في الأقل تنفذ معاملات التجميع وتقدم أدلة على الاحتيال لتحدي انتقالات الحالة غير الصالحة. |
| تستفيد عمليات التجميع من "الحيوية التي لا تعتمد على الثقة" (يمكن لأي شخص إجبار السلسلة على التقدم من خلال تنفيذ المعاملات ونشر التأكيدات)          | يجب على المستخدمين الانتظار حتى انتهاء فترة التحدي التي تبلغ أسبوعًا واحدًا قبل سحب الأموال مرة أخرى إلى Ethereum.               |
| تعتمد عمليات التجميع المتفائلة على حوافز اقتصادية مشفرة مصممة جيدًا لزيادة الأمان على السلسلة.                                                        | يجب على التجميعات نشر جميع بيانات المعاملات على السلسلة، مما قد يؤدي إلى زيادة التكاليف.                                         |
| يتيح التوافق مع EVM وSolidity للمطورين نقل العقود الذكية الأصلية لـ Ethereum إلى التجميعات أو استخدام الأدوات الموجودة لإنشاء تطبيقات لامركزية جديدة. |                                                                                                                                                  |

### شرح مرئي لعمليات الرول أب التفائلية {#optimistic-video}

أتريد المزيد من المعلومات المرئية؟ شاهد شرح Finematics للتجمعات المتفائلة:

<YouTube id="7pWxCklcNsU" start="263" />

## قراءات إضافية حول التجميعات المتفائلة

- [كيف تعمل عمليات الرول أب التفائلية (الدليل الكامل)](https://www.alchemy.com/overviews/optimistic-rollups)
- [ما هو رول أب البلوكتشين؟ مقدمة تقنية](https://www.ethereum-ecosystem.com/blog/what-is-a-blockchain-rollup-a-technical-introduction)
- [الدليل الأساسي لـ Arbitrum](https://www.bankless.com/the-essential-guide-to-arbitrum)
- [الدليل العملي لعمليات رول أب إيثريوم](https://web.archive.org/web/20241108192208/https://research.2077.xyz/the-practical-guide-to-ethereum-rollups)
- [حالة إثباتات الاحتيال في الطبقة الثانية من إيثريوم](https://web.archive.org/web/20241124154627/https://research.2077.xyz/the-state-of-fraud-proofs-in-ethereum-l2s)
- [كيف يعمل رول أب Optimism حقًا؟](https://www.paradigm.xyz/2021/01/how-does-optimism-s-rollup-really-work)
- [نظرة معمقة على OVM](https://medium.com/ethereum-optimism/ovm-deep-dive-a300d1085f52)
- [ما هي الآلة الافتراضية التفاؤلية؟](https://www.alchemy.com/overviews/optimistic-virtual-machine)
