---
title: Oracles عقود التعاملات خارج الشبكة
description: توفر الأوراك يل عقود Ethereum الذكية بإمكانية الوصول إلى البيانات الواقعية، مما يفتح المزيد من حالات الاستخدام ويزيد من القيمة للمستخدمين.
lang: ar
---

بلوكتشينبلوكتشينبلوكتشينبلوكتشينبلوكتشينالأوراك هي تطبيقات تنتج تدفقات بيانات تجعل مصادر البيانات خارج السلسلة متاحة لتقنية البلوكشين لعقود ذكية. لأن عقود الإيثريوم الذكية لا يمكنها، بشكل افتراضي، الوصول إلى المعلومات المخزنة خارج شبكة البلوكتشين.

توفير القدرة للعقود الذكية على التنفيذ باستخدام البيانات خارج السلسلة يوسع من فائدة وقيمة التطبيقات اللامركزية. على سبيل المثال، تعتمد أسواق التنبؤ على السلسلة على أوكلز لتوفير المعلومات حول النتائج التي تستخدمها للتحقق من توقعات المستخدمين. افترض أن أليس تراهن بـ 20 إيثريوم على من سيصبح الرئيس القادم للولايات المتحدة. رئيس. في هذه الحالة، يحتاج تطبيق سوق التنبؤ إلى Oracle لتأكيد نتائج الانتخابات وتحديد ما إذا كانت أليس مؤهلة للحصول على مكافأة.

## المتطلبات الأساسية {#prerequisites}

تفترض هذه الصفحة أن القارئ على دراية بأساسيات إيثريوم، بما في ذلك [العُقد](/developers/docs/nodes-and-clients/)، و[آليات الإجماع](/developers/docs/consensus-mechanisms/)، و[آلة إيثريوم الافتراضية (EVM)](/developers/docs/evm/). يجب أن يكون لديك أيضًا فهم جيد [للعقود الذكية](/developers/docs/smart-contracts/) و[تشريح العقود الذكية](/developers/docs/smart-contracts/anatomy/)، وخاصة [الأحداث](/glossary/#events).

## ما هو أوراكل البلوكشين؟ {#what-is-a-blockchain-oracle}

الأوراكل هي تطبيقات تقوم بالحصول على المعلومات الخارجية (أي المعلومات المخزنة خارج السلسلة) والتحقق منها ونقلها إلى العقود الذكية التي تعمل على سلسلة الكتل. بجانب "سحب" البيانات من خارج الشبكة وبثها على إيثريوم، يمكن للأورالك أيضًا "دفع" المعلومات من البلوكشين إلى أنظمة خارجية، مثل فتح قُفْل ذكي بمجرد أن يرسل المستخدم رسومًا عبر معاملة إيثريوم.

بدون وجود وسيط، سيكون العقد الذكي محدودًا تمامًا بالبيانات على السلسلة.

تختلف الأنظمة المقدسة بناءً على مصدر البيانات (مصدر واحد أو مصادر متعددة)، ونماذج الثقة (مركزية أو لامركزية)، وهندسة النظام (قراءة فورية، نشر-اشتراك، واستجابة-طلب). يمكننا أيضًا التمييز بين الأدرياتيكي بناءً على ما إذا كانت تسترجع بيانات خارجية لاستخدامها من قبل العقود الذكية على السلسلة (أوركلات الإدخال) أو ترسل المعلومات من البلوكشين إلى التطبيقات خارج السلسلة (أوركلات الإخراج) أو تؤدي مهام حسابية خارج السلسلة (أوركلات الحساب).

## لماذا تحتاج العقود الذكية إلى؟ {#why-do-smart-contracts-need-oracles}

يرى العديد من المطورين العقود الذكية على أنها شفرات تعمل في عناوين محددة على البلوكشين. ومع ذلك، فإن النظرة الأكثر [عمومية للعقود الذكية](/smart-contracts/) هي أنها برامج حاسوبية ذاتية التنفيذ قادرة على فرض الاتفاقات بين الأطراف بمجرد استيفاء شروط معينة - ومن هنا جاء مصطلح "العقود الذكية".

لكن استخدام العقود الذكية لفرض الاتفاقيات بين الناس ليس بالأمر السهل، نظرًا لأن الإيثيريوم معتمد على الحتمية. [النظام الحتمي](https://en.wikipedia.org/wiki/Deterministic_algorithm) هو نظام ينتج دائمًا النتائج نفسها عند إعطاء حالة أولية ومدخل معين، مما يعني عدم وجود عشوائية أو اختلاف في عملية حساب المخرجات من المدخلات.

لتحقيق التنفيذ الحتمي، تحد سلاسل الكتل العقد للوصول إلى إجماع بشأن الأسئلة الثنائية البسيطة (صواب/خطأ) باستخدام البيانات المخزنة على سلسلة الكتل نفسها _فقط_. تشمل أمثلة مثل هذه الأسئلة ما يلي:

- هل قام مالك الحساب (المحدد بمفتاح عام) بتوقيع هذه المعاملة باستخدام المفتاح الخاص المقابل؟
- هل يحتوي هذا الحساب على أموال كافية لتغطية المعاملة؟
- «هل هذه المعاملة صالحة في سياق هذا العقد الذكي؟» وغيرها.

If blockchains received information from external sources (i.e., from the real world), determinism would be impossible to achieve, preventing nodes from agreeing on the validity of changes to the blockchain’s state. خذ على سبيل المثال عقدًا ذكيًا ينفذ عملية بناءً على سعر صرف ETH-USD تم الحصول عليه من واجهة برمجة التطبيقات التقليدية للأسعار. من المحتمل أن يتغير هذا الرَّقَم كثيرًا (فضلاً على أن واجهة برمجة التطبيقات يمكن أن تُهمل أو تتعرض للاختراق)، مما يعني أن العقد الذي تنفذ نفس كود العقد قد تصل إلى نتائج مختلفة.

بالنسبة ليتبلبلون عام مثل إيثريوم، الذي يحتوي على آلاف العقد حول العالم لمعالجة المعاملات، عدّ الحتمية أمرًا حيويًا. نظرًا لعدم وجود سلطة مركزية تعمل كمصدر للحقائق، تحتاج العقد إلى آليات للتوصل إلى نفس الحالة بعد تطبيق نفس المعاملات. حالة حيث يقوم العقد A بتنفيذ شفرة العقد الذكي ويحصل على "3" كنتيجة، بينما يحصل العقد B على "7" بعد تنفيذ نفس المعاملة ستؤدي إلى انهيار التوافق وتقضي على قيمة الإيثيريوم كمنصة حوسبة لامركزية.

تسلط هذا السيناريو الضوء أيضًا على المشكلة المتمثلة في تصميم بلوجينزات لسحب المعلومات من مصادر خارجية. ومع ذلك، تحل الأوراك هذه المشكلة من خلال أخذ المعلومات من مصادر خارج السلسلة وتخزينها على البلوكشين لاستخدامها من قبل العقود الذكية. نظرًا لأن المعلومات المخزنة على السلسلة لا يمكن تغييرها ومتاحة للجمهور، يمكن لعقد إيثريوم استخدام البيانات المستوردة من خارج السلسلة بأمان لحساب تغييرات الحالة دون كسر التوافق.

للقيام بذلك، يتكون الأوراك عادة من عقد ذكي يعمل على السلسلة وبعض المكونات خارج السلسلة. العقد على السلسلة يتلقى طلبات البيانات من عقود ذكية أخرى، والتي الفعل من تمريرها إلى المكون الخارجي (المسمى عقد الأورك). يمكن لهذه العقدة الأورك استعلام مصادر البيانات - باستخدام واجهات برمجة التطبيقات ، على سبيل المثال - وإرسال المعاملات لتخزين البيانات () المطلوبة في تخزين العقد الذكية.

أساسياً، تعمل أورور بلوك تشين كحلقة وصل بين المعلومات على البلوكتشين والبيئة الخارجية، مما يخلق "عقود ذكية هجينة". العقد الذكي الهجين هو الذي يعمل بناءً على مزيج من كود العقد على السلسلة والبنية التحتية خارج السلسلة. أسواق التنبؤ اللامركزية هي مثال ممتاز على العقود الذكية الهجينة. أسواق التنبؤ اللامركزية هي مثال ممتاز على العقود الذكية الهجينة.

## ما هي مشكلة العراف؟ مشكلة أوراكل {#the-oracle-problem}

الأوراك تحل مشكلة مهمة، لكنها أيضًا تُدخل بعض التعقيدات، مثل.,:

- كيف نتحقق أن المعلومات المُحقنة تم استخراجها من المصدر الصحيح أو لم يتم العبث بها؟

- كيف نضمن أن هذه البيانات متاحة دائمًا ومحدثة بانتظام؟

المشكلة المعروفة باسم "مشكلة " تظهر القضايا التي تنشأ عند استخدام في البلوك تشين لإرسال المدخلات إلى العقود الذكية. يجب أن تكون البيانات من أوراكل صحيحة حتى يتم تنفيذ العقد الذكي بشكل صحيح. إضافةً إلى ذلك، فإن الحاجة إلى 'الثقة' في مشغلي الأوراك يل لتوفير معلومات دقيقة الجانب 'غير القائم على الثقة' للعقود الذكية.

تقدم مختلفة حلولًا مختلفة لمشكلة، والتي نستكشفها لاحقًا. عادةً ما يتم تقييم العرافين بناءً على مدى قدرتهم على التعامل مع التحديات التالية:

1. **الصحة**: يجب ألا يتسبب أوراكل في إحداث تغييرات في الحالة للعقود الذكية بناءً على بيانات غير صالحة من خارج السلسلة. يجب على أوراكل أن يضمن _موثوقية_ و_سلامة_ البيانات. تعني الموثوقية أن البيانات تم الحصول عليها من المصدر الصحيح، بينما تعني السلامة أن البيانات ظلت سليمة (أي لم يتم تغييرها) قبل إرسالها على السلسلة.

2. **التوافر**: يجب ألا يؤخر أوراكل أو يمنع العقود الذكية من تنفيذ الإجراءات وإحداث تغييرات في الحالة. هذا يعني أن البيانات من أوراكل يجب أن تكون _متاحة عند الطلب_ دون انقطاع.

3. **توافق الحوافز**: يجب أن يحفز أوراكل مزودي البيانات من خارج السلسلة على تقديم معلومات صحيحة للعقود الذكية. يتضمن توافق الحوافز _قابلية الإسناد_ و_المساءلة_. تتيح إمكانية النسب ربط قطعة من المعلومات الخارجية بمزودها، بينما تلزم المساءلة مزودي البيانات بالمعلومات التي يقدمنها، حتى يمكن مكافأتهم أو معاقبتهم بناءً على جودة المعلومات المزودة.

## كيف تعمل خدمة أوراكل البلوكشين؟ {#how-does-a-blockchain-oracle-service-work}

### المستخدمون {#users}

المستخدمون هم كيانات (أي، العقود الذكية) تحتاج إلى معلومات خارج سلسلة الكتل لإكمال إجراءات محددة. تبدأ عملية سير العمل الأساسية لخدمة الأورك بإرسال المستخدم طلب بيانات إلى عقد الأورك. طلبات البيانات ستجيب عادةً على بعض أو كل الأسئلة التالية:

1. ما المصادر الذي يمكن أن تستشيرها العقد غير المتصلة بالإنترنت للحصول على المعلومات المطلوبة؟

2. كيف يقوم الصحفيون بمعالجة المعلومات من مصادر البيانات واستخراج نقاط البيانات المفيدة؟

3. كم عدد عقد الذي يمكن أن تشارك في استرجاع البيانات؟

4. كيف يجب إدارة الاختلافات في تقارير الأوراك؟

5. ما الطريقة التي يجب تنفيذها لتصفية التقديمات وتجميع التقارير في قيمة واحدة؟

### عقد أوراكل {#oracle-contract}

عقد الأورك هو المكون الموجود على السلسلة لخدمة الأورك. إنه يستمع لطلبات البيانات من العقود الأخرى، ينقل استفسارات البيانات إلى عقد الأوراك، ويبث البيانات المعادة إلى عقود العملاء. يمكن أن يقوم هذا العقد أيضاً بإجراء بعض الحسابات على نقاط البيانات المسترجعة لإنتاج قيمة إجمالية لإرسالها إلى العقد المطلوب.

عقد الأوراك يكشف بعضا لدوال التي تستدعيها عقود العملاء عند إجراء طلب بيانات. عند استلام استعلام جديد، سيصدر العقد الذكي [حدث سجل](/developers/docs/smart-contracts/anatomy/#events-and-logs) يتضمن تفاصيل طلب البيانات. يؤدي هذا إلى إشعار العُقد خارج السلسلة المشتركة في السجل (عادةً باستخدام أمر مثل `eth_subscribe` الخاص بـ JSON-RPC)، والتي تشرع في استرداد البيانات المحددة في حدث السجل.

فيما يلي [مثال لعقد أوراكل](https://medium.com/@pedrodc/implementing-a-blockchain-oracle-on-ethereum-cedc7e26b49e) من تصميم Pedro Costa. هذه خدمة أوركل بسيطة يمكنها الاستعلام عن واجهات برمجة التطبيقات الخارجية عند الطلب من عقود ذكية أخرى وتخزين المعلومات المطلوبة على البلوكشين:

```solidity
pragma solidity >=0.4.21 <0.6.0;

contract Oracle {
  Request[] requests; //قائمة الطلبات المقدمة إلى العقد
  uint currentId = 0; //معرف طلب متزايد
  uint minQuorum = 2; //الحد الأدنى لعدد الاستجابات التي يجب تلقيها قبل إعلان النتيجة النهائية
  uint totalOracleCount = 3; // عدد أوراكل المكتوب في الشيفرة البرمجية

  // يُعرّف طلبًا عامًا لواجهة برمجة التطبيقات
  struct Request {
    uint id;                            //معرف الطلب
    string urlToQuery;                  //عنوان URL الخاص بواجهة برمجة التطبيقات
    string attributeToFetch;            //سمة json (مفتاح) لاستردادها في الاستجابة
    string agreedValue;                 //قيمة من المفتاح
    mapping(uint => string) answers;     //الإجابات المقدمة من الأوراكل
    mapping(address => uint) quorum;    //الأوراكل التي ستستعلم عن الإجابة (1=الأوراكل لم يصوت بعد، 2=الأوراكل قد صوت)
  }

  //حدث يُفعّل الأوراكل خارج سلسلة الكتل
  event NewRequest (
    uint id,
    string urlToQuery,
    string attributeToFetch
  );

  //يُفعَّل عند وجود إجماع على النتيجة النهائية
  event UpdatedRequest (
    uint id,
    string urlToQuery,
    string attributeToFetch,
    string agreedValue
  );

  function createRequest (
    string memory _urlToQuery,
    string memory _attributeToFetch
  )
  public
  {
    uint length = requests.push(Request(currentId, _urlToQuery, _attributeToFetch, ""));
    Request storage r = requests[length-1];

    // عنوان الأوراكل المكتوب في الشيفرة البرمجية
    r.quorum[address(0x6c2339b46F41a06f09CA0051ddAD54D1e582bA77)] = 1;
    r.quorum[address(0xb5346CF224c02186606e5f89EACC21eC25398077)] = 1;
    r.quorum[address(0xa2997F1CA363D11a0a35bB1Ac0Ff7849bc13e914)] = 1;

    //إطلاق حدث ليتم اكتشافه بواسطة الأوراكل خارج سلسلة الكتل
    emit NewRequest (
      currentId,
      _urlToQuery,
      _attributeToFetch
    );

    //زيادة معرف الطلب
    currentId++;
  }

  //يستدعيه الأوراكل لتسجيل إجابته
  function updateRequest (
    uint _id,
    string memory _valueRetrieved
  ) public {

    Request storage currRequest = requests[_id];

    //التحقق مما إذا كان الأوراكل في قائمة الأوراكل الموثوقة
    //وما إذا كان الأوراكل لم يصوت بعد
    if(currRequest.quorum[address(msg.sender)] == 1){

      //تمييز أن هذا العنوان قد صوت
      currRequest.quorum[msg.sender] = 2;

      //التكرار عبر "مصفوفة" الإجابات حتى يصبح موضع ما فارغًا وحفظ القيمة المستردة
      uint tmpI = 0;
      bool found = false;
      while(!found) {
        //البحث عن أول خانة فارغة
        if(bytes(currRequest.answers[tmpI]).length == 0){
          found = true;
          currRequest.answers[tmpI] = _valueRetrieved;
        }
        tmpI++;
      }

      uint currentQuorum = 0;

      //التكرار عبر قائمة الأوراكل والتحقق مما إذا كان عدد كافٍ من الأوراكل (الحد الأدنى للنصاب)
      //قد صوتوا بنفس الإجابة الحالية
      for(uint i = 0; i < totalOracleCount; i++){
        bytes memory a = bytes(currRequest.answers[i]);
        bytes memory b = bytes(_valueRetrieved);

        if(keccak256(a) == keccak256(b)){
          currentQuorum++;
          if(currentQuorum >= minQuorum){
            currRequest.agreedValue = _valueRetrieved;
            emit UpdatedRequest (
              currRequest.id,
              currRequest.urlToQuery,
              currRequest.attributeToFetch,
              currRequest.agreedValue
            );
          }
        }
      }
    }
  }
}
```

### عُقد أوراكل {#oracle-nodes}

عقدة الأورك هي المكون الخارجي لخدمة الأورك. يستخرج المعلومات من مصادر خارجية، مثل واجهات برمجة التطبيقات المستضافة على خوادم تابعة لأطراف ثالثة، ويضعها على السلسلة للاستخدام من قبل العقود الذكية. تستمع عقد أوراكل للأحداث من عقد أوراكل على السلسلة وتتابع لإكمال المهمة الموضحة في السجل.

تتمثل إحدى المهام الشائعة لعُقد أوراكل في إرسال طلب [HTTP GET](https://www.w3schools.com/tags/ref_httpmethods.asp) إلى خدمة واجهة برمجة التطبيقات (API)، وتحليل الاستجابة لاستخراج البيانات ذات الصلة، وتنسيقها في مخرجات قابلة للقراءة بواسطة سلسلة الكتل، وإرسالها على السلسلة من خلال تضمينها في معاملة إلى عقد أوراكل. قد يتعين أيضًا على عقدة الأور كل أن تشهد على صحة وسلامة المعلومات المقدمة باستخدام "أدلة الأصالة"، والتي نستعرضها لاحقًا.

تستند الأوراق الحسابية أيضًا إلى عقد خارج السلسلة لأداء المهام الحسابية التي سيكون من غير العملي تنفيذها على السلسلة، نظرًا لتكاليف الغاز وحدود حجم الكتلة. على سبيل المثال، قد يتم تكليف عقدة الأور كل بإنشاء رَقْم عشوائي قابل للتحقق (على سبيل المثال، للألعاب القائمة على).

## أنماط تصميم أوراكل {#oracle-design-patterns}

تأتي الأوراكل في أنواع مختلفة، بما في ذلك _القراءة الفورية_، و_النشر والاشتراك_، و_الطلب والاستجابة_، حيث يُعد النوعان الأخيران الأكثر شيوعًا بين عقود إيثريوم الذكية. هنا نصف بإيجاز نماذج النشر والاشتراك ونموذج الطلب والاستجابة.

### أوراكل النشر والاشتراك {#publish-subscribe-oracles}

هذا النوع من الأور اكل يكشف عن "تغذية بيانات" يمكن للعقود الأخرى قراءتها بانتظام للحصول على المعلومات. من المتوقع أن تتغير البيانات في هذه الحالة بشكل متكرر، لذا يجب على عقود العميل الاستماع للتحديثات المتعلقة بالبيانات في تخزين الأور كل. مثال على ذلك هو أوركل يقدم معلومات أسعار ETH-USD الأحدث للمستخدمين.

### أوراكل الطلب والاستجابة {#request-response-oracles}

يسمح إعداد الطلب-الاستجابة لعقد العميل بطلب بيانات عشوائية غير تلك الذي يوفرها معالج النشر-الاشتراك. إن طلب-استجابة مثالية عندما تكون مجموعة البيانات كبيرة جدًا بحيث لا يمكن تخزينها في تخزين العقد الذكي، و/أو عندما يحتاج المستخدمون فقط إلى جزء صغير من البيانات في أي وقت.

على الرغم من أنها أكثر تعقيدًا من نماذج النشر-الاشتراك، فإن الأوراك يل التي تعتمد على الطلب-الاستجابة هي في الأساس ما وصفناه في القسم السابق. سيكون للعرّاف مكوّن على السلسلة يستقبل طلب بيانات وينقله إلى عقدة خارج السلسلة للمعالجة.

يجب على المستخدمين الذين يقومون ببدء استعلامات البيانات أن يتحملوا تكلفة استرجاع المعلومات من المصدر الخارجي. يجب أن يتضمن عقد العميل أيضًا أموالًا لتغطية تكاليف الغاز الذي تتحملها عقد الأور كل عند إرجاع الاستجابة عبر دالة الاستدعاء المحددة في الطلب.

## الأوراكل المركزية مقابل اللامركزية {#types-of-oracles}

### الأوراكل المركزية {#centralized-oracles}

تُدار أوركل مركزي من قبل كيان واحد مسؤول عن تجميع المعلومات الخارجية وتحديث بيانات عقد الأور كل حسب الطلب. عدّ المركزية فعالة لأنها تعتمد على مصدر وحيد للحقيقة. قد تعمل بشكل أفضل في الحالات التي يتم فيها نشر مجموعات البيانات المملوكة مباشرة من قبل المالك مع توقيع مقبول على نطاق واسع. ومع ذلك، فإنها تحمل بعض العيوب كذلك:

#### ضمانات صحة منخفضة {#low-correctness-guarantees}

مع الأوراق المركزية، لا يوجد طريقة للتأكد مما إذا كانت المعلومات المقدمة صحيحة أم لا. حتى مقدمي الخدمة "المرموقين" يمكن أن يخرجوا عن السيطرة أو يتعرضوا للاختراق. إذا أصبح العراف فاسدًا، ستنفذ العقود الذكية بناءً على بيانات خاطئة.

#### ضعف التوافر {#poor-availability}

لا تضمن الأوراق المركزية دائمًا توفر البيانات خارج السلسلة للعقود الذكية الأخرى. إذا قرر المزود إيقاف الخدمة أو إذا قامه اكر باختراق مكون الأور اكل خارج السلسلة، فإن عقدك الذكي يواجه خطر هجوم ().

#### ضعف توافق الحوافز {#poor-incentive-compatibility}

غالبًا ما تحتوي الأرواح المركزية على حوافز ضعيفة أو غير موجودة لجعل مزود البيانات يرسل معلومات دقيقة وغير معدلة. دفع ثمن للعراف من أجل الدقة لا يضمن الأمانة. تزداد هذه المشكلة مع زيادة كمية القيمة التي تتحكم فيها العقود الذكية.

### الأوراكل اللامركزية {#decentralized-oracles}

تم تصميم الأور اكل اللامركزية للتغلب على قيود الأور اكل المركزية من خلال القضاء على نقاط الفشل الفردية. تشمل خدمة اللامركزية العديد من المشاركين في شبكة نظير إلى نظير تتوصل إلى توافق بشأن البيانات الخارجية قبل إرسالها إلى عقد ذكي.

من المفترض أن يكون () الأور كل اللامركزي غير خاضع للتصاريح، وغير موثوق، وخالياً من الإدارة من قبل طرف مركزي؛ ولكن في الواقع، فإن اللامركزية بين الأور كل تحزن على طيف. هناك شبكات أوراكل شبه لامركزية حيث يمكن لأي شخص المشاركة، ولكن مع "مالك" يوافق على ويزيل العقد بناءً على الأداء التاريخي. توجد أيضًا شبكات أوراكل لامركزية بالكامل: عادة ما تعمل هذه الشبكات كسلاسل كتلة مستقلة ولها آليات توافق محددة لتنسيق العقد ومعاقبة السلوك السيئ.

تأتي استخدام الأور كلز اللامركزية مع الفوائد التالية:

### ضمانات صحة عالية {#high-correctness-guarantees}

تحاول اللامركزية تحقيق صحة البيانات باستخدام أساليب مختلفة. يشمل ذلك استخدام أدلة تشهد على صحة وسلامة المعلومات المعادة و كيانات متعددة بالتوافق جماعياً على صحة البيانات خارج الشبكة.

#### إثباتات الموثوقية {#authenticity-proofs}

أدلة الأصالة هي آليات تشفيرية تمكّن من التحقق المستقل من المعلومات المستخرجة من مصادر خارجية. يمكن لهذه الأدلة التحقق من مصدر المعلومات وكشف التغييرات المحتملة على البيانات بعد استرجاعها.

تشمل أمثلة على أدلة الأصالة ما يلي:

**إثباتات أمان طبقة النقل (TLS)**: غالبًا ما تسترد عُقد أوراكل البيانات من مصادر خارجية باستخدام اتصال HTTP آمن يعتمد على بروتوكول أمان طبقة النقل (TLS). تستخدم بعض الأوراق اللامركزية أدلة الأصالة للتحقق من جلسات TLS (أي تأكيد تبادل المعلومات بين عقدة وخادم معين) وتأكيد أن محتويات الجِلسة لم تتعرض لأي تغيير.

**شهادات بيئة التنفيذ الموثوقة (TEE)**: [بيئة التنفيذ الموثوقة](https://en.wikipedia.org/wiki/Trusted_execution_environment) (TEE) هي بيئة حوسبة معزولة عن العمليات التشغيلية لنظامها المضيف. تضمن بيئات التنفيذ الموثوقة أن أي كود تطبيق أو بيانات مخزنة / مستخدمة في بيئة الحساب تحتفظ بالنزاهة والسرية والثبات. يمكن للمستخدمين أيضًا إنشاء شهادة لإثبات أن حالة التطبيق تعمل داخل بيئة التنفيذ الموثوقة.

تتطلب بعض فئات الأورال اللامركزية من مشغلي عقد الأورال تقديم شهادات TEE. هذا يؤكد للمستخدم أن مشغل العقدة تشغيل نسخة من عميل الأور اكل في بيئة تنفيذ موثوقة. تقوم البيئات التنفيذية الموثوقة بمنع العمليات الخارجية من تعديل أو قراءة شفرة التطبيق وبياناته، وبالتالي، تثبت تلك الشهادات أن عقدة الأور اكل قد حافظت على المعلومات سليمة وسرية.

#### التحقق من صحة المعلومات القائم على الإجماع {#consensus-based-validation-of-information}

تعتمد الأرواح المركزية على مصدر واحد للحقيقة عند تقديم البيانات للعقود الذكية، مما يقدم إمكانية نشر معلومات غير دقيقة. تقوم الأور اكل اللامركزية بحل هذه المشكلة من خلال الاعتماد على عدة عقد أوراكل لجلب المعلومات من خارج الشبكة. من خلال مقارنة البيانات من مصادر متعددة، تقلل الأوراك لات اللامركزية من خطر تمرير معلومات غير صحيحة إلى العقود الذكية.

ومع ذلك، يجب على تتراكلي اللامركزية التعامل مع الفُرُوق في المعلومات المستمدة من مصادر خارج السلسلة متعددة. لتقليل الفروق في المعلومات وضمان أن البيانات المرسلة إلى عقد الأور اكل تظهر الرأي الجماعي لعقد الأور اكل، تستخدم الأور اكل اللامركزية الآليات التالية:

##### التصويت/الاستثمار في دِقَّة البيانات

بعض شبكات الأور كل اللامركزية تتطلب من المشاركين التصويت أو المراهنة على دِقَّة الإجابات على استفسارات البيانات (مثل "من فاز في انتخابات الولايات المتحدة عام 2020؟") استخدام الرموز الأصلية للشبكة. ثم يقوم بروتوكول التجميع بتجميع الأصوات والرهانات ويأخذ الإجابة المدعومة من الغالبية كالإجابة الصحيحة.

العقد الذي تختلف إجاباتها عن الإجابة الأكثر شيوعًا تُعاقب بتوزيع رموزها على الآخرين الذين يقدمون قيمًا أكثر صحة. إجبار العقد على تقديم ضمان قبل تقديم البيانات يحفز الردود الصادقة حيث يُفترض أنهم فاعلون اقتصاديون عقلانيون يسعون إلى تعظيم العوائد.

يحمي تجميد العملات/التصويت أيضًا الأوراكل اللامركزية من [هجمات سيبيل](/glossary/#sybil-attack) حيث ينشئ المهاجمون هويات متعددة للتلاعب بنظام الإجماع. ومع ذلك، فإن الرهان لا يمكن أن يمنع "الاستغلال" (عقد الأوراق المالية التي تنسخ المعلومات من الآخرين) و"التحقق الكسلان" (عقد الأوراق المالية التي تتبع الأغلبية دون التحقق من المعلومات بأنفسهم).

##### آليات نقطة شيلينا

[نقطة شيلينغ](https://en.wikipedia.org/wiki/Focal_point_\(game_theory\)) هي مفهوم في نظرية الألعاب يفترض أن كيانات متعددة ستلجأ دائمًا إلى حل مشترك لمشكلة ما في غياب أي تواصل. تُستخدم آليات نقطة شيلينا غالبًا في شبكات الأوراك يل اللامركزية لتمكين العقد من التوصل إلى توافق في الآراء بشأن الإجابات على طلبات البيانات.

كانت إحدى الأفكار المبكرة لهذا هي [SchellingCoin](https://blog.ethereum.org/2014/03/28/schellingcoin-a-minimal-trust-universal-data-feed/)، وهي تغذية بيانات مقترحة حيث يقدم المشاركون إجابات على الأسئلة "العددية" (الأسئلة التي توصف إجاباتها من حيث الحجم، على سبيل المثال، "ما هو سعر ETH؟")، إلى جانب وديعة. تتم مكافأة المستخدمين الذين يقدمون قيمًا بين [الشريحة المئوية](https://en.wikipedia.org/wiki/Percentile) 25 و 75، بينما تتم معاقبة أولئك الذين تنحرف قيمهم بشكل كبير عن القيمة الوسيطة.

على الرغم من أن SchellingCoin غير موجودة اليوم، فإن عددًا من الأوراكل اللامركزية - وأبرزها [أوراكل بروتوكول Maker](https://docs.makerdao.com/smart-contract-modules/oracle-module) - تستخدم آلية نقطة شيلينغ لتحسين دقة بيانات أوراكل. يتكون كل أوراكِل من Maker من شبكة نظير إلى نظير (P2P) خارج السلسلة من العقد "المرسلين" و"المغذيات" الذين يقدمون أسعار السوق للأصول الضامنة، وعقد "الميسيسيبي" على السلسلة التي يحسب الوسيط لجميع القيم المقدمة. بمجرد انتهاء فترة التأخير المحددة، تصبح هذه القيمة ألوسيطيه هي السعر المرجعي الجديد للأصل المرتبط بها.

تشمل الأمثلة الأخرى للأوراكل التي تستخدم آليات نقطة شيلينغ [تقارير Chainlink خارج السلسلة](https://docs.chain.link/architecture-overview/off-chain-reporting) و [Witnet](https://witnet.io/). في كلا النظامين، يتم تجميع إجابات عقد الأور اكل في شبكة النظير إلى النظير في قيمة مجمعة واحدة، مثل المتوسط أو الوسيط. يتم مكافأة أو معاقبة العقد وفقًا لمدى توافق إجاباتها مع القيمة المجمعة أو انحرافها عنها.

تعد آليات نقطة شيلينا جذابة لأنها تقلل الأثر على السلسلة (حيث يلزم إرسال معاملة واحدة فقط) مع ضمان اللامركزية. ويكون ذلك ممكنًا لأن العقد يجب أن توقع على قائمة الإجابات المقدمة قبل إدخالها في الخوارزمية التي تنتج القيمة المتوسطة أو ألوسيطيه.

### التوافر {#availability}

تضمن خدمات الأور اكل اللامركزية توفر عالي للبيانات خارج السلسلة للعقود الذكية. يتم تحقيق ذلك من خلال لامركزية كل من مصدر المعلومات خارج السلسلة والعقد المسؤولة عن نقل المعلومات داخل السلسلة.

هذا يضمن تحمل الأخطاء حيث يمكن لعقد الأور كل الاعتماد على عدة عقد (والتي تعتمد أيضًا على مصادر بيانات متعددة) لتنفيذ الاستعلامات من عقود أخرى. تُعد اللامركزية على مستوى المصدر _و_ مشغل العقدة أمرًا بالغ الأهمية - حيث إن شبكة من عُقد أوراكل التي تخدم المعلومات المسترجعة من المصدر نفسه ستواجه المشكلة نفسها التي يواجهها أوراكل مركزي.

من الممكن أيضًا أن تقوم الأوراك يل المعتمدة على الحصة بخصم أو فرض غرامة على مشغلي العقد الذين أخفق. هذا يشجع بشكل كبير عقد تتراكلي على الاستثمار في بنية تحتية مقاومة للأعطال وتوفير البيانات في الوقت المناسب.

### توافق جيد للحوافز {#good-incentive-compatibility}

تنفذ الأوراكل اللامركزية تصميمات حوافز مختلفة لمنع السلوك [البيزنطي](https://en.wikipedia.org/wiki/Byzantine_fault) بين عُقد أوراكل. على وجه التحديد، فإنها تحقق _قابلية الإسناد_ و_المساءلة_:

1. تتطلب غالبًا عقد الأور كل اللامركزية توقيع البيانات التي توفرها استجابة لطلبات البيانات. تساعد هذه المعلومات في تقييم الأداء التاريخي لعقد الأور كل، بحيث يمكن للمستخدمين تصفية عقد الأور كل غير الموثوق بها عند تقديم طلبات البيانات. من الأمثلة على ذلك [نظام السمعة الخوارزمي](https://docs.witnet.io/intro/about/architecture#algorithmic-reputation-system) الخاص بـ Witnet.

2. قد تتطلب الأدرياتيكي اللامركزية - كما أوضحنا سابقًا - من العقد أن تضع رهانًا على ثقتها في حقيقة البيانات التي تقدمها. إذا ثبتت صحة المطالبة، يمكن إعادة هذا الرهان مع المكافآت مقابل الخدمة النزيهة. ولكن يمكن أيضًا حذفه في حالة كانت المعلومات غير صحيحة، مما يوفر بعض القياس للمسؤولية.

## تطبيقات الأوراكل في العقود الذكية {#applications-of-oracles-in-smart-contracts}

فيما يلي الحالات الشائعة لاستخدام الأوراق المالية في إيثيريوم:

### استرداد البيانات المالية {#retrieving-financial-data}

تسمح تطبيقات [التمويل اللامركزي](/defi/) (DeFi) بالإقراض والاقتراض وتداول الأصول من نظير إلى نظير. غالبًا ما يتطلب ذلك الحصول على معلومات مالية مختلفة، بما في ذلك بيانات أسعار الصرف (لحساب القيمة النقدية للعملات المشفرة أو لمقارنة أسعار الرموز المميزة) وبيانات الأسواق المالية (لحساب قيمة الأصول المرمزة، مثل الذهب أو الدولار الأمريكي).

على سبيل المثال، يحتاج بروتوكول الإقراض في عالم التمويل اللامركزي إلى الاستعلام عن الأسعار الحالية في السوق للأصول (على سبيل المثال، ETH) المودعة كضمان. هذا يسمح للعقد بتحديد قيمة أصول الضمان وتحديد مقدار ما يمكنه اقتراضه من النظام.

تشمل "أوراكل الأسعار" الشائعة (كما يطلق عليها غالبًا) في التمويل اللامركزي (DeFi) Chainlink Price Feeds، و[Open Price Feed](https://compound.finance/docs/prices) من Compound Protocol، و[الأسعار المتوسطة المرجحة بالوقت (TWAPs)](https://docs.uniswap.org/contracts/v2/concepts/core-concepts/oracles) من Uniswap، و[Maker Oracles](https://docs.makerdao.com/smart-contract-modules/oracle-module).

يجب على البنائين فهم التحذيرات التي تأتي مع هذه التنبؤات السعرية قبل دمجها في مشروعهم. يقدم هذا [المقال](https://blog.openzeppelin.com/secure-smart-contract-guidelines-the-dangers-of-price-oracles/) تحليلاً مفصلاً لما يجب مراعاته عند التخطيط لاستخدام أي من أوراكل الأسعار المذكورة.

فيما يلي مثال على كيفية استرداد أحدث سعر لـ ETH في العقد الذكي الخاص بك باستخدام خدمة أسعار:

```solidity
pragma solidity ^0.6.7;

import "@chainlink/contracts/src/v0.6/interfaces/AggregatorV3Interface.sol";

contract PriceConsumerV3 {

    AggregatorV3Interface internal priceFeed;

    /**
     * الشبكة: Kovan
     * المجمّع: ETH/USD
     * العنوان: 0x9326BFA02ADD2366b30bacB125260Af641031331
     */
    constructor() public {
        priceFeed = AggregatorV3Interface(0x9326BFA02ADD2366b30bacB125260Af641031331);
    }

    /**
     * إرجاع آخر سعر
     */
    function getLatestPrice() public view returns (int) {
        (
            uint80 roundID,
            int price,
            uint startedAt,
            uint timeStamp,
            uint80 answeredInRound
        ) = priceFeed.latestRoundData();
        return price;
    }
}
```

### توليد عشوائية يمكن التحقق منها {#generating-verifiable-randomness}

تتطلب بعض تطبيقات البلوكتشين، مثل الألعاب المعتمدة على البلوكتشين أو خطط اليانصيب، مستوى عالٍ من عدم التنبؤ والعشوائية لتعمل بفعالية. ومع ذلك، فإن التنفيذ المحدد لسلاسل الكتل يقضي على العشوائية.

كان النهج الأصلي هو استخدام دوال التشفير العشوائية الزائفة، مثل `blockhash`، ولكن كان من الممكن [التلاعب بها من قبل المعدِّنين](https://ethereum.stackexchange.com/questions/3140/risk-of-using-blockhash-other-miners-preventing-attack#:~:text=So%20while%20the%20miners%20can,to%20one%20of%20the%20players.) لحل خوارزمية إثبات العمل. أيضًا، يعني [تحول إيثريوم إلى إثبات الحصة](/roadmap/merge/) أن المطورين لم يعد بإمكانهم الاعتماد على `blockhash` للعشوائية على السلسلة. توفر [آلية RANDAO](https://eth2book.info/altair/part2/building_blocks/randomness) الخاصة بسلسلة المنارة مصدرًا بديلاً للعشوائية بدلاً من ذلك.

من الممكن توليد القيمة العشوائية خارج السلسلة وإرسالها إلى داخل السلسلة، ولكن القيام بذلك يفرض متطلبات ثقة عالية على المستخدمين. يجب عليهم أن يعتقدوا أن القيمة قد تم توليدها حقاً من خلال آليات غير متوقعة وأنها لم تتغير أثناء النقل.

تقوم المصممة لحسابات خارج السلسلة بحل هذه المشكلة من خلال توليد نتائج عشوائية بشكل آمن خارج السلسلة ثم بثها على السلسلة مع أدلة تشفيرية تشهد على عدم قابلية التنبؤ بالعملية. من الأمثلة على ذلك [Chainlink VRF](https://docs.chain.link/docs/chainlink-vrf/) (دالة عشوائية يمكن التحقق منها)، وهو مولد أرقام عشوائية (RNG) عادل ويمكن إثباته ومقاوم للتلاعب، وهو مفيد لبناء عقود ذكية موثوقة للتطبيقات التي تعتمد على نتائج غير متوقعة.

### الحصول على نتائج الأحداث {#getting-outcomes-for-events}

مع الأوراق، يصبح إنشاء العقود الذكية التي تستجيب للأحداث الواقعية أمرًا سهلاً. تجعل خدمات أوراكل هذا ممكنًا من خلال السماح للعقود بالاتصال بواجهات برمجة التطبيقات الخارجية من خلال مكونات خارج السلسلة واستخدام المعلومات من هذا المصادر. على سبيل المثال، قد يطلب تطبيق التنبؤ المذكور سابقًا من أوراكل إرجاع نتائج الانتخابات من مصدر موثوق خارج السلسلة (مثل وكالة أسيتدروش برس).

استخدام الأوراق لاسترجاع البيانات استنادًا إلى النتائج الواقعية يتيح حالات استخدام جديدة؛ على سبيل المثال، يحتاج منتج التأمين اللامركزي إلى معلومات دقيقة حول الطقس والكوارث، إلخ، ليعمل بفعالية.

### أتمتة العقود الذكية {#automating-smart-contracts}

العقود الذكية لا تعمل تلقائيًا؛ بل يجب أن يقوم حساب مملوك خارجي (EOA) أو حساب عقد آخر بتحفيز الوظائف الصحيحة لتنفيذ شيفرة العقد. في معظم الحالات، تكون معظم وظائف العقد عامة ويمكن الاستدعاء إليها من قبل الكيانات الخارجية والعقود الأخرى.

ولكن هناك أيضًا _دوال خاصة_ داخل العقد لا يمكن للآخرين الوصول إليها، ولكنها ضرورية للوظائف العامة للتطبيق اللامركزي. تشمل الأمثلة دالة `mintERC721Token()` التي تسك بشكل دوري رموز NFT جديدة للمستخدمين، أو دالة لمنح المدفوعات في سوق التنبؤات، أو دالة لفتح الرموز المجمّدة في بورصة لامركزية (DEX).

سيحتاج المطورون إلى تشغيل مثل هذه الوظائف على فترات للحفاظ على سير التطبيق بسلاسة. ومع ذلك، فقد يؤدي هذا إلى فقدان المزيد من الساعات في مهام روتينية للمطورين، وهذا هو السبب في أن أتمته تنفيذ العقود الذكية جذابة.

تقدم بعض شبكات الأور اكل اللامركزية خدمات مالأتم، مما يسمح لعقد الأور اكل خارج السلسلة بتفعيل وظائف العقود الذكية وفقًا للمعايير التي يحددها المستخدم. عادةً ما يتطلب ذلك "تسجيل" العقد المستهدف مع خدمة الأور كل، وتوفير الأموال لدفع مشغل الأور كل، وتحديد الشروط أو الأوقات التي تُفعّل العقد.

توفر [شبكة Keeper](https://chain.link/keepers) من Chainlink خيارات للعقود الذكية للاستعانة بمصادر خارجية لمهام الصيانة الدورية بطريقة لامركزية ومُقلَّصة الثقة. اقرأ [توثيق Keeper الرسمي](https://docs.chain.link/docs/chainlink-keepers/introduction/) للحصول على معلومات حول جعل عقدك متوافقًا مع Keeper واستخدام خدمة Upkeep.

## كيفية استخدام أوراكل سلسلة الكتل {#use-blockchain-oracles}

هناك العديد من تطبيقات الأور اكل التي يمكنك دمجها في تطبيقات إيثريوم اللامركزية الخاصة بك:

**[Chainlink](https://chain.link/)** - _توفر شبكات أوراكل Chainlink اللامركزية مدخلات ومخرجات وحسابات مقاومة للتلاعب لدعم العقود الذكية المتقدمة على أي سلسلة كتل._

**[RedStone Oracles](https://redstone.finance/)** - _RedStone هو أوراكل معياري لامركزي يوفر تغذيات بيانات محسنة للغاز._ يختص بتقديم أسعار لتغذية الأصول الناشئة، مثل رموز الستين السائلة ()، ورموز الاستعادة السائلة ()، والمشتقات المرتبطة بستباناكيرت بتكوين._

**[Chronicle](https://chroniclelabs.org/)** - _تتغلب Chronicle على القيود الحالية لنقل البيانات على السلسلة من خلال تطوير أوراكل قابلة للتطوير وفعالة من حيث التكلفة ولامركزية ويمكن التحقق منها حقًا._

**[Witnet](https://witnet.io/)** - _Witnet هو أوراكل غير مسموح به ولامركزي ومقاوم للرقابة يساعد العقود الذكية على التفاعل مع أحداث العالم الحقيقي بضمانات اقتصادية مشفرة قوية._

**[UMA Oracle](https://uma.xyz)** - _يسمح أوراكل UMA المتفائل للعقود الذكية باستلام أي نوع من البيانات بسرعة لمختلف التطبيقات، بما في ذلك التأمين والمشتقات المالية وأسواق التنبؤات._

**[Tellor](https://tellor.io/)** - _Tellor هو بروتوكول أوراكل شفاف وغير مسموح به لعقدك الذكي للحصول بسهولة على أي بيانات كلما احتاج إليها._

**[Band Protocol](https://bandprotocol.com/)** - _Band Protocol عبارة عن منصة أوراكل للبيانات عبر السلاسل تقوم بتجميع بيانات العالم الحقيقي وواجهات برمجة التطبيقات وربطها بالعقود الذكية._

**[Pyth Network](https://pyth.network/)** - _شبكة Pyth هي شبكة أوراكل مالية من الطرف الأول مصممة لنشر بيانات العالم الحقيقي المستمرة على السلسلة في بيئة مقاومة للتلاعب ولامركزية ومستدامة ذاتيًا._

**[API3 DAO](https://www.api3.org/)** - _تقدم API3 DAO حلول أوراكل من الطرف الأول التي توفر شفافية وأمانًا وقابلية أكبر للتوسع في المصدر في حل لامركزي للعقود الذكية._

**[Supra](https://supra.com/)** - مجموعة أدوات متكاملة رأسيًا من الحلول عبر السلاسل التي تربط جميع سلاسل الكتل، العامة (L1s و L2s) أو الخاصة (المؤسسات)، مما يوفر تغذيات أسعار أوراكل لامركزية يمكن استخدامها لحالات الاستخدام على السلسلة وخارجها.

**[Gas Network](https://gas.network/)** - منصة أوراكل موزعة توفر بيانات أسعار الغاز في الوقت الفعلي عبر سلسلة الكتل. من خلال جلب البيانات من كبار مزودي بيانات أسعار الغاز على السلسلة، تساعد شبكة الغاز (Gas Network) على تعزيز قابلية التشغيل البيني. تدعم شبكة الغاز (Gas Network) بيانات لأكثر من 35 سلسلة، بما في ذلك شبكة إيثريوم الرئيسية والعديد من شبكات الطبقة الثانية (L2s) الرائدة.

## قراءة إضافية{#further-reading}

**مقالات**

- [ما هو أوراكل سلسلة الكتل؟](https://chain.link/education/blockchain-oracles) — _Chainlink_
- [ما هو أوراكل سلسلة الكتل؟](https://medium.com/better-programming/what-is-a-blockchain-oracle-f5ccab8dbd72) — _Patrick Collins_
- [الأوراكل اللامركزية: نظرة عامة شاملة](https://medium.com/fabric-ventures/decentralised-oracles-a-comprehensive-overview-d3168b9a8841) — _Julien Thevenard_
- [تنفيذ أوراكل سلسلة الكتل على إيثريوم](https://medium.com/@pedrodc/implementing-a-blockchain-oracle-on-ethereum-cedc7e26b49e) – _Pedro Costa_
- [لماذا لا تستطيع العقود الذكية إجراء استدعاءات لواجهة برمجة التطبيقات؟](https://ethereum.stackexchange.com/questions/301/why-cant-contracts-make-api-calls) — _StackExchange_
- [إذًا أنت تريد استخدام أوراكل الأسعار](https://samczsun.com/so-you-want-to-use-a-price-oracle/) — _samczsun_

**مقاطع الفيديو**

- [الأوراكل وتوسيع فائدة سلسلة الكتل](https://youtu.be/BVUZpWa8vpw) — _Real Vision Finance_

**الدروس التعليمية**

- [كيفية جلب السعر الحالي لإيثريوم في Solidity](https://blog.chain.link/fetch-current-crypto-price-data-solidity/) — _Chainlink_
- [استهلاك بيانات أوراكل](https://docs.chroniclelabs.org/Developers/tutorials/Remix) — _Chronicle_

\*\*
مثال للمشاريع\*\*

- [مشروع Chainlink كامل للمبتدئين لإيثريوم في Solidity](https://github.com/hackbg/chainlink-fullstack) — _HackBG_
