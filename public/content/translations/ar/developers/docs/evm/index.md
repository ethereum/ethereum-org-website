---
title: آلة Ethereum الافتراضية (EVM)
description: مقدمة عن آلة Ethereum الافتراضية وعلاقتها بالحالة والمعاملات والعقود الذكية.
lang: ar
---

الآلة الافتراضية لإيثريوم (EVM) هي بيئة افتراضية لا مركزية تنفذ التعليمات البرمجية بشكل متسق وآمن عبر جميع عقد إيثريوم تشغّل العُقَد آلة إيثريوم الافتراضية (EVM) لتنفيذ العقود الذكية، باستخدام "[الغاز](/developers/docs/gas/)" لقياس الجهد الحسابي المطلوب لـ [العمليات](/developers/docs/evm/opcodes/)، مما يضمن تخصيص الموارد بكفاءة وأمان الشبكة.

## المتطلبات الأساسية {#prerequisites}

بعض الإلمام الأساسي بالمصطلحات الشائعة في علوم الكمبيوتر مثل [بايت](https://wikipedia.org/wiki/Byte) و[الذاكرة](https://wikipedia.org/wiki/Computer_memory) و[مكدس](https://wikipedia.org/wiki/Stack_\(abstract_data_type\)) ضروري لفهم آلة إيثريوم الافتراضية (EVM). سيكون من المفيد أيضًا أن تكون على دراية بمفاهيم التشفير/البلوكتشين مثل [دوال التجزئة](https://wikipedia.org/wiki/Cryptographic_hash_function) و[شجرة ميركل](https://wikipedia.org/wiki/Merkle_tree).

## من السجل إلى آلة الحالة {#from-ledger-to-state-machine}

غالبًا ما يُستخدم التشبيه بـ "سجل الحسابات الموزع" لوصف سلاسل الكتل مثل بيتكوين، التي تتيح وجود عملة لامركزية باستخدام أدوات التشفير الأساسية. يحتفظ دفتر الأستاذ بسجل للنشاط الذي يجب أن يلتزم بمجموعة من القواعد التي تحكم ما يمكن أو لا يستطيع الشخص فعله لتعديل دفتر الأستاذ. على سبيل المثال، لا يمكن لأي عنوان بيتكوين أن ينفق كمية بيتكوين تفوق الكمية التي سبق أن تلّقاها. وتنطبق هذه القواعد على جميع المعاملات على بيتكوين والعديد من سلاسل الكتل الأخرى.

بينما تمتلك إيثريوم عملتها الرقمية الأصلية (الإيثر) التي تتبع نفس القواعد البديهية تمامًا تقريبًا، إلا أنها تتيح أيضًا وظيفة أكثر قوة بكثير: [العقود الذكية](/developers/docs/smart-contracts/). من أجل تفسير هذه الميزة التي تعتبر أكثر تعقيدًا، لا بد من اللجوء إلى تشبيه أكثر تنميقًا. بدلاً من السجل الموزع، إيثريوم هي [آلة حالة](https://wikipedia.org/wiki/Finite-state_machine) موزعة. حالة إيثريوم هي هيكلية بيانات ضخمة لا تحتوي فقط على جميع الحسابات والأرصدة، بل تحتوي أيضًا على _حالة آلة_، والتي يمكن أن تتغير من كتلة إلى أخرى وفقًا لمجموعة محددة مسبقًا من القواعد، ويمكنها تنفيذ أي كود آلة. وآلة Ethereum الافتراضية هي التي تضع القواعد المحددة لتغيير الحالة من كتلة إلى كتلة.

![رسم بياني يوضح تكوين آلة إيثريوم الافتراضية (EVM)](./evm.png)
_رسم بياني مقتبس من [Ethereum EVM illustrated](https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf)_

## دالة انتقال حالة إيثريوم {#the-ethereum-state-transition-function}

تتصرف آلة Ethereum الافتراضية كوظيفة رياضية، أي أنها تُعطى مُدخلًا فتعطي ناتجًا حتميًا. لذلك، من المفيد جدًا وصف إيثريوم بشكل أكثر رسمية بأنها تمتلك **دالة انتقال الحالة**:

```
Y(S, T)= S'
```

بوجود حالة قديمة صالحة `(S)` ومجموعة جديدة من المعاملات الصالحة `(T)`، فإن دالة انتقال الحالة لإيثريوم `Y(S, T)` تُنتج حالة إخراج جديدة صالحة `S'`

### الحالة {#state}

في سياق إيثريوم، الحالة هي هيكلية بيانات ضخمة تسمى نسخة معدلة من شجرة ميركل باتريشيا الرقمية، وهي تبقي كل [الحسابات](/developers/docs/accounts/) متصلة بتجزئات (هاش) ويمكن تقليصها إلى تجزئة (هاش) جذرية واحدة مخزنة على البلوكتشين.

### المعاملات {#transactions}

المعاملات هي تعليمات من الحسابات موقعة بشكل مشفّر. والمعاملات على نوعين: المعاملات التي تؤدي إلى توجيه رسائل والمعاملات التي تؤدي إلى إنشاء عقود.

يؤدي إنشاء العقد إلى إنشاء حساب عقد جديد يحتوي على بايت كود [العقد الذكي](/developers/docs/smart-contracts/anatomy/) المترجم. وكلما وجّه حساب آخر رسالة إلى ذلك العقد، يقوم بتنفيذ البايت كود الخاص به.

## تعليمات آلة إيثريوم الافتراضية (EVM) {#evm-instructions}

تعمل آلة إيثريوم الافتراضية (EVM) كـ[آلة مكدس](https://wikipedia.org/wiki/Stack_machine) بعمق 1024 عنصرًا. كل عنصر عبارة عن كلمة مكونة من 256 بت، تم اختيارها لسهولة الاستخدام مع تشفير 256 بت (مثل تجزئة Keccak-256 أو توقيعات secp256k1).

أثناء التنفيذ، تحافظ آلة إيثريوم الافتراضية (EVM) على _ذاكرة_ مؤقتة (كمصفوفة بايت معنونة بالكلمات)، والتي لا تستمر بين المعاملات.

### التخزين المؤقت

التخزين المؤقت هو مخزن مفتاح-قيمة لكل معاملة يتم الوصول إليه عبر أكواد التشغيل `TSTORE` و`TLOAD`. يستمر عبر جميع الاستدعاءات الداخلية أثناء نفس المعاملة ولكن يتم مسحه في نهاية المعاملة. بخلاف الذاكرة، يتم تصميم التخزين المؤقت كجزء من حالة آلة إيثريوم الافتراضية (EVM) بدلاً من إطار التنفيذ، ومع ذلك، لا يتم تسجيله في الحالة العامة. يمكّن التخزين المؤقت المشاركة المؤقتة للحالة بكفاءة من حيث الغاز عبر الاستدعاءات الداخلية أثناء المعاملة.

### التخزين

تحتوي العقود على شجرة _تخزين_ رقمية من نوع ميركل باتريشيا (كمصفوفة كلمات قابلة للعنونة بالكلمات)، مرتبطة بالحساب المعني وجزء من الحالة العامة. يختلف هذا التخزين الدائم عن التخزين المؤقت، والذي يكون متاحًا فقط طوال مدة معاملة واحدة ولا يشكل جزءًا من شجرة التخزين الدائمة للحساب.

### رموز التشغيل

يُنفذ بايت كود العقد الذكي المترجم كمجموعة من [أكواد التشغيل](/developers/docs/evm/opcodes) الخاصة بآلة إيثريوم الافتراضية (EVM)، والتي تؤدي عمليات المكدس القياسية مثل `XOR` و`AND` و`ADD` و`SUB` وما إلى ذلك. تنفذ آلة إيثريوم الافتراضية (EVM) أيضًا عددًا من عمليات المكدس الخاصة بالبلوكتشين، مثل `ADDRESS` و`BALANCE` و`BLOCKHASH` وغيرها. تتضمن مجموعة أكواد التشغيل أيضًا `TSTORE` و`TLOAD`، والتي توفر الوصول إلى التخزين المؤقت.

![رسم بياني يوضح أين يلزم الغاز لعمليات آلة إيثريوم الافتراضية (EVM)](../gas/gas.png)
_رسوم بيانية مقتبسة من [Ethereum EVM illustrated](https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf)_

## تطبيقات آلة إيثريوم الافتراضية (EVM) {#evm-implementations}

يجب أن تتقيد كل عمليات التنفيذ في آلة Ethereum الافتراضية بالمواصفات المبينة في ورقة Ethereum الصفراء.

على مدى تاريخ إيثريوم الممتد لعشر سنوات، خضعت آلة إيثريوم الافتراضية (EVM) للعديد من المراجعات، وهناك العديد من تطبيقات آلة إيثريوم الافتراضية (EVM) بلغات برمجة مختلفة.

[عملاء تنفيذ إيثريوم](/developers/docs/nodes-and-clients/#execution-clients) تتضمن تطبيقًا لآلة إيثريوم الافتراضية (EVM). بالإضافة إلى ذلك، هناك العديد من التطبيقات المستقلة، بما في ذلك:

- [Py-EVM](https://github.com/ethereum/py-evm) - _بايثون_
- [evmone](https://github.com/ethereum/evmone) - _C++_
- [ethereumjs-vm](https://github.com/ethereumjs/ethereumjs-vm) - _جافا سكريبت_
- [revm](https://github.com/bluealloy/revm) - _راست_

## قراءة إضافية {#further-reading}

- [الورقة الصفراء لإيثريوم](https://ethereum.github.io/yellowpaper/paper.pdf)
- [Jellopaper المعروف أيضًا بـ KEVM: دلالات آلة إيثريوم الافتراضية (EVM) في K](https://jellopaper.org/)
- [الورقة البيج](https://github.com/chronaeon/beigepaper)
- [أكواد تشغيل آلة إيثريوم الافتراضية](https://www.ethervm.io/)
- [مرجع تفاعلي لأكواد تشغيل آلة إيثريوم الافتراضية](https://www.evm.codes/)
- [مقدمة قصيرة في توثيق Solidity](https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html#index-6)
- [إتقان إيثريوم - آلة إيثريوم الافتراضية](https://github.com/ethereumbook/ethereumbook/blob/openedition/13evm.asciidoc)

## مواضيع ذات صلة {#related-topics}

- [الغاز](/developers/docs/gas/)
