---
title: "استراتيجيات تخزين بيانات البلوكشين"
description: "هناك عدة طرق لتخزين البيانات باستخدام blockchain. ستقوم هذه المقالة بمقارنة الاستراتيجيات المختلفة وتكاليفها ومقايضاتها، بالإضافة إلى المتطلبات اللازمة لاستخدامها بأمان."
lang: ar
---

هناك طرق متعددة لتخزين المعلومات إما مباشرة على blockchain، أو بطريقة مؤمنة بواسطة blockchain:

- كتل EIP-4844
- Calldata
- خارج السلسلة مع آليات L1
- العقد "كود"
- الأحداث
- تخزين EVM

يعتمد اختيار الطريقة التي يجب استخدامها على عدة معايير:

- مصدر المعلومة. لا يمكن للمعلومات الموجودة في بيانات الاتصال أن تأتي مباشرة من blockchain نفسها.
- وجهة المعلومات. تتوفر بيانات المكالمة فقط في المعاملة التي تتضمنها. الأحداث ليست قابلة للوصول على السلسلة على الإطلاق.
- ما هو مقدار المتاعب المقبولة؟ يمكن لأجهزة الكمبيوتر التي تعمل على تشغيل عقدة كاملة النطاق تنفيذ معالجة أكبر من العميل الخفيف في تطبيق يعمل في متصفح.
- هل من الضروري تسهيل الوصول إلى المعلومات من كل عقدة؟
- المتطلبات الأمنية.

## متطلبات الأمان {#security-requirements}

بشكل عام، يتكون أمن المعلومات من ثلاث سمات:

- _السرية_، لا يُسمح للأشخاص غير المصرح لهم بقراءة المعلومات. وهذا مهم في كثير من الحالات، ولكن ليس هنا. _There are no secrets on the blockchain_. تعمل تقنية البلوكشين لأن أي شخص يمكنه التحقق من انتقالات الحالة، لذا فمن المستحيل استخدامها لتخزين الأسرار بشكل مباشر. هناك طرق لتخزين المعلومات السرية على blockchain، لكنها تعتمد جميعها على بعض مكونات خارج السلسلة لتخزين مفتاح واحد على الأقل.

- _النزاهة_، المعلومات صحيحة، ولا يمكن تغييرها بواسطة كيانات غير مصرح لها، أو بطرق غير مصرح بها (على سبيل المثال، نقل [رموز ERC-20](https://eips.ethereum.org/EIPS/eip-20#events) بدون حدث "نقل"). على blockchain، تقوم كل عقدة بالتحقق من كل تغيير في الحالة، مما يضمن السلامة.

- _التوفر_، المعلومات متاحة لأي جهة معتمدة. على blockchain، يتم تحقيق ذلك عادةً من خلال توفير المعلومات على كل [عقدة كاملة](https://ethereum.org/developers/docs/nodes-and-clients#full-node).

تتمتع جميع الحلول المختلفة هنا بسلامة ممتازة، لأن التجزئات يتم نشرها على L1. ومع ذلك، فإن لديهم ضمانات توافر مختلفة.

## المتطلبات الأساسية {#prerequisites}

يجب أن يكون لديك فهم جيد لـ [أساسيات blockchain](/developers/docs/intro-to-ethereum/). تفترض هذه الصفحة أيضًا أن القارئ على دراية بـ [الكتل](/developers/docs/blocks/)، و[المعاملات](/developers/docs/transactions/)، والموضوعات الأخرى ذات الصلة.

## EIP-4844 النقط {#eip-4844-blobs}

بدءًا من [شوكة Dencun الصلبة](https://github.com/ethereum/consensus-specs/blob/dev/specs/deneb/beacon-chain.md)، تتضمن سلسلة كتل الإيثيريوم [EIP-4844](https://eips.ethereum.org/EIPS/eip-4844)، والتي تُضاف إلى كتل بيانات الإيثيريوم ذات عمر محدود (في البداية حوالي [18 يومًا](https://github.com/ethereum/consensus-specs/blob/dev/specs/deneb/p2p-interface.md#configuration)).
يتم تسعير هذه الكتل بشكل منفصل عن [غاز التنفيذ](/developers/docs/gas)، على الرغم من استخدام آلية مماثلة. إنها طريقة رخيصة لنشر البيانات المؤقتة.

حالة الاستخدام الرئيسية لكتل ​​EIP-4844 هي أن تقوم التجميعات بنشر معاملاتها. تحتاج [التراكمات المتفائلة](/developers/docs/scaling/optimistic-rollups) إلى نشر المعاملات على سلاسل الكتل الخاصة بها. يجب أن تكون هذه المعاملات متاحة لأي شخص خلال [فترة التحدي](https://docs.optimism.io/connect/resources/glossary#challenge-period) لتمكين [المحققين](https://docs.optimism.io/connect/resources/glossary#validator) من إصلاح الخطأ إذا قام [sequencer](https://docs.optimism.io/connect/resources/glossary#sequencer) الخاص بالتجميع بنشر جذر حالة غير صحيح.

ومع ذلك، بمجرد مرور فترة التحدي واستكمال جذر الحالة، فإن الغرض المتبقي لمعرفة هذه المعاملات هو تكرار الحالة الحالية للسلسلة. تتوفر هذه الحالة أيضًا من عقد السلسلة، مع الحاجة إلى قدر أقل كثيرًا من المعالجة. لذا يجب أن تظل معلومات المعاملات محفوظة في عدد قليل من الأماكن، مثل [مستكشفات الكتل](/developers/docs/data-and-analytics/block-explorers)، ولكن ليست هناك حاجة إلى الدفع مقابل مستوى مقاومة الرقابة الذي توفره Ethereum.

تنشر [عمليات التجميع بدون معرفة](/developers/docs/scaling/zk-rollups/#data-availability) أيضًا بيانات المعاملات الخاصة بها لتمكين العقد الأخرى من تكرار الحالة الحالية والتحقق من أدلة الصلاحية، ولكن مرة أخرى يعد هذا متطلبًا قصير المدى.

عند كتابة النشر على EIP-4844 يكلف واحدًا وي (10-18 ETH) لكل بايت، وهو أمر لا يذكر مقارنة بـ [21000 غاز تنفيذ تكلفها أي معاملة، بما في ذلك تلك التي تنشر الكتل](https://eth.blockscout.com/tx/0xf6cfaf0431c73dd1d96369a5e6707d64f463ccf477a4131265397f1d81466929?tab=index). يمكنك رؤية سعر EIP-4844 الحالي على [blobscan.com](https://blobscan.com/blocks).

فيما يلي العناوين لرؤية الكتل التي نشرتها بعض اللفافات الشهيرة.

| تجميع المعاملات خارج البلوكشين داخل عقد إيثريوم ذكي | عنوان صندوق البريد                                                                                                              |
| --------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| [التفاؤل](https://www.optimism.io/)                 | [`0xFF000000000000000000000000000000000000010`](https://blobscan.com/address/0xFF00000000000000000000000000000000000000010)     |
| [التحكيم](https://arbitrum.io/)                     | [`0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6`](https://blobscan.com/address/0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6)         |
| [القاعدة](https://base.org/)                        | [`0xFF0000000000000000000000000000000000008453`](https://blobscan.com/address/0xFF00000000000000000000000000000000000000008453) |

## بيانات الاتصال {#calldata}

تشير بيانات الاتصال إلى البايتات المرسلة كجزء من المعاملة. يتم تخزينه كجزء من السجل الدائم لسلسلة الكتل في الكتلة التي تتضمن تلك المعاملة.

هذه هي الطريقة الأرخص لوضع البيانات بشكل دائم في blockchain. تكون التكلفة لكل بايت إما 4 غاز تنفيذ (إذا كان البايت صفرًا) أو 16 غازًا (أي قيمة أخرى). إذا تم ضغط البيانات، وهي الممارسة القياسية، فإن قيمة كل بايت تكون متساوية على الأرجح، وبالتالي فإن التكلفة المتوسطة تبلغ حوالي 15.95 غاز لكل بايت.

في وقت كتابة هذا التقرير، كانت الأسعار 12 جيجا بايت/غاز و2300 دولار/إيثريوم، مما يعني أن التكلفة تبلغ حوالي 45 سنتًا لكل كيلوبايت. نظرًا لأن هذه كانت الطريقة الأرخص قبل EIP-4844، فهذه هي طريقة التجميع المستخدمة لتخزين معلومات المعاملات، والتي يجب أن تكون متاحة لتحديات الأخطاء (https://docs.optimism.io/stack/protocol/overview#fault-proofs)، ولكن لا يلزم أن تكون قابلة للوصول إليها مباشرة على السلسلة.

فيما يلي العناوين لرؤية المعاملات التي نشرتها بعض المجموعات الشهيرة.

| تجميع المعاملات خارج البلوكشين داخل عقد إيثريوم ذكي | عنوان صندوق البريد                                                                                                                    |
| --------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |
| [التفاؤل](https://www.optimism.io/)                 | [`0xFF000000000000000000000000000000000000010`](https://eth.blockscout.com/address/0xFF000000000000000000000000000000000000000010)    |
| [التحكيم](https://arbitrum.io/)                     | [`0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6`](https://eth.blockscout.com/address/0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6)         |
| [القاعدة](https://base.org/)                        | [`0xFF0000000000000000000000000000000000008453`](https://eth.blockscout.com/address/0xFF00000000000000000000000000000000000000008453) |

## خارج السلسلة مع آليات L1 {#offchain-with-l1-mechs}

اعتمادًا على التنازلات الأمنية التي تواجهها، قد يكون من المقبول وضع المعلومات في مكان آخر واستخدام آلية تضمن توفر البيانات عند الحاجة إليها. هناك متطلبان لكي يعمل هذا:

1. قم بنشر [تجزئة](https://en.wikipedia.org/wiki/Cryptographic_hash_function) للبيانات على blockchain، والتي تسمى _التزام الإدخال_. يمكن أن تكون هذه كلمة واحدة مكونة من 32 بايتًا، لذا فهي ليست مكلفة. طالما أن التزام الإدخال متاح، يتم ضمان السلامة لأنه من غير الممكن العثور على أي بيانات أخرى يمكن تجزئتها إلى نفس القيمة. لذا، إذا تم تقديم بيانات غير صحيحة، فمن الممكن اكتشافها.

2. يجب أن يكون لديك آلية تضمن التوفر. على سبيل المثال، في [Redstone](https://redstone.xyz/docs/what-is-redstone) يمكن لأي عقدة إرسال تحدي التوفر. إذا لم يستجب التسلسل على السلسلة بحلول الموعد النهائي، فسيتم تجاهل التزام الإدخال، وبالتالي يُعتبر أن المعلومات لم يتم نشرها أبدًا.

يعد هذا مقبولًا بالنسبة للتجميع المتفائل لأننا نعتمد بالفعل على وجود محقق صادق واحد على الأقل لجذر الحالة. كما سيتأكد هذا المُتحقق الصادق من أنه يمتلك البيانات اللازمة لمعالجة الكتل، وإصدار تحدي التوفر إذا لم تكن المعلومات متاحة خارج السلسلة. يُطلق على هذا النوع من التجميع المتفائل اسم [plasma](/developers/docs/scaling/plasma/).

## رمز العقد {#contract-code}

يمكن تخزين المعلومات التي تحتاج فقط إلى الكتابة مرة واحدة، ولا يتم الكتابة فوقها مطلقًا، والتي يجب أن تكون متاحة على السلسلة، ككود عقد. وهذا يعني أننا نقوم بإنشاء "عقد ذكي" مع البيانات ثم نستخدم [`EXTCODECOPY`](https://www.evm.codes/#3c?fork=shanghai) لقراءة المعلومات. الميزة هي أن نسخ الكود رخيص نسبيًا.

بخلاف تكلفة توسيع الذاكرة، تكلف `EXTCODECOPY` 2600 غاز للوصول الأول إلى العقد (عندما يكون "باردًا") و100 غاز للنسخ اللاحقة من نفس العقد بالإضافة إلى 3 غاز لكل كلمة مكونة من 32 بايت. وبالمقارنة مع calldata، التي تكلف 15.95 دولارًا لكل بايت، فإن هذا أرخص بدءًا من حوالي 200 بايت. استنادًا إلى [صيغة تكاليف توسيع الذاكرة](https://www.evm.codes/about#memoryexpansion)، طالما أنك لا تحتاج إلى أكثر من 4 ميجا بايت من الذاكرة، فإن تكلفة توسيع الذاكرة أصغر من تكلفة إضافة بيانات الاستدعاء.

بالطبع، هذه مجرد تكلفة قراءة البيانات. تبلغ تكلفة إنشاء العقد حوالي 32000 غاز + 200 غاز/بايت. تعتبر هذه الطريقة اقتصادية فقط عندما تكون هناك حاجة لقراءة نفس المعلومات عدة مرات في معاملات مختلفة.

يمكن أن يكون كود العقد غير منطقي، طالما أنه لا يبدأ بـ `0xEF`. يتم تفسير العقود التي تبدأ بـ `0xEF` على أنها [تنسيق كائن الإيثريوم](https://notes.ethereum.org/@ipsilon/evm-object-format-overview)، والذي يحتوي على متطلبات أكثر صرامة.

## الأحداث{#events}

يتم إصدار [الأحداث](https://docs.alchemy.com/docs/solidity-events) بواسطة العقود الذكية، ويتم قراءتها بواسطة برنامج خارج السلسلة.
ميزتها هي أن الكود خارج السلسلة يمكنه الاستماع للأحداث. التكلفة هي [غاز](https://www.evm.codes/#a0?fork=cancun)، 375 بالإضافة إلى 8 غاز لكل بايت من البيانات. بسعر 12 جيجاوي/غاز و2300 دولار/إيثريوم، يُترجم هذا إلى سنت واحد بالإضافة إلى 22 سنتًا لكل كيلوبايت.

## التخزين {#storage}

تتمتع العقود الذكية بالقدرة على الوصول إلى [التخزين المستمر](https://docs.alchemy.com/docs/smart-contract-storage-layout#what-is-storage-memory). ومع ذلك، فهو مكلف للغاية. إن كتابة كلمة مكونة من 32 بايت في فتحة تخزين فارغة مسبقًا قد يكلف 22100 غازًا (https://www.evm.codes/#55?fork=cancun). بسعر 12 جيجاوي/غاز و2300 دولار/إيثريوم، يعادل هذا حوالي 61 سنتًا لكل عملية كتابة، أو 19.5 دولارًا لكل كيلوبايت.

هذا هو الشكل الأكثر تكلفة للتخزين في Ethereum.

## ملخص {#summary}

يوضح هذا الجدول الخيارات المختلفة ومزاياها وعيوبها.

| نوع التخزين              | مصدر البيانات               | ضمان التوفر                                                                                                                                      | توافر Onchain                                   | قيود إضافية                                              |
| ------------------------ | --------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------- | -------------------------------------------------------- |
| كتل EIP-4844             | خارج السلسلة                | ضمان الإيثريوم لمدة [~18 يومًا](https://github.com/ethereum/consensus-specs/blob/dev/specs/deneb/p2p-interface.md#configuration) | التجزئة فقط متاحة                               |                                                          |
| Calldata                 | خارج السلسلة                | ضمان الإيثريوم إلى الأبد (جزء من blockchain)                                                                                  | متاح فقط إذا تم كتابته في عقد، وفي تلك المعاملة |                                                          |
| خارج السلسلة مع آليات L1 | خارج السلسلة                | ضمان "محقق واحد صادق" خلال فترة التحدي                                                                                                           | التجزئة فقط                                     | مضمونة بآلية التحدي فقط خلال فترة التحدي                 |
| رمز العقد                | على السلسلة أو خارج السلسلة | ضمان الإيثريوم إلى الأبد (جزء من blockchain)                                                                                  | نعم                                             | تمت كتابته إلى عنوان "عشوائي"، لا يمكن أن يبدأ بـ `0xEF` |
| الأحداث                  | Onchain                     | ضمان الإيثريوم إلى الأبد (جزء من blockchain)                                                                                  | لا                                              |                                                          |
| التخزين                  | Onchain                     | ضمان الإيثريوم إلى الأبد (جزء من blockchain والحالة الحالية حتى يتم الكتابة فوقه)                                             | نعم                                             |                                                          |
