---
title: نهائية فتحة واحدة
description: شرح نهائية الفتحة الواحدة
lang: ar
---

# نهائية الخانة الواحدة {#single-slot-finality}

يستغرق الأمر حوالي 15 دقيقة حتى يتم الانتهاء من كتلة Ethereum. ومع ذلك، يمكننا أن نجعل آلية الإجماع الخاصة بـ Ethereum تتحقق من صحة الكتل بشكل أكثر كفاءة وتقليل الوقت حتى النهاية بشكل كبير. بدلاً من الانتظار لمدة خمسة عشر دقيقة، يمكن اقتراح الكتل ووضع اللمسات النهائية عليها في نفس الفترة. يُعرف هذا المفهوم باسم **نهائية الخانة الواحدة (SSF)**.

## ما هي الـالنهائية؟ {#what-is-finality}

في آلية الإجماع القائمة على إثبات الحصة في Ethereum، تشير النهائية إلى ضمان عدم إمكانية تغيير الكتلة أو إزالتها من blockchain دون حرق ما لا يقل عن 33٪ من إجمالي ETH المتراكم. هذا هو الأمن "الاقتصادي المشفر" لأن الثقة تأتي من التكلفة العالية للغاية المرتبطة بتغيير ترتيب أو محتوى السلسلة والتي من شأنها أن تمنع أي جهة اقتصادية عقلانية من تجربتها.

## لماذا تهدف إلى نهائية أسرع؟ {#why-aim-for-quicker-finality}

تبين أن الوقت الحالي للوصول إلى النهاية طويل جدًا. لا يرغب معظم المستخدمين في الانتظار لمدة 15 دقيقة للحصول على النتيجة النهائية، ومن غير الملائم بالنسبة للتطبيقات والبورصات التي قد ترغب في إنتاجية عالية للمعاملات أن تضطر إلى الانتظار كل هذا الوقت للتأكد من أن معاملاتها دائمة. إن وجود تأخير بين اقتراح الكتلة والانتهاء منه يخلق أيضًا فرصة لعمليات إعادة التنظيم القصيرة التي يمكن للمهاجم استخدامها لفرض رقابة على كتل معينة أو استخراج MEV. إن الآلية التي تتعامل مع ترقية الكتل على مراحل هي أيضًا معقدة للغاية وقد تم تصحيحها عدة مرات لإغلاق الثغرات الأمنية، مما يجعلها واحدة من أجزاء قاعدة بيانات إيثريوم حيث من المرجح أن تظهر أخطاء خفية. يمكن التخلص من هذه المشكلات جميعًا عن طريق تقليل الوقت اللازم للوصول إلى النهاية في فتحة واحدة.

## المقايضة بين اللامركزية / الوقت / التكلفة العامة {#the-decentralization-time-overhead-tradeoff}

إن ضمان النهاية ليس ملكية فورية للكتلة الجديدة؛ يستغرق الأمر وقتًا حتى يتم الانتهاء من الكتلة الجديدة. والسبب في ذلك هو أن المدققين الذين يمثلون ما لا يقل عن 2/3 من إجمالي ETH المتراكم على الشبكة يجب عليهم التصويت لصالح الكتلة ("الشهادة") حتى يتم اعتبارها نهائية. يتعين على كل عقدة تحقق على الشبكة معالجة الشهادات من العقد الأخرى لمعرفة ما إذا كانت الكتلة قد حققت أو لم تحقق عتبة 2/3.

كلما قصر الوقت المسموح به للوصول إلى الصيغة النهائية، زادت الحاجة إلى طاقة حوسبة أكبر في كل عقدة لأن معالجة التصديق يجب أن تتم بشكل أسرع. وأيضًا، كلما زاد عدد عقد التحقق الموجودة على الشبكة، زاد عدد الشهادات التي يجب معالجتها لكل كتلة، مما يزيد أيضًا من قوة المعالجة المطلوبة. كلما زادت قوة المعالجة المطلوبة، قل عدد الأشخاص الذين يمكنهم المشاركة لأن هناك حاجة إلى أجهزة أكثر تكلفة لتشغيل كل عقدة تحقق. تؤدي زيادة الوقت بين الكتل إلى تقليل قوة الحوسبة المطلوبة في كل عقدة، ولكنها أيضًا تطيل الوقت اللازم للوصول إلى النهاية، لأن الشهادات تتم معالجتها بشكل أبطأ.

ولذلك، هناك مفاضلة بين النفقات العامة (قوة الحوسبة)، واللامركزية (عدد العقد التي يمكن أن تشارك في التحقق من صحة السلسلة) والوقت حتى النهاية. يوازن النظام المثالي بين الحد الأدنى من قوة الحوسبة والحد الأقصى من اللامركزية والحد الأدنى من الوقت حتى النهاية.

تعمل آلية الإجماع الحالية لـ Ethereum على موازنة هذه المعلمات الثلاثة من خلال:

- **تحديد الحد الأدنى للرهان على 32 ETH**. يؤدي هذا إلى تعيين حد أعلى لعدد شهادات المدققين التي يجب معالجتها بواسطة العقد الفردية، وبالتالي حدًا أعلى للمتطلبات الحسابية لكل عقدة.
- **ضبط الوقت حتى النهائية عند ~15 دقيقة**. وهذا يمنح وقتًا كافيًا لتشغيل المدققين على أجهزة الكمبيوتر المنزلية العادية لمعالجة الشهادات لكل كتلة بأمان.

مع تصميم الآلية الحالية، من أجل تقليل الوقت اللازم للانتهاء، من الضروري تقليل عدد أدوات التحقق من الصحة على الشبكة أو زيادة متطلبات الأجهزة لكل عقدة. ستسمح المعالجة الأكثر كفاءة بتحديد النتيجة النهائية ضمن فتحة واحدة، وليس عبر حقبتين. ستسمح المعالجة الأكثر كفاءة بتحديد النتيجة النهائية ضمن فتحة واحدة، وليس عبر حقبتين.

## مسارات إلى SSF {#routes-to-ssf}

<ExpandableCard title= "Why can't we have SSF today?" eventCategory="/roadmap/single-slot-finality" eventName="clicked Why can't we hear SSF today?">

تجمع آلية الإجماع الحالية بين شهادات من عدة مدققين، والمعروفين باسم اللجان، لتقليل عدد الرسائل التي يجب على كل مدقق معالجتها للتحقق من صحة الكتلة. يتمتع كل مدقق بفرصة التصديق في كل فترة (32 فتحة) ولكن في كل فترة، تشهد فقط مجموعة فرعية من المدققين، المعروفة باسم "اللجنة". يفعلون ذلك عن طريق التقسيم إلى شبكات فرعية يتم فيها اختيار عدد قليل من المدققين ليكونوا "مجمعين". يجمع كل من هؤلاء المجمعين جميع التوقيعات التي يرونها من المدققين الآخرين في شبكتهم الفرعية في توقيع مجمع واحد. يقوم المجمع الذي يتضمن أكبر عدد من المساهمات الفردية بتمرير توقيعه الإجمالي إلى مقدم الكتلة، والذي يقوم بتضمينه في الكتلة مع التوقيع الإجمالي من اللجان الأخرى.

توفر هذه العملية قدرة كافية لكل مدقق للتصويت في كل عصر، لأن "32 خانة \* 64 لجنة \* 256 مدققًا لكل لجنة = 524,288 مدققًا لكل عصر". في وقت كتابة هذا التقرير (فبراير 2023)، كان هناك ما يقرب من 513000 مدقق نشط.

في هذا المخطط، لا يمكن لكل مدقق التصويت على الكتلة إلا من خلال توزيع شهاداته عبر العصر بأكمله. ومع ذلك، هناك طرق محتملة لتحسين الآلية حتى يتسنى لكل مدقق فرصة التصديق في كل فتحة. </ExpandableCard>

منذ أن تم تصميم آلية إجماع الإيثريوم، وجد أن نظام تجميع التوقيع (BLS) أكثر قابلية للتطوير بكثير مما كان يعتقد في البداية، في حين تحسنت أيضًا قدرة العملاء على معالجة التوقيعات والتحقق منها. لقد اتضح أن معالجة الشهادات من عدد كبير من المدققين أمر ممكن بالفعل في فتحة واحدة. على سبيل المثال، مع وجود مليون مصادق لكل منهم يصوت مرتين في كل فتحة، وتم تعديل أوقات الفاصل الزمني لتكون 16 ثانية، سيُطلب من العقد التحقق من التوقيعات بمعدل لا يقل عن 125000 تجميع في الثانية من أجل معالجة جميع المليون شهادة داخل الفتحة في الواقع، يستغرق الكمبيوتر العادي حوالي 500 نانو ثانية للقيام بالتحقق من توقيع واحد، مما يعني أنه يمكن إجراء 125000 في حوالي 62.5 مللي ثانية - وهو أقل بكثير من عتبة الثانية الواحدة.

يمكن تحقيق المزيد من مكاسب الكفاءة من خلال إنشاء لجان عليا، على سبيل المثال، من 125,000 مدقق يتم اختيارهم عشوائيًا لكل خانة. يحق لهؤلاء المدققين فقط التصويت على الكتلة، وبالتالي فإن هذه المجموعة الفرعية من المدققين فقط هي التي تقرر ما إذا كانت الكتلة قد تم الانتهاء منها أم لا. سواء كانت هذه فكرة جيدة أم لا، فهذا يعتمد على مدى التكلفة التي يفضلها المجتمع للهجوم الناجح على إيثريوم. وهذا لأنه بدلًا من طلب 2/3 من إجمالي الإيثر المرهون، يمكن لمهاجم إنهاء كتلة غير نزيهة باستخدام 2/3 من الإيثر المرهون _في تلك اللجنة العليا_. لا يزال هذا مجال بحث نشط، ولكن يبدو من المعقول أنه بالنسبة لمجموعة مدققين كبيرة بما يكفي لتتطلب وجود لجان عليا في المقام الأول، فإن تكلفة مهاجمة إحدى تلك اللجان الفرعية ستكون باهظة للغاية (على سبيل المثال، ستكون تكلفة الهجوم المقومة بعملة ETH هي `2/3 * 125,000 * 32 = ~2.6 مليون ETH`). يمكن تعديل تكلفة الهجوم عن طريق زيادة حجم مجموعة المدققين (على سبيل المثال، ضبط حجم مجموعة المدققين بحيث تكون تكلفة الهجوم مساوية لمليون إيثر، أو 4 ملايين إيثر، أو 10 ملايين إيثر، إلخ). يبدو أن [استطلاعات الرأي الأولية](https://youtu.be/ojBgyFl6-v4?t=755) للمجتمع تشير إلى أن 1-2 مليون إيثر هي تكلفة مقبولة للهجوم، وهو ما يعني ضمنًا وجود ~65,536 - 97,152 مدققًا لكل لجنة عليا.

ومع ذلك، فإن التحقق ليس هو عنق الزجاجة الحقيقي - بل إن تجميع التوقيع هو الذي يتحدى حقًا عقد التحقق. من المحتمل أن يتطلب توسيع نطاق تجميع التوقيع زيادة عدد المدققين في كل شبكة فرعية، وزيادة عدد الشبكات الفرعية، أو إضافة طبقات إضافية من التجميع (أي تنفيذ لجان من اللجان). قد يتمثل جزء من الحل في السماح للمجمعين المتخصصين - على غرار كيفية الاستعانة بمصادر خارجية لبناء الكتل وتوليد الالتزامات للبيانات المجمعة لمنشئي الكتل المتخصصين بموجب الفصل بين المقترح والمنشئ (PBS) وDanksharding.

## ما هو دور قاعدة اختيار الشوكة في SSF؟ دور قاعدة اختيار الانقسام {#role-of-the-fork-choice-rule}

تعتمد آلية الإجماع اليوم على اقتران محكم بين الأداة النهائية (الخوارزمية التي تحدد ما إذا كان ثلثا المدققين قد شهدوا على سلسلة معينة) وقاعدة اختيار الشوكة (الخوارزمية التي تقرر أي سلسلة هي السلسلة الصحيحة عندما يكون هناك عدة خيارات). تأخذ خوارزمية اختيار الانقسام في الاعتبار الكتل _منذ_ آخر كتلة تم الانتهاء منها فقط. بموجب SSF، لن يكون هناك أي كتل لتأخذها قاعدة اختيار الشوكة في الاعتبار، لأن النهاية تحدث في نفس الفتحة التي تم اقتراح الكتلة فيها. وهذا يعني أنه في ظل SSF _إما_ أن تكون خوارزمية اختيار الانقسام _أو_ أداة النهائية نشطة في أي وقت. ستقوم الأداة النهائية بوضع اللمسات النهائية على الكتل حيث كان ثلثا المدققين متصلين بالإنترنت ويشهدون بأمانة. إذا لم تكن الكتلة قادرة على تجاوز عتبة 2/3، فسيتم تطبيق قاعدة اختيار الشوكة لتحديد السلسلة التي يجب اتباعها. يؤدي هذا أيضًا إلى إنشاء فرصة للحفاظ على آلية تسرب عدم النشاط التي تستعيد سلسلة حيث يكون أكثر من 1/3 من المدققين غير متصلين بالإنترنت، وإن كان ذلك مع بعض الفروق الدقيقة الإضافية.

## المسائل العالقة {#outstanding-issues}

تكمن مشكلة توسيع نطاق التجميع من خلال زيادة عدد أدوات التحقق من الصحة لكل شبكة فرعية في أنها تؤدي إلى زيادة التحميل على شبكة نظير إلى نظير. تكمن مشكلة إضافة طبقات التجميعات في أن هندستها معقدة للغاية وتضيف زمن الوصول (أي قد يستغرق الأمر وقتًا أطول حتى يسمع مقدم الكتلة من جميع مجمعات الشبكة الفرعية). ليس من الواضح أيضًا كيفية التعامل مع السيناريو المتمثل في وجود أدوات تحقق أكثر نشاطًا على الشبكة مما يمكن معالجته عمليًا في كل فتحة، حتى مع تجميع توقيع BLS. أحد الحلول المحتملة هو أنه نظرًا لأن جميع المدققين يشهدون في كل فتحة ولا توجد لجان تحت SSF، فيمكن إزالة الحد الأقصى البالغ 32 إيثريوم على الرصيد الفعال بالكامل، مما يعني أن المشغلين الذين يديرون عدة مدققين يمكنهم دمج حصتهم وتشغيل عدد أقل، مما يقلل العدد من الرسائل التي يجب على عقد التحقق من صحتها معالجتها لحساب مجموعة أدوات التحقق بأكملها. يعتمد هذا على موافقة كبار أصحاب المصلحة على توحيد جهات التحقق الخاصة بهم. من الممكن أيضًا فرض حد أقصى ثابت على عدد المدققين أو مبلغ ETH المتراكم في أي وقت. However, this requires some mechanism for deciding which validators are allowed to participate and which are not, which is liable to create unwanted secondary effects.

## التقدم الحالي {#current-progress}

SSF في مرحلة البحث. من غير المتوقع أن يتم إطلاقه لعدة سنوات، على الأرجح بعد ترقيات جوهرية أخرى مثل [أشجار Verkle](/roadmap/verkle-trees/) و[Danksharding](/roadmap/danksharding/).

## قراءة إضافية{#further-reading}

- [Vitalik يتحدث عن SSF في EDCON 2022](https://www.youtube.com/watch?v=nPgUKNPWXNI)
- [ملاحظات Vitalik: مسارات إلى نهائية الخانة الواحدة](https://notes.ethereum.org/@vbuterin/single_slot_finality)
