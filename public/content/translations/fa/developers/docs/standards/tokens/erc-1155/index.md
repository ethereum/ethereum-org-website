---
title: استاندارد چند توکنی ERC-1155
description:
lang: fa
---

## معرفی {#introduction}

یک رابط استاندارد برای قراردادهایی است که چندین نوع توکن را مدیریت می کنند. یک تک قرارداد هوشمند مستقر ممکن است شامل هر ترکیبی از توکن‌های تعویض پذیر، توکن‌های تعویض ناپذیر یا سایر پیکربندی‌ها (مانند توکن‌های نیمه تعویض پذیر) باشد.

**منظور از استاندارد چند توکنی چیست؟**

این ایده ساده است و به دنبال ایجاد یک رابط برنامه نویسی قرارداد هوشمند می‌باشد که می تواند هر تعداد توکن تعویض پذیر و تعویض ناپذیر را نشان دهد و کنترل کند. به این ترتیب، توکن ERC-1155 می تواند همان عملکردهای یک توکن [ERC-20](/developers/docs/standards/tokens/erc-20/) و [ERC-721](/developers/docs/standards/tokens/erc-721/) و حتی هر دو را به طور همزمان انجام دهد. این امر باعث بهبود عملکرد و کارآیی هر دو استاندارد ERC-20 و ERC-721 می‌شود و خطاهای واضح پیاده‌سازی را اصلاح می‌کند.

توکن ERC-1155 به طور کامل در [EIP-1155](https://eips.ethereum.org/EIPS/eip-1155) توضیح داده شده است.

## پیش نیاز ها {#prerequisites}

برای درک بهتر این صفحه، توصیه می کنیم ابتدا در مورد [استانداردهای توکن](/developers/docs/standards/tokens/)، [ERC-20](/developers/docs/standards/tokens/erc-20/) و [ERC-721](/developers/docs/standards/tokens/erc-721/) مطالعه کنید.

## توابع و ویژگی های ERC-1155: {#body}

- [انتقال دسته‌ای](#batch_transfers): چندین دارایی را در یک فراخوانی منتقل کنید.
- [تراز دسته ای](#batch_balance): موجودی چندین دارایی را در یک فراخوانی دریافت کنید.
- [تأیید دسته‌ای](#batch_approval): همه توکن ها را برای یک آدرس تأیید کنید.
- [قلاب‌ها](#receive_hook): قلاب توکن‌ها را دریافت کنید.
- [پشتیبانی NFT](#nft_support): اگر عرضه تنها ۱ باشد، با آن به عنوان NFT رفتار کنید.
- [قوانین انتقال ایمن](#safe_transfer_rule): مجموعه قوانین برای انتقال ایمن.

### انتقال دسته ای {#batch-transfers}

عملیات انتقال دسته ای بسیار شبیه به انتقال معمولی ERC-20 است. بیایید نگاهی به تابع `transferFrom` استاندارد ERC-20 بیاندازیم:

```solidity
// ERC-20
function transferFrom(address from, address to, uint256 value) external returns (bool);

// ERC-1155
function safeBatchTransferFrom(
    address _from,
    address _to,
    uint256[] calldata _ids,
    uint256[] calldata _values,
    bytes calldata _data
) external;
```

تنها تفاوت ERC-1155 در این است که مقادیر را به عنوان یک آرایه ارسال می کنیم و همچنین یک آرایه از id را نیز ارسال می کنیم. به عنوان مثال با توجه به `ids=[3, 6, 13]` و `values=[100, 200, 5]`، انتقال‌های حاصل به صورت زیر می باشد

1. 100 توکن با شناسه 3 را از `from_` به `to_` منتقل کنید.
2. 200 توکن با شناسه 6 را از `from_` به `to_` منتقل کنید.
3. 5 توکن با شناسه 13 را از `from_` به `to_` منتقل کنید.

در ERC-1155 تنها تابع `transferFrom` را داریم و تابع `transfer` نداریم. برای استفاده از آن مانند یک `انتقال` معمولی، کافی است آدرس from را به آدرسی که تابع را فراخوانی می‌کند، تنظیم کنید.

### موجودی دسته ای {#batch-balance}

فراخوانی مربوط به ERC-20 `balanceOf` نیز به همین ترتیب تابع شریک خود را با پشتیبانی دسته ای دارد. به عنوان یک یادآوری، این نسخه ERC-20 است:

```solidity
// ERC-20
function balanceOf(address owner) external view returns (uint256);

// ERC-1155
function balanceOfBatch(
    address[] calldata _owners,
    uint256[] calldata _ids
) external view returns (uint256[] memory);
```

حتی ساده‌تر از فراخوانی موجودی، می‌توانیم چندین موجودی را در یک فراخوانی بدست آوریم. آرایه از دارندگان حساب و به دنبال آن آرایه ای از شناسه های توکن را ارسال می کنیم.

به عنوان مثال، با توجه به `_ids=[3, 6, 13]` و `_owners=[0xbeef..., 0x1337..., 0x1111...]`، مقدار بازگشتی برابر خواهد شد با

```solidity
[
    balanceOf(0xbeef...),
    balanceOf(0x1337...),
    balanceOf(0x1111...)
]
```

### تایید دسته ای {#batch-approval}

```solidity
// ERC-1155
function setApprovalForAll(
    address _operator,
    bool _approved
) external;

function isApprovedForAll(
    address _owner,
    address _operator
) external view returns (bool);
```

تاییدیه ها کمی با ERC-20 تفاوت دارند. به جای تأیید مبالغ خاص، یک اپراتور را از طریق `setApprovalForAll` روی تایید یا تایید نشده تنظیم می کنیم.

خواندن وضعیت فعلی را می توان از طریق `isApprovedForAll` انجام داد. همان‌طور که مشاهده می‌کنید، این یک پاسخ صفر و یک است. شما نمی توانید تعیین کنید که چه تعداد توکن باید تایید شود یا حتی کدام کلاس توکن باید تایید شود.

این مقوله عمدا با در نظر گرفتن سادگی طراحی شده است. شما فقط می توانید همه چیز را برای یک آدرس تایید کنید.

### قلاب دریافت {#receive-hook}

```solidity
function onERC1155BatchReceived(
    address _operator,
    address _from,
    uint256[] calldata _ids,
    uint256[] calldata _values,
    bytes calldata _data
) external returns(bytes4);
```

با توجه به پشتیبانی [EIP-165](https://eips.ethereum.org/EIPS/eip-165)، پشتیبانی ERC-1155 تنها از قلاب‌های دریافت برای قرارداد هوشمند پشتیبانی می‌کند. تابع قلاب می بایست مقدار bytes4 از پیش تعریف شده جادویی را برگرداند که به صورت زیر داده می شود:

```solidity
bytes4(keccak256("onERC1155BatchReceived(address,address,uint256[],uint256[],bytes)"))
```

وقتی قرارداد دریافت‌کننده این مقدار را برمی‌گرداند، فرض بر این است که قرارداد انتقال را می‌پذیرد و می‌داند چگونه با توکن‌های ERC-1155 کار کند. عالی است، دیگر هیچ توکنی در یک قرارداد گیر نمی‌کند!

### پشتیبانی از NFT {#nft-support}

وقتی عرضه فقط یک باشد، توکن اساساً یک توکن تعویض ناپذیر (NFT) است. و همانطور که برای ERC-721 استاندارد است، می‌توانید یک URL اَبَرداده ای را تعریف کنید. URL را می توان توسط کلاینت ها خواند و تغییر داد، [اینجا](https://eips.ethereum.org/EIPS/eip-1155#metadata) را ببینید.

### قانون انتقال ایمن {#safe-transfer-rule}

ما قبلاً در توضیحات قبلی به چند قانون انتقال ایمن اشاره کردیم. اما بیایید مهم ترین قوانین را بررسی کنیم:

1. تماس‌گیرنده می بایست برای خرج کردن توکن ها برای آدرس `from_` تأیید شود یا تماس‌گیرنده باید برابر با `from_` باشد.
2. فراخوانی انتقال باید برگردانده شود اگر
   1. آدرس `to_` باشد.
   2. طول `_ids` با طول `_values` یکسان نباشد.
   3. هر یک از موجودی(های) دارنده(های) توکن(ها) در `_ids` کمتر از مقدار(های) مربوطه در `_values` ارسال شده به گیرنده باشد.
   4. هر خطای دیگری رخ دهد.

_توجه_: همه توابع دسته‌ای از جمله قلاب در نسخه‌های بدون دسته نیز وجود دارند. با توجه به اینکه انتقال تنها یک دارایی احتمالاً همچنان رایج ترین راه مورد استفاده خواهد بود، این کار به منظور بهره وری گاز انجام می شود. ما همگی آنها، از جمله قوانین انتقال ایمن را به خاطر سادگی در توضیحات کنار گذاشتیم. نام ها یکسان هستند، فقط "دسته ای" را حذف کنید.

## بیشتر بخوانید {#further-reading}

- [EIP-1155: استاندارد چند توکنی](https://eips.ethereum.org/EIPS/eip-1155)
- [ERC-1155: مستندات Openzeppelin](https://docs.openzeppelin.com/contracts/3.x/erc1155)
- [ERC-1155: در Repo گیت هاب](https://github.com/enjin/erc-1155)
- [Alchemy NFT API](https://docs.alchemy.com/alchemy/enhanced-apis/nft-api)
