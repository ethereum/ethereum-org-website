---
title: 낙관적 롤업
description: 낙관적 롤업 소개—이더리움 커뮤니티에서 사용하는 확장 솔루션입니다.
lang: ko
---

낙관적 롤업은 이더리움의 기본 레이어 처리량을 확장하기 위해 설계된 레이어 2(L2) 프로토콜입니다. 이들은 오프체인으로 트랜잭션을 처리하여 메인 이더리움 체인의 연산을 줄여주므로 처리 속도가 크게 향상됩니다. [사이드체인](/developers/docs/scaling/sidechains/)과 같은 다른 확장 솔루션이나, 이더리움에서 사기 증명으로 트랜잭션을 검증하지만 트랜잭션 데이터를 다른 곳에 저장하는 [플라즈마 체인](/developers/docs/scaling/plasma/)과 달리, 낙관적 롤업은 트랜잭션 결과를 온체인에 게시하여 메인넷으로부터 보안을 확보합니다.

연산은 이더리움을 사용하는 데 있어 느리고 비용이 많이 드는 부분이므로, 낙관적 롤업은 확장성을 10~100배 향상시킬 수 있습니다. 낙관적 롤업은 또한 이더리움에 트랜잭션을 `calldata` 또는 [블롭](/roadmap/danksharding/)으로 기록하여 사용자의 가스 비용을 줄입니다.

## 필수 구성 요소 {#prerequisites}

[이더리움 확장](/developers/docs/scaling/) 및 [레이어 2](/layer-2/)에 대한 페이지를 읽고 이해해야 합니다.

## 낙관적 롤업이란 무엇인가요? {#what-is-an-optimistic-rollup}

낙관적 롤업은 연산 및 상태 저장을 오프체인으로 이동하는 이더리움 확장 방식입니다. 낙관적 롤업은 이더리움 외부에서 트랜잭션을 실행하지만, 트랜잭션 데이터를 `calldata` 또는 [블롭](/roadmap/danksharding/)으로 메인넷에 게시합니다.

낙관적 롤업 운영자는 이더리움에 제출하기 전에 여러 오프체인 트랜잭션을 대규모 배치로 묶습니다. 이 접근 방식을 사용하면 각 배치의 여러 트랜잭션에 고정 비용을 분산하여 최종 사용자의 수수료를 줄일 수 있습니다. 또한 낙관적 롤업은 압축 기술을 사용하여 이더리움에 게시되는 데이터의 양을 줄입니다.

낙관적 롤업이 "낙관적"이라고 간주되는 이유는 오프체인 트랜잭션이 유효하다고 가정하고 온체인에 게시된 트랜잭션 배치에 대한 유효성 증명을 게시하지 않기 때문입니다. 이 점은 오프체인 트랜잭션에 대한 암호화된 [유효성 증명](/glossary/#validity-proof)을 게시하는 [영지식 롤업](/developers/docs/scaling/zk-rollups)과 낙관적 롤업을 구분합니다.

대신 낙관적 롤업은 사기 증명 체계를 사용하여 트랜잭션이 올바르게 계산되지 않은 경우를 감지합니다. 롤업 배치가 이더리움에 제출된 후에는 누구나 [사기 증명](/glossary/#fraud-proof)을 계산하여 롤업 트랜잭션 결과에 이의를 제기할 수 있는 시간 창(챌린지 기간이라고 함)이 있습니다.

사기 증명이 성공하면 롤업 프로토콜은 트랜잭션을 다시 실행하고 그에 따라 롤업의 상태를 업데이트합니다. 사기 증명이 성공할 경우 또 다른 효과는 잘못 실행된 트랜잭션을 블록에 포함시킨 시퀀서가 페널티를 받는다는 것입니다.

챌린지 기간이 지난 후에도 롤업 배치에 이의가 제기되지 않으면(즉, 모든 트랜잭션이 올바르게 실행되면) 유효한 것으로 간주되어 이더리움에서 수락됩니다. 다른 사람들은 미확인 롤업 블록을 기반으로 계속 구축할 수 있지만, 이전에 게시된 잘못 실행된 트랜잭션을 기반으로 한 경우 트랜잭션 결과가 되돌려진다는 주의사항이 있습니다.

## 낙관적 롤업은 이더리움과 어떻게 상호 작용하나요? {#optimistic-rollups-and-Ethereum}

낙관적 롤업은 이더리움 위에서 작동하도록 구축된 [오프체인 확장 솔루션](/developers/docs/scaling/#offchain-scaling)입니다. 각 낙관적 롤업은 이더리움 네트워크에 배포된 스마트 계약 세트에 의해 관리됩니다. 낙관적 롤업은 메인 이더리움 체인 외부에서 트랜잭션을 처리하지만 오프체인 트랜잭션(배치 단위)을 온체인 롤업 계약에 게시합니다. 이더리움 블록체인과 마찬가지로 이 트랜잭션 기록은 변경할 수 없으며 "낙관적 롤업 체인"을 형성합니다.

낙관적 롤업의 아키텍처는 다음 부분으로 구성됩니다.

**온체인 계약**: 낙관적 롤업의 운영은 이더리움에서 실행되는 스마트 계약에 의해 제어됩니다. 여기에는 롤업 블록을 저장하고, 롤업의 상태 업데이트를 모니터링하며, 사용자 예금을 추적하는 계약이 포함됩니다. 이러한 의미에서 이더리움은 낙관적 롤업의 기본 레이어 또는 "레이어 1" 역할을 합니다.

**오프체인 가상 머신(VM)**: 낙관적 롤업 프로토콜을 관리하는 계약은 이더리움에서 실행되지만, 롤업 프로토콜은 [이더리움 가상 머신](/developers/docs/evm/)과는 별개의 다른 가상 머신에서 연산 및 상태 저장을 수행합니다. 오프체인 VM은 애플리케이션이 존재하고 상태 변경이 실행되는 곳으로, 낙관적 롤업의 상위 레이어 또는 "레이어 2" 역할을 합니다.

낙관적 롤업은 EVM용으로 작성되거나 컴파일된 프로그램을 실행하도록 설계되었으므로, 오프체인 VM은 많은 EVM 설계 사양을 통합합니다. 또한 온체인에서 계산된 사기 증명을 통해 이더리움 네트워크는 오프체인 VM에서 계산된 상태 변경의 유효성을 강제할 수 있습니다.

낙관적 롤업은 별도의 프로토콜로 존재하지만 보안 속성은 이더리움에서 파생되므로 '하이브리드 확장 솔루션'으로 설명됩니다. 무엇보다도 이더리움은 롤업의 오프체인 연산의 정확성과 연산 이면의 데이터 가용성을 보장합니다. 이로 인해 낙관적 롤업은 보안을 위해 이더리움에 의존하지 않는 순수 오프체인 확장 프로토콜(예: [사이드체인](/developers/docs/scaling/sidechains/))보다 더 안전합니다.

낙관적 롤업은 다음을 위해 메인 이더리움 프로토콜에 의존합니다.

### 데이터 가용성 {#data-availability}

언급했듯이, 낙관적 롤업은 트랜잭션 데이터를 `calldata` 또는 [블롭](/roadmap/danksharding/)으로 이더리움에 게시합니다. 롤업 체인의 실행은 제출된 트랜잭션을 기반으로 하므로, 누구나 이더리움의 기본 레이어에 고정된 이 정보를 사용하여 롤업의 상태를 실행하고 상태 전환의 정확성을 검증할 수 있습니다.

[데이터 가용성](/developers/docs/data-availability/)은 상태 데이터에 액세스하지 않으면 챌린저가 유효하지 않은 롤업 작업에 이의를 제기하기 위해 사기 증명을 구성할 수 없기 때문에 매우 중요합니다. 이더리움이 데이터 가용성을 제공함으로써 롤업 운영자가 악의적인 행위(예: 유효하지 않은 블록 제출)를 저지르고도 무사히 넘어갈 위험이 줄어듭니다.

### 검열 저항성 {#censorship-resistance}

또한 낙관적 롤업은 검열 저항성을 위해 이더리움에 의존합니다. 낙관적 롤업에서는 중앙화된 주체(운영자)가 트랜잭션을 처리하고 롤업 블록을 이더리움에 제출하는 책임을 집니다. 여기에는 몇 가지 시사점이 있습니다.

- 롤업 운영자는 완전히 오프라인 상태가 되거나 특정 트랜잭션을 포함하는 블록 생성을 거부함으로써 사용자를 검열할 수 있습니다.

- 롤업 운영자는 소유권의 머클 증명에 필요한 상태 데이터를 보류함으로써 사용자가 롤업 계약에 예치된 자금을 인출하는 것을 막을 수 있습니다. 상태 데이터를 보류하면 사용자로부터 롤업의 상태를 숨기고 롤업과 상호 작용하는 것을 막을 수도 있습니다.

낙관적 롤업은 운영자가 이더리움의 상태 업데이트와 관련된 데이터를 게시하도록 강제하여 이 문제를 해결합니다. 롤업 데이터를 온체인에 게시하면 다음과 같은 이점이 있습니다.

- 낙관적 롤업 운영자가 오프라인 상태가 되거나 트랜잭션 배치 생성을 중단하면 다른 노드가 사용 가능한 데이터를 사용하여 롤업의 마지막 상태를 재현하고 블록 생성을 계속할 수 있습니다.

- 사용자는 트랜잭션 데이터를 사용하여 자금 소유권을 증명하는 머클 증명을 생성하고 롤업에서 자산을 인출할 수 있습니다.

- 사용자는 시퀀서 대신 L1에 트랜잭션을 제출할 수도 있으며, 이 경우 시퀀서는 유효한 블록을 계속 생성하기 위해 특정 시간 제한 내에 트랜잭션을 포함해야 합니다.

### 정산 {#settlement}

낙관적 롤업의 맥락에서 이더리움이 수행하는 또 다른 역할은 정산 레이어의 역할입니다. 정산 레이어는 전체 블록체인 생태계를 고정하고, 보안을 설정하며, 중재가 필요한 다른 체인(이 경우 낙관적 롤업)에서 분쟁이 발생할 경우 객관적인 최종성을 제공합니다.

이더리움 메인넷은 낙관적 롤업이 사기 증명을 검증하고 분쟁을 해결할 수 있는 허브를 제공합니다. 또한 롤업에서 수행된 트랜잭션은 롤업 블록이 이더리움에서 수락된 _후에야_ 최종적으로 확정됩니다. 롤업 트랜잭션이 이더리움의 기본 레이어에 커밋되면 (체인 재구성과 같은 매우 드문 경우를 제외하고는) 롤백할 수 없습니다.

## 낙관적 롤업은 어떻게 작동하나요? {#how-optimistic-rollups-work}

### 트랜잭션 실행 및 집계 {#transaction-execution-and-aggregation}

사용자는 낙관적 롤업에서 트랜잭션 처리를 담당하는 노드인 “운영자”에게 트랜잭션을 제출합니다. “검증자” 또는 “집계자”라고도 하는 운영자는 트랜잭션을 집계하고, 기본 데이터를 압축하며, 이더리움에 블록을 게시합니다.

[지분 증명 시스템](/developers/docs/consensus-mechanisms/pos/)과 마찬가지로 누구나 검증자가 될 수 있지만, 낙관적 롤업 검증자는 블록을 생성하기 전에 본드를 제공해야 합니다. 검증자가 유효하지 않은 블록을 게시하거나 오래되었지만 유효하지 않은 블록을 기반으로 구축하는 경우(자신의 블록이 유효하더라도) 이 본드는 삭감될 수 있습니다. 이러한 방식으로 낙관적 롤업은 암호경제학적 인센티브를 활용하여 검증자가 정직하게 행동하도록 보장합니다.

낙관적 롤업 체인의 다른 검증자들은 롤업 상태의 복사본을 사용하여 제출된 트랜잭션을 실행해야 합니다. 검증자의 최종 상태가 운영자가 제안한 상태와 다른 경우, 챌린지를 시작하고 사기 증명을 계산할 수 있습니다.

일부 낙관적 롤업은 무허가형 검증자 시스템을 포기하고 단일 “시퀀서”를 사용하여 체인을 실행할 수 있습니다. 검증자와 마찬가지로 시퀀서는 트랜잭션을 처리하고, 롤업 블록을 생성하며, L1 체인(이더리움)에 롤업 트랜잭션을 제출합니다.

시퀀서는 트랜잭션 순서에 대해 더 큰 통제권을 가지고 있기 때문에 일반 롤업 운영자와 다릅니다. 또한 시퀀서는 롤업 체인에 대한 우선 액세스 권한을 가지며 온체인 계약에 트랜잭션을 제출할 수 있는 유일한 주체입니다. 시퀀서가 아닌 노드나 일반 사용자의 트랜잭션은 시퀀서가 새 배치에 포함할 때까지 별도의 받은 편지함에 대기열로 간단히 저장됩니다.

#### 이더리움에 롤업 블록 제출 {#submitting-blocks-to-ethereum}

언급했듯이, 낙관적 롤업의 운영자는 오프체인 트랜잭션을 배치로 묶어 공증을 위해 이더리움으로 보냅니다. 이 과정에는 트랜잭션 관련 데이터를 압축하여 이더리움에 `calldata` 또는 블롭으로 게시하는 작업이 포함됩니다.

`calldata`는 스마트 계약에서 수정할 수 없고 비영구적인 영역으로, 대부분 [메모리](/developers/docs/smart-contracts/anatomy/#memory)처럼 작동합니다. `calldata`는 블록체인의 [히스토리 로그](https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html?highlight=memory#logs)의 일부로 온체인에 유지되지만, 이더리움 상태의 일부로 저장되지는 않습니다. `calldata`는 이더리움 상태의 어떤 부분도 건드리지 않기 때문에, 온체인에 데이터를 저장하는 데 상태보다 저렴합니다.

`calldata` 키워드는 솔리디티에서 실행 시 스마트 계약 함수에 인수를 전달하는 데에도 사용됩니다. `calldata`는 트랜잭션 중에 호출되는 함수를 식별하고 임의의 바이트 시퀀스 형태로 함수에 대한 입력을 보유합니다.

낙관적 롤업의 맥락에서 `calldata`는 압축된 트랜잭션 데이터를 온체인 계약으로 보내는 데 사용됩니다. 롤업 운영자는 롤업 계약에서 필요한 함수를 호출하고 압축된 데이터를 함수 인수로 전달하여 새 배치를 추가합니다. `calldata`를 사용하면 롤업이 발생하는 대부분의 비용이 온체인 데이터 저장에서 발생하므로 사용자 수수료가 절감됩니다.

이 개념이 어떻게 작동하는지 보여주는 롤업 배치 제출의 [예시](https://eth.blockscout.com/tx/0x9102bfce17c58b5fc1c974c24b6bb7a924fb5fbd7c4cd2f675911c27422a5591)가 있습니다. 시퀀서는 `appendSequencerBatch()` 메서드를 호출하고 `calldata`를 사용하여 압축된 트랜잭션 데이터를 입력으로 전달했습니다.

일부 롤업은 이제 블롭을 사용하여 이더리움에 트랜잭션 배치를 게시합니다.

블롭은 (`calldata`와 마찬가지로) 수정할 수 없고 비영구적이지만 약 18일 후에 히스토리에서 제거됩니다. 블롭에 대한 자세한 내용은 [덴크샤딩](/roadmap/danksharding)을 참조하세요.

### 상태 커밋먼트 {#state-commitments}

어느 시점에서든 낙관적 롤업의 상태(계정, 잔액, 계약 코드 등) 는 "상태 트리"라고 불리는 [머클 트리](/whitepaper/#merkle-trees)로 구성됩니다. 롤업의 최신 상태를 참조하는 이 머클 트리의 루트(상태 루트)는 해시되어 롤업 계약에 저장됩니다. 체인에서의 모든 상태 전환은 새로운 롤업 상태를 생성하며, 운영자는 새로운 상태 루트를 계산하여 이를 커밋합니다.

운영자는 배치를 게시할 때 이전 상태 루트와 새로운 상태 루트를 모두 제출해야 합니다. 이전 상태 루트가 온체인 계약의 기존 상태 루트와 일치하면, 후자는 폐기되고 새로운 상태 루트로 대체됩니다.

롤업 운영자는 트랜잭션 배치 자체에 대한 머클 루트도 커밋해야 합니다. 이를 통해 누구나 [머클 증명](/developers/tutorials/merkle-proofs-for-offline-data-integrity/)을 제시하여 배치(L1에서)에 트랜잭션이 포함되었음을 증명할 수 있습니다.

상태 커밋, 특히 상태 루트는 낙관적 롤업에서 상태 변경의 정확성을 증명하는 데 필요합니다. 롤업 계약은 운영자가 게시한 직후 새로운 상태 루트를 수락하지만, 나중에 유효하지 않은 상태 루트를 삭제하여 롤업을 올바른 상태로 복원할 수 있습니다.

### 사기 증명 {#fraud-proving}

설명했듯이, 낙관적 롤업은 누구나 유효성 증명을 제공하지 않고 블록을 게시할 수 있도록 합니다. 하지만 체인의 안전을 보장하기 위해, 낙관적 롤업은 누구나 상태 전환에 이의를 제기할 수 있는 시간 창을 지정합니다. 따라서 누구나 그 유효성에 이의를 제기할 수 있기 때문에 롤업 블록은 "어설션"이라고 불립니다.

누군가 어설션에 이의를 제기하면, 롤업 프로토콜은 사기 증명 계산을 시작합니다. 모든 유형의 사기 증명은 상호작용적입니다. 즉, 다른 사람이 이의를 제기하기 전에 누군가가 어설션을 게시해야 합니다. 차이점은 사기 증명을 계산하는 데 필요한 상호작용 라운드의 수에 있습니다.

단일 라운드 상호작용 증명 체계는 L1에서 분쟁이 발생한 트랜잭션을 재생하여 유효하지 않은 어설션을 감지합니다. 롤업 프로토콜은 검증자 계약을 사용하여 L1(이더리움)에서 분쟁이 발생한 트랜잭션의 재실행을 에뮬레이트하며, 계산된 상태 루트가 챌린지의 승자를 결정합니다. 롤업의 올바른 상태에 대한 챌린저의 주장이 맞으면, 운영자는 본드가 삭감되는 페널티를 받습니다.

그러나 사기를 감지하기 위해 L1에서 트랜잭션을 재실행하려면 개별 트랜잭션에 대한 상태 커밋을 게시해야 하며, 롤업이 온체인에 게시해야 하는 데이터 양이 증가합니다. 트랜잭션을 재생하면 상당한 가스 비용도 발생합니다. 이러한 이유로, 낙관적 롤업은 다중 라운드 상호작용 증명으로 전환하고 있으며, 이는 동일한 목표(즉, 유효하지 않은 롤업 작업 감지)를 더 효율적으로 달성합니다.

#### 다중 라운드 상호작용 증명 {#multi-round-interactive-proving}

다중 라운드 상호작용 증명은 어설터와 챌린저 간의 상호 프로토콜을 포함하며, 이는 L1 검증자 계약에 의해 감독되고 궁극적으로 거짓말하는 당사자를 결정합니다. L2 노드가 어설션에 이의를 제기한 후, 어설터는 분쟁이 발생한 어설션을 두 개의 동일한 절반으로 나누어야 합니다. 이 경우 각 개별 어설션은 다른 어설션과 동일한 수의 연산 단계를 포함합니다.

그러면 챌린저는 이의를 제기할 어설션을 선택합니다. 분할 과정("이분법 프로토콜"이라고 함)은 양 당사자가 실행의 _단일_ 단계에 대한 어설션에 대해 분쟁을 벌일 때까지 계속됩니다. 이 시점에서 L1 계약은 지침(및 그 결과)을 평가하여 분쟁을 해결하고 사기 당사자를 적발합니다.

어설터는 분쟁이 발생한 단일 단계 연산의 유효성을 검증하는 “단일 단계 증명”을 제공해야 합니다. 어설터가 단일 단계 증명을 제공하지 못하거나 L1 검증자가 증명을 유효하지 않다고 판단하면 챌린지에서 패배합니다.

이 유형의 사기 증명에 대한 몇 가지 참고 사항:

1. 다중 라운드 상호작용 사기 증명은 분쟁 중재에서 L1 체인이 해야 할 작업을 최소화하기 때문에 효율적인 것으로 간주됩니다. 전체 트랜잭션을 재생하는 대신, L1 체인은 롤업 실행에서 한 단계만 다시 실행하면 됩니다.

2. 이분법 프로토콜은 온체인에 게시되는 데이터의 양을 줄입니다(모든 트랜잭션에 대해 상태 커밋을 게시할 필요 없음). 또한, 낙관적 롤업 트랜잭션은 이더리움의 가스 한도에 의해 제한되지 않습니다. 반대로, 트랜잭션을 재실행하는 낙관적 롤업은 단일 이더리움 트랜잭션 내에서 실행을 에뮬레이트하기 위해 L2 트랜잭션의 가스 한도를 낮추어야 합니다.

3. 악의적인 어설터의 본드 일부는 챌린저에게 수여되고, 나머지 일부는 소각됩니다. 소각은 검증자 간의 담합을 방지합니다. 만약 두 검증자가 담합하여 가짜 챌린지를 시작하면, 그들은 여전히 전체 스테이킹의 상당 부분을 잃게 됩니다.

4. 다중 라운드 상호작용 증명은 양 당사자(어설터와 챌린저)가 지정된 시간 창 내에서 움직여야 합니다. 마감일 전에 조치를 취하지 않으면 불이행 당사자가 챌린지를 포기하게 됩니다.

#### 낙관적 롤업에서 사기 증명이 중요한 이유 {#fraud-proof-benefits}

사기 증명은 낙관적 롤업에서 _무신뢰 최종성_을 촉진하기 때문에 중요합니다. 무신뢰 최종성은 트랜잭션이 유효하기만 하다면 결국 확정될 것이라고 보장하는 낙관적 롤업의 품질입니다.

악의적인 노드는 거짓 챌린지를 시작하여 유효한 롤업 블록의 확정을 지연시키려고 할 수 있습니다. 그러나 사기 증명은 결국 롤업 블록의 유효성을 증명하고 확정되도록 합니다.

이는 또한 낙관적 롤업의 또 다른 보안 속성과 관련이 있습니다. 체인의 유효성은 _하나의_ 정직한 노드의 존재에 달려 있습니다. 정직한 노드는 유효한 어설션을 게시하거나 유효하지 않은 어설션에 이의를 제기함으로써 체인을 올바르게 진행시킬 수 있습니다. 어떤 경우든, 정직한 노드와 분쟁에 들어가는 악의적인 노드는 사기 증명 과정에서 자신의 스테이킹을 잃게 됩니다.

### L1/L2 상호운용성 {#l1-l2-interoperability}

낙관적 롤업은 이더리움 메인넷과의 상호운용성을 위해 설계되었으며, 사용자가 L1과 L2 간에 메시지와 임의의 데이터를 전달할 수 있도록 합니다. 또한 EVM과 호환되므로 기존 [탈중앙화앱](/developers/docs/dapps/)을 낙관적 롤업으로 포팅하거나 이더리움 개발 도구를 사용하여 새로운 탈중앙화앱을 만들 수 있습니다.

#### 1. 자산 이동 {#asset-movement}

##### 롤업 진입하기

낙관적 롤업을 사용하기 위해 사용자는 ETH, ERC-20 토큰 및 기타 허용된 자산을 L1의 롤업 [브리지](/developers/docs/bridges/) 계약에 예치합니다. 브리지 계약은 트랜잭션을 L2로 전달하며, 여기에서 동일한 양의 자산이 발행되어 낙관적 롤업에서 사용자가 선택한 주소로 전송됩니다.

사용자가 생성한 트랜잭션(예: L1 > L2 예금)은 일반적으로 시퀀서가 롤업 계약에 다시 제출할 때까지 대기열에 들어갑니다. 그러나 검열 저항성을 유지하기 위해, 낙관적 롤업은 트랜잭션이 허용된 최대 시간을 초과하여 지연된 경우 사용자가 직접 온체인 롤업 계약에 트랜잭션을 제출할 수 있도록 허용합니다.

일부 낙관적 롤업은 시퀀서가 사용자를 검열하는 것을 방지하기 위해 더 간단한 접근 방식을 채택합니다. 여기서 블록은 롤업 체인에서 처리된 트랜잭션 외에 이전 블록 이후 L1 계약에 제출된 모든 트랜잭션(예: 예금)으로 정의됩니다. 시퀀서가 L1 트랜잭션을 무시하면 (증명 가능하게) 잘못된 상태 루트를 게시하게 됩니다. 따라서 시퀀서는 L1에 게시된 사용자 생성 메시지를 지연시킬 수 없습니다.

##### 롤업 나가기

낙관적 롤업에서 이더리움으로 인출하는 것은 사기 증명 체계 때문에 더 어렵습니다. 사용자가 L1에 에스크로된 자금을 인출하기 위해 L2 > L1 트랜잭션을 시작하는 경우, 약 7일 동안 지속되는 챌린지 기간이 끝날 때까지 기다려야 합니다. 그럼에도 불구하고 인출 과정 자체는 매우 간단합니다.

L2 롤업에서 인출 요청이 시작되면 트랜잭션은 다음 배치에 포함되고, 롤업에 있는 사용자의 자산은 소각됩니다. 배치가 이더리움에 게시되면, 사용자는 블록에 자신의 출금 트랜잭션이 포함되었음을 확인하는 머클 증명을 계산할 수 있습니다. 그런 다음 지연 기간을 기다려 L1에서 트랜잭션을 최종 확정하고 메인넷으로 자금을 인출하기만 하면 됩니다.

이더리움으로 자금을 인출하기 전에 일주일을 기다리는 것을 피하기 위해, 낙관적 롤업 사용자는 **유동성 공급자**(LP)를 이용할 수 있습니다. 유동성 공급자는 보류 중인 L2 인출의 소유권을 가정하고 L1에서 사용자에게 (수수료를 받고) 지불합니다.

유동성 공급자는 자금을 지급하기 전에 사용자의 인출 요청의 유효성을 (직접 체인을 실행하여) 확인할 수 있습니다. 이런 식으로 그들은 트랜잭션이 결국 확정될 것이라는 보증(즉, 무신뢰 최종성)을 갖게 됩니다.

#### 2. EVM 호환성 {#evm-compatibility}

개발자에게 낙관적 롤업의 장점은 [이더리움 가상 머신(EVM)](/developers/docs/evm/)과의 호환성 또는 더 나아가 동등성입니다. EVM 호환 롤업은 [이더리움 옐로 페이퍼](https://ethereum.github.io/yellowpaper/paper.pdf)의 사양을 준수하며 바이트코드 수준에서 EVM을 지원합니다.

낙관적 롤업의 EVM 호환성은 다음과 같은 이점을 가집니다.

i. 개발자는 코드베이스를 광범위하게 수정할 필요 없이 이더리움의 기존 스마트 계약을 낙관적 롤업 체인으로 마이그레이션할 수 있습니다. 이를 통해 개발팀은 L2에 이더리움 스마트 계약을 배포할 때 시간을 절약할 수 있습니다.

ii. 낙관적 롤업을 사용하는 개발자와 프로젝트 팀은 이더리움의 인프라를 활용할 수 있습니다. 여기에는 프로그래밍 언어, 코드 라이브러리, 테스트 도구, 클라이언트 소프트웨어, 배포 인프라 등이 포함됩니다.

기존 도구를 사용하는 것은 이러한 도구들이 수년에 걸쳐 광범위하게 감사, 디버깅 및 개선되었기 때문에 중요합니다. 또한 이더리움 개발자가 완전히 새로운 개발 스택으로 구축하는 방법을 배울 필요가 없습니다.

#### 3. 크로스체인 계약 호출 {#cross-chain-contract-calls}

사용자(외부 소유 계정)는 롤업 계약에 트랜잭션을 제출하거나 시퀀서 또는 검증자가 대신 처리하도록 하여 L2 계약과 상호 작용합니다. 낙관적 롤업은 또한 이더리움의 계약 계정이 브리지 계약을 사용하여 L1과 L2 간에 메시지를 전달하고 데이터를 주고받음으로써 L2 계약과 상호 작용할 수 있도록 합니다. 이는 이더리움 메인넷의 L1 계약을 프로그래밍하여 L2 낙관적 롤업의 계약에 속한 함수를 호출할 수 있음을 의미합니다.

크로스체인 계약 호출은 비동기적으로 발생합니다. 즉, 호출이 먼저 시작된 다음 나중에 실행됩니다. 이는 호출이 즉시 결과를 생성하는 이더리움의 두 계약 간 호출과는 다릅니다.

크로스체인 계약 호출의 예로는 앞에서 설명한 토큰 예치가 있습니다. L1의 계약은 사용자의 토큰을 에스크로하고 페어링된 L2 계약에 메시지를 보내 롤업에서 동일한 양의 토큰을 발행합니다.

크로스체인 메시지 호출은 계약 실행을 초래하므로, 발신자는 일반적으로 연산에 대한 [가스 비용](/developers/docs/gas/)을 부담해야 합니다. 대상 체인에서 트랜잭션이 실패하지 않도록 가스 한도를 높게 설정하는 것이 좋습니다. 토큰 브리징 시나리오가 좋은 예입니다. 트랜잭션의 L1 측(토큰 예치)은 작동하지만 L2 측(새 토큰 발행)이 낮은 가스로 인해 실패하면 예금은 복구할 수 없게 됩니다.

마지막으로, 계약 간의 L2 > L1 메시지 호출은 지연을 고려해야 한다는 점에 유의해야 합니다(L1 > L2 호출은 일반적으로 몇 분 후에 실행됨). 이는 낙관적 롤업에서 메인넷으로 전송된 메시지는 챌린지 기간이 만료될 때까지 실행될 수 없기 때문입니다.

## 낙관적 롤업 수수료는 어떻게 작동하나요? {#how-do-optimistic-rollup-fees-work}

낙관적 롤업은 이더리움과 마찬가지로 가스 수수료 체계를 사용하여 사용자가 트랜잭션당 지불하는 금액을 나타냅니다. 낙관적 롤업에 부과되는 수수료는 다음 구성 요소에 따라 달라집니다.

1. **상태 쓰기**: 낙관적 롤업은 트랜잭션 데이터와 블록 헤더(이전 블록 헤더 해시, 상태 루트, 배치 루트로 구성)를 이더리움에 `blob` 또는 "바이너리 대형 객체"로 게시합니다. [EIP-4844](https://eips.ethereum.org/EIPS/eip-4844)는 온체인에 데이터를 포함하는 비용 효율적인 솔루션을 도입했습니다. `blob`은 롤업이 압축된 상태 전환 데이터를 이더리움 L1에 게시할 수 있도록 하는 새로운 트랜잭션 필드입니다. 영구적으로 온체인에 남아있는 `calldata`와 달리 블롭은 수명이 짧으며 [4096 에폭](https://github.com/ethereum/consensus-specs/blob/81f3ea8322aff6b9fb15132d050f8f98b16bdba4/configs/mainnet.yaml#L147)(약 18일) 후에 클라이언트에서 제거될 수 있습니다. 블롭을 사용하여 압축된 트랜잭션 배치를 게시함으로써 낙관적 롤업은 L1에 트랜잭션을 쓰는 비용을 크게 줄일 수 있습니다.

2. **사용된 블롭 가스**: 블롭을 포함하는 트랜잭션은 [EIP-1559](https://eips.ethereum.org/EIPS/eip-1559)에 의해 도입된 것과 유사한 동적 수수료 메커니즘을 사용합니다. 유형 3 트랜잭션의 가스 수수료는 블롭에 대한 기본 수수료를 고려하며, 이는 블롭 공간 수요와 전송되는 트랜잭션의 블롭 공간 사용량에 따라 네트워크에 의해 결정됩니다.

3. **L2 운영자 수수료**: 이는 이더리움의 가스 수수료와 마찬가지로 트랜잭션 처리에서 발생하는 연산 비용에 대한 보상으로 롤업 노드에 지불되는 금액입니다. L2는 처리 용량이 더 높고, 이더리움의 검증자가 더 높은 수수료의 트랜잭션을 우선적으로 처리하도록 강요하는 네트워크 혼잡에 직면하지 않기 때문에 롤업 노드는 더 낮은 거래 수수료를 부과합니다.

낙관적 롤업은 트랜잭션 배치 및 `calldata` 압축을 포함한 여러 메커니즘을 적용하여 데이터 게시 비용을 줄이고 사용자의 수수료를 절감합니다. [L2 수수료 추적기](https://l2fees.info/)에서 이더리움 기반 낙관적 롤업 사용 비용에 대한 실시간 개요를 확인할 수 있습니다.

## 낙관적 롤업은 어떻게 이더리움을 확장하나요? {#scaling-ethereum-with-optimistic-rollups}

설명했듯이, 낙관적 롤업은 데이터 가용성을 보장하기 위해 압축된 트랜잭션 데이터를 이더리움에 게시합니다. 온체인에 게시된 데이터를 압축하는 능력은 낙관적 롤업으로 이더리움의 처리량을 확장하는 데 매우 중요합니다.

메인 이더리움 체인은 블록이 보유할 수 있는 데이터의 양에 가스 단위로 제한을 둡니다([평균 블록 크기](/developers/docs/blocks/#block-size)는 1,500만 가스입니다). 이는 각 트랜잭션이 사용할 수 있는 가스의 양을 제한하지만, 트랜잭션 관련 데이터를 줄여 블록당 처리되는 트랜잭션을 늘릴 수 있다는 의미이기도 하며, 이는 확장성을 직접적으로 향상시킵니다.

낙관적 롤업은 트랜잭션 데이터 압축을 달성하고 TPS 속도를 향상시키기 위해 여러 기술을 사용합니다. 예를 들어, 이 [기사](https://vitalik.eth.limo/general/2021/01/05/rollup.html)는 기본 사용자 트랜잭션(이더 전송)이 메인넷에서 생성하는 데이터와 동일한 트랜잭션이 롤업에서 생성하는 데이터의 양을 비교합니다.

| 매개 변수     | 이더리움(L1)                          | 롤업(L2)            |
| --------- | ---------------------------------------------------- | ------------------------------------ |
| Nonce     | ~3                                   | 0                                    |
| 가스 가격     | ~8                                   | 0-0.5                |
| 가스        | 3                                                    | 0-0.5                |
| 받는 주소     | 21                                                   | 4                                    |
| 값         | 9                                                    | ~3                   |
| Signature | ~68 (2 + 33 + 33) | ~0.5 |
| 보내는 주소    | 0 (서명에서 복구)                       | 4                                    |
| **합계**    | **~112 바이트**                         | **~12 바이트**          |

이 수치에 대한 대략적인 계산을 통해 낙관적 롤업이 제공하는 확장성 향상을 보여줄 수 있습니다.

1. 모든 블록의 목표 크기는 1,500만 가스이며, 1바이트의 데이터를 검증하는 데 16가스가 소요됩니다. 평균 블록 크기를 16가스로 나누면(15,000,000/16), 평균 블록은 **937,500바이트의 데이터**를 담을 수 있음을 보여줍니다.
2. 기본 롤업 트랜잭션이 12바이트를 사용한다면, 평균 이더리움 블록은 **78,125개의 롤업 트랜잭션**(937,500/12) 또는 **39개의 롤업 배치**(각 배치가 평균 2,000개의 트랜잭션을 담는 경우)를 처리할 수 있습니다.
3. 이더리움에서 15초마다 새로운 블록이 생성된다면, 롤업의 처리 속도는 초당 약 **5,208 트랜잭션**에 달할 것입니다. 이는 이더리움 블록이 담을 수 있는 기본 롤업 트랜잭션 수(**78,125**)를 평균 블록 시간(**15초**)으로 나누어 계산합니다.

낙관적 롤업 트랜잭션이 이더리움에서 전체 블록을 구성할 수는 없다는 점을 고려하면 이는 상당히 낙관적인 추정치입니다. 그러나 이는 낙관적 롤업이 이더리움 사용자에게 얼마나 많은 확장성 이득을 제공할 수 있는지에 대한 대략적인 아이디어를 제공할 수 있습니다(현재 구현은 최대 2,000 TPS를 제공함).

[데이터 샤딩](/roadmap/danksharding/)이 이더리움에 도입되면 낙관적 롤업의 확장성이 향상될 것으로 예상됩니다. 롤업 트랜잭션은 다른 비롤업 트랜잭션과 블록 공간을 공유해야 하므로 처리 용량은 메인 이더리움 체인의 데이터 처리량에 의해 제한됩니다. 덴크샤딩은 비싸고 영구적인 `CALLDATA` 대신 저렴하고 비영구적인 "블롭" 저장소를 사용하여 L2 체인이 블록당 데이터를 게시하는 데 사용할 수 있는 공간을 늘릴 것입니다.

### 낙관적 롤업의 장단점 {#optimistic-rollups-pros-and-cons}

| 장점                                                                                                       | 단점                                                                                                 |
| -------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
| 보안이나 무신뢰성을 희생하지 않으면서 확장성을 크게 향상시킵니다.                                                     | 잠재적인 사기 챌린지로 인한 트랜잭션 최종성 지연.                                                       |
| 트랜잭션 데이터는 레이어 1 체인에 저장되어 투명성, 보안, 검열 저항성 및 탈중앙화를 향상시킵니다.                                 | 중앙화된 롤업 운영자(시퀀서)가 트랜잭션 순서에 영향을 미칠 수 있습니다.                       |
| 사기 증명은 무신뢰 최종성을 보장하고 정직한 소수 그룹이 체인을 보호할 수 있도록 합니다.                                       | 정직한 노드가 없는 경우 악의적인 운영자가 유효하지 않은 블록과 상태 커밋을 게시하여 자금을 훔칠 수 있습니다.                     |
| 사기 증명 계산은 특별한 하드웨어가 필요한 유효성 증명(ZK 롤업에서 사용)과 달리 일반 L2 노드에 개방되어 있습니다.   | 보안 모델은 롤업 트랜잭션을 실행하고 유효하지 않은 상태 전환에 이의를 제기하기 위해 사기 증명을 제출하는 최소 한 개의 정직한 노드에 의존합니다. |
| 롤업은 "무신뢰 활성"("누구나 트랜잭션을 실행하고 어설션을 게시하여 체인을 강제로 진행시킬 수 있음)의 이점을 누립니다.  | 사용자는 이더리움으로 자금을 인출하기 전에 일주일의 챌린지 기간이 만료될 때까지 기다려야 합니다.                             |
| 낙관적 롤업은 체인의 보안을 강화하기 위해 잘 설계된 암호경제학적 인센티브에 의존합니다.                                        | 롤업은 모든 트랜잭션 데이터를 온체인에 게시해야 하므로 비용이 증가할 수 있습니다.                                     |
| EVM 및 솔리디티와의 호환성을 통해 개발자는 이더리움 네이티브 스마트 계약을 롤업으로 포팅하거나 기존 도구를 사용하여 새로운 탈중앙화앱을 만들 수 있습니다. |                                                                                                    |

### 낙관적 롤업에 대한 시각적 설명 {#optimistic-video}

시각 자료를 찾고 있나요? Finematics에서 옵티미스틱 롤업을 설명하는 것을 살펴보세요.

<YouTube id="7pWxCklcNsU" start="263" />

## 낙관적 롤업에 대한 추가 자료

- [낙관적 롤업은 어떻게 작동하는가 (완벽 가이드)](https://www.alchemy.com/overviews/optimistic-rollups)
- [블록체인 롤업이란 무엇인가?  기술적 소개](https://www.ethereum-ecosystem.com/blog/what-is-a-blockchain-rollup-a-technical-introduction)
- [아비트럼 필수 가이드](https://www.bankless.com/the-essential-guide-to-arbitrum)
- [이더리움 롤업 실용 가이드](https://web.archive.org/web/20241108192208/https://research.2077.xyz/the-practical-guide-to-ethereum-rollups)
- [이더리움 L2의 사기 증명 현황](https://web.archive.org/web/20241124154627/https://research.2077.xyz/the-state-of-fraud-proofs-in-ethereum-l2s)
- [옵티미즘의 롤업은 실제로 어떻게 작동하는가?](https://www.paradigm.xyz/2021/01/how-does-optimism-s-rollup-really-work)
- [OVM 심층 분석](https://medium.com/ethereum-optimism/ovm-deep-dive-a300d1085f52)
- [낙관적 가상 머신이란 무엇인가?](https://www.alchemy.com/overviews/optimistic-virtual-machine)
