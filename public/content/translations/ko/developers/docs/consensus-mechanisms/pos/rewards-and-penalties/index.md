---
title: 지분 증명 보상 및 페널티
description: 지분 증명 이더리움의 프로토콜 내 인센티브에 대해 알아보세요.
lang: ko
---

이더리움은 자체 암호화폐인 이더(ETH)를 사용하여 보안을 유지합니다. 블록 검증 및 체인 헤드 식별에 참여하려는 노드 운영자는 이더를 이더리움의 [예금 계약](/staking/deposit-contract/)에 예치합니다. 그러면 P2P 네트워크를 통해 수신된 새 블록의 유효성을 확인하고 포크 선택 알고리즘을 적용하여 체인의 헤드를 식별하는 검증자 소프트웨어를 실행하는 대가로 이더를 지급받습니다.

검증자의 주요 역할은 두 가지입니다. 1) 새 블록을 확인하고 유효한 경우 이를 '증명'하는 것, 2) 전체 검증자 풀에서 무작위로 선택되었을 때 새 블록을 제안하는 것입니다. 검증자가 요청 시 이러한 작업 중 하나를 수행하지 못하면 이더 지급을 받지 못합니다. 검증자는 때때로 서명 집계 및 동기화 위원회 참여 작업을 맡기도 합니다.

또한 동일한 슬롯에 대해 여러 블록을 제안하거나 동일한 슬롯에 대해 여러 블록을 증명하는 등 우발적으로 수행하기 매우 어렵고 악의적인 의도를 나타내는 일부 작업도 있습니다. 이는 '삭감 가능한' 행동으로, 검증자가 네트워크에서 제거되기 전에 일정량의 이더(최대 1ETH)가 소각되며, 이 과정은 36일이 소요됩니다. 삭감된 검증자의 이더는 출금 기간 동안 서서히 소진되지만, 18일째 되는 날에는 '상관관계 페널티'를 받게 되는데, 이는 더 많은 검증자가 비슷한 시기에 삭감될수록 더 커집니다. 따라서 합의 메커니즘의 인센티브 구조는 정직성에 대한 보상을 제공하고 악의적인 행위자를 처벌합니다.

모든 보상과 페널티는 에폭당 한 번씩 적용됩니다.

자세한 내용은 계속 읽어보세요...

## 보상 및 페널티 {#rewards}

### 보상 {#rewards}

검증자는 다른 검증자 대다수와 일치하는 투표를 하거나, 블록을 제안하거나, 동기화 위원회에 참여할 때 보상을 받습니다. 각 에폭의 보상 가치는 `base_reward`에서 계산됩니다. 이것은 다른 보상이 계산되는 기본 단위입니다. `base_reward`는 최적의 조건에서 검증자가 에폭당 받는 평균 보상을 나타냅니다. 이는 검증자의 유효 잔액과 총 활성 검증자 수에서 다음과 같이 계산됩니다.

```
base_reward = effective_balance * (base_reward_factor / (base_rewards_per_epoch * sqrt(sum(active_balance))))
```

여기서 `base_reward_factor`는 64, `base_rewards_per_epoch`는 4, `sum(active balance)`는 모든 활성 검증자에 걸친 총 스테이킹된 이더입니다.

이는 기본 보상이 검증자의 유효 잔액에 비례하고 네트워크의 검증자 수에 반비례한다는 것을 의미합니다. 검증자가 많을수록 전체 발행량은 커지지만(`sqrt(N)`), 검증자당 `base_reward`는 작아집니다(`1/sqrt(N)`). 이러한 요소는 스테이킹 노드의 APR에 영향을 미칩니다. [Vitalik의 노트](https://notes.ethereum.org/@vbuterin/rkhCgQteN?type=view#Base-rewards)에서 이에 대한 근거를 읽어보세요.

그런 다음 총 보상은 각 구성 요소가 총 보상에 얼마나 기여하는지를 결정하는 가중치를 갖는 5개 구성 요소의 합으로 계산됩니다. 구성 요소는 다음과 같습니다.

```
1. 소스 투표: 검증자가 올바른 소스 체크포인트에 대해 시기적절하게 투표했습니다.
2. 타겟 투표: 검증자가 올바른 타겟 체크포인트에 대해 시기적절하게 투표했습니다.
3. 헤드 투표: 검증자가 올바른 헤드 블록에 대해 시기적절하게 투표했습니다.
4. 동기화 위원회 보상: 검증자가 동기화 위원회에 참여했습니다.
5. 제안자 보상: 검증자가 올바른 슬롯에 블록을 제안했습니다.
```

각 구성 요소의 가중치는 다음과 같습니다.

```
TIMELY_SOURCE_WEIGHT	uint64(14)
TIMELY_TARGET_WEIGHT	uint64(26)
TIMELY_HEAD_WEIGHT	uint64(14)
SYNC_REWARD_WEIGHT	uint64(2)
PROPOSER_WEIGHT	uint64(8)
```

이 가중치의 합은 64입니다. 보상은 적용 가능한 가중치의 합을 64로 나눈 값으로 계산됩니다. 시기적절한 소스, 타겟 및 헤드 투표를 하고 블록을 제안하고 동기화 위원회에 참여한 검증자는 `64/64 * base_reward == base_reward`를 받을 수 있습니다. 그러나 검증자는 일반적으로 블록 제안자가 아니므로 최대 보상은 `64-8 /64 * base_reward == 7/8 * base_reward`입니다. 블록 제안자도 아니고 동기화 위원회에도 속하지 않은 검증자는 `64-8-2 / 64 * base_reward == 6.75/8 * base_reward`를 받을 수 있습니다.

신속한 증명을 장려하기 위해 추가 보상이 추가됩니다. 이것은 `inclusion_delay_reward`입니다. 이 값은 `base_reward`에 `1/delay`를 곱한 값과 같으며, 여기서 `delay`는 블록 제안과 증명 사이의 슬롯 수입니다. 예를 들어, 증명이 블록 제안의 한 슬롯 내에 제출되면 증명자는 `base_reward * 1/1 == base_reward`를 받습니다. 증명이 다음 슬롯에 도착하면 증명자는 `base_reward * 1/2`를 받는 식입니다.

블록 제안자는 블록에 포함된 **각 유효한 증명**에 대해 `8 / 64 * base_reward`를 받으므로 보상의 실제 가치는 증명하는 검증자의 수에 따라 조정됩니다. 블록 제안자는 제안된 블록에 다른 검증자의 부정 행위 증거를 포함하여 보상을 늘릴 수도 있습니다. 이러한 보상은 검증자의 정직성을 장려하는 '당근'입니다. 삭감을 포함하는 블록 제안자는 `slashed_validators_effective_balance / 512`로 보상받습니다.

### 페널티 {#penalties}

지금까지는 완벽하게 잘 행동하는 검증자를 고려했지만, 시기적절하게 헤드, 소스, 타겟 투표를 하지 않거나 느리게 하는 검증자는 어떻게 될까요?

타겟 및 소스 투표를 놓친 것에 대한 페널티는 증명자가 이를 제출했을 경우 받았을 보상과 동일합니다. 이는 보상이 잔액에 추가되는 대신 동일한 가치가 잔액에서 제거된다는 것을 의미합니다. 헤드 투표를 놓치는 것에 대한 페널티는 없습니다(즉, 헤드 투표는 보상만 받고 페널티는 받지 않습니다). `inclusion_delay`와 관련된 페널티는 없으며, 보상은 단순히 검증자의 잔액에 추가되지 않습니다. 블록 제안에 실패해도 페널티는 없습니다.

[합의 사양](https://github.com/ethereum/consensus-specs/blob/dev/specs/altair/beacon-chain.md)에서 보상 및 페널티에 대해 자세히 알아보세요. 보상 및 페널티는 벨라트릭스 업그레이드에서 조정되었습니다. Danny Ryan과 Vitalik이 이 [Peep an EIP 비디오](https://www.youtube.com/watch?v=iaAEGs1DMgQ)에서 이에 대해 논의하는 것을 시청하세요.

## 삭감 {#slashing}

삭감은 검증자를 네트워크에서 강제로 제거하고 관련 스테이킹된 이더를 잃게 되는 더 심각한 조치입니다. 검증자가 삭감될 수 있는 세 가지 방법이 있으며, 이 모든 것은 부정직한 블록 제안 또는 증명에 해당합니다.

- 동일한 슬롯에 대해 두 개의 다른 블록을 제안하고 서명하는 경우
- 다른 블록을 '둘러싸는' 블록을 증명하는 경우(효과적으로 기록을 변경)
- 동일한 블록에 대해 두 후보에게 증명하여 '이중 투표'하는 경우

이러한 행동이 감지되면 검증자는 삭감됩니다. 이는 32 ETH 검증자에 대해 0.0078125가 즉시 소각되고(활성 잔액에 따라 선형적으로 조정), 36일간의 제거 기간이 시작됨을 의미합니다. 이 제거 기간 동안 검증자의 지분은 점차 소진됩니다. 중간 지점(18일)에 추가 페널티가 적용되며, 그 크기는 삭감 이벤트 이전 36일 동안 삭감된 모든 검증자의 총 스테이킹된 이더에 따라 조정됩니다. 이는 더 많은 검증자가 삭감될수록 삭감의 크기가 증가한다는 것을 의미합니다. 최대 삭감액은 삭감된 모든 검증자의 전체 유효 잔액입니다(즉, 많은 검증자가 삭감되면 전체 지분을 잃을 수 있음). 반면에, 단일의 고립된 삭감 이벤트는 검증자 지분의 작은 부분만 소각합니다. 삭감된 검증자의 수에 따라 조정되는 이 중간 지점 페널티를 '상관관계 페널티'라고 합니다.

## 비활동 유출 {#inactivity-leak}

합의 레이어가 4 에폭 이상 최종화되지 않은 경우 '비활동 유출'이라는 비상 프로토콜이 활성화됩니다. 비활동 유출의 궁극적인 목표는 체인이 최종성을 회복하는 데 필요한 조건을 만드는 것입니다. 위에서 설명한 바와 같이, 최종성을 위해서는 총 스테이킹된 이더의 2/3 이상이 소스 및 타겟 체크포인트에 동의해야 합니다. 총 검증자의 1/3 이상을 대표하는 검증자가 오프라인 상태가 되거나 올바른 증명을 제출하지 못하면, 2/3의 절대 다수가 체크포인트를 최종화하는 것이 불가능합니다. 비활동 유출은 비활성 검증자에 속한 지분이 총 지분의 1/3 미만을 제어할 때까지 점차적으로 소진되도록 하여 나머지 활성 검증자가 체인을 최종화할 수 있도록 합니다. 비활성 검증자 풀이 아무리 크더라도, 나머지 활성 검증자는 결국 지분의 2/3 이상을 제어하게 됩니다. 지분 손실은 비활성 검증자가 가능한 한 빨리 다시 활성화하도록 하는 강력한 인센티브입니다! 활성 검증자의 66% 미만이 블록체인의 현재 헤드에 대해 합의에 도달했을 때 Medalla 테스트넷에서 비활동 유출 시나리오가 발생했습니다. 비활동 유출이 활성화되었고 결국 최종성이 회복되었습니다!

합의 메커니즘의 보상, 페널티 및 삭감 설계는 개별 검증자가 올바르게 행동하도록 장려합니다. 그러나 이러한 설계 선택에서 여러 클라이언트에 걸쳐 검증자의 동등한 분배를 강력하게 장려하고 단일 클라이언트 지배를 강력하게 억제하는 시스템이 나타납니다.

## 더 읽어보기 {#further-reading}

- [이더리움 업그레이드: 인센티브 레이어](https://eth2book.info/altair/part2/incentives)
- [이더리움의 하이브리드 캐스퍼 프로토콜의 인센티브](https://arxiv.org/pdf/1903.04205.pdf)
- [Vitalik의 주석이 달린 사양](https://github.com/ethereum/annotated-spec/blob/master/phase0/beacon-chain.md#rewards-and-penalties-1)
- [Eth2 삭감 방지 팁](https://medium.com/prysmatic-labs/eth2-slashing-prevention-tips-f6faa5025f50)
- [EIP-7251에 따른 삭감 페널티 분석](https://ethresear.ch/t/slashing-penalty-analysis-eip-7251/16509)

_출처_

- _[https://benjaminion.xyz/eth2-annotated-spec/phase0/beacon-chain/](https://benjaminion.xyz/eth2-annotated-spec/phase0/beacon-chain/)_
