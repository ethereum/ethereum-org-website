---
title: "지분 증명(PoS)"
description: "지분 증명 합의 프로토콜과 이더리움 상에서 그 역할에 대한 설명"
lang: ko
---

지분 증명(PoS)은 이더리움의 [합의 메커니즘](/developers/docs/consensus-mechanisms/)의 기반입니다. 이더리움은 이전의 [작업 증명](/developers/docs/consensus-mechanisms/pow) 아키텍처에 비해 더 안전하고, 에너지 집약도가 낮으며, 새로운 확장 솔루션을 구현하는 데 더 좋기 때문에 2022년에 지분 증명 메커니즘으로 전환했습니다.

## 필수 구성 요소 {#prerequisites}

이 페이지를 더 잘 이해하려면 먼저 [합의 메커니즘](/developers/docs/consensus-mechanisms/)에 대해 읽어보시는 것을 권장합니다.

## 지분 증명(PoS) 이란 무엇인가요? {#what-is-pos}

지분 증명은 검증자가 부정직하게 행동할 경우 파괴될 수 있는 가치를 네트워크에 투입했음을 증명하는 방법입니다. 이더리움의 지분 증명에서는 검증자가 ETH 형태의 자본을 이더리움의 스마트 계약에 명시적으로 스테이킹합니다. Validator는 블록체인 네트워크에 새로 생성된 블록을 점검한다. 그리고 가끔씩 직접 블록을 생성하기도 한다. 만약 그들이 네트워크를 사기치려고 시도한다면 (예를 들어, 하나를 보내야 할 때 여러 블록을 제안하거나 상충되는 증명을 보내는 경우), 그들의 스테이킹된 ETH의 일부 또는 전부가 소각될 수 있습니다.

## 검증자 {#validators}

검증자로 참여하려면 사용자는 32 ETH를 예치 계약에 예치하고 실행 클라이언트, 합의 클라이언트, 검증 클라이언트의 세 가지 별도의 소프트웨어를 실행해야 합니다. 이더를 예치함으로서 활동 큐 (activation queue)에 참여하게 되며, 이는 새로 참여하려는 검증인들의 수를 제한하는 역할을 한다. 검증인은 이더리움 네트워크 상의 개개인들로부터 새 블록을 할당받는다. 블록에 전달된 거래는 제안된 이더리움 상태 변경이 유효한지 확인하기 위해 다시 실행되며, 블록 서명이 확인됩니다. 검증인은 네트워크로 해당 블록을 승인하는 투표를 보낸다. 이 투표는 attestation이라 부른다.

PoW는 마이닝의 난이도에 따라 블록의 타이밍이 정해졌다면 지분 증명 PoS 는 이러한 타이밍은 고정되어 있다. 이더리움의 지분 증명 시간은 12초 슬롯이 32개 있는 에포크 (epoch) 로 구성되어 있다. 검증인은 각 슬롯마다 블록 제안자 (block proposer) 역할을 맡기 위해 랜덤하게 선택된다. 선택받은 검증인은 새로운 블록 생성과 네트워크 상 다른 노드들로 전송하는 일을 맡는다. 각 슬롯마다 검증인들이 모여 일종의 위원회를 구성하기 되고 각 검증인들의 투표로 제안되는 블록의 유효성을 검증하게 된다. 검증자 집합을 위원회로 나누는 것은 네트워크 부하를 관리 가능하게 유지하는 데 중요합니다. 위원회는 모든 활성 검증자가 모든 에포크에서 증명을 하지만, 모든 슬롯에서는 그렇지 않도록 검증자 집합을 나눕니다.

## 이더리움 지분 증명(PoS)에서 트랜잭션이 실행되는 방법 {#transaction-execution-ethereum-pos}

다음은 이더리움 지분 증명에서 트랜잭션이 어떻게 실행되는지에 대한 종합적인 설명입니다.

1. 사용자는 개인 키로 [트랜잭션](/developers/docs/transactions/)을 생성하고 서명합니다. 이는 보통 [ethers.js](https://docs.ethers.org/v6/), [web3js](https://docs.web3js.org/), [web3py](https://web3py.readthedocs.io/en/v5/) 등과 같은 지갑 또는 라이브러리에서 처리하지만, 내부적으로는 사용자가 이더리움 [JSON-RPC API](/developers/docs/apis/json-rpc/)를 사용하여 노드에 요청을 보내는 것입니다. 사용자는 거래를 블록에 포함하도록 장려하기 위해 검증자에게 팁으로 지불할 준비가 된 가스 양을 정의합니다. [팁](/developers/docs/gas/#priority-fee)은 검증자에게 지급되고 [기본 수수료](/developers/docs/gas/#base-fee)는 소각됩니다.
2. 트랜잭션은 유효성을 검증하는 이더리움 [실행 클라이언트](/developers/docs/nodes-and-clients/#execution-client)에 제출됩니다. 이는 발신자가 거래를 이행할 충분한 ETH를 가지고 있고, 올바른 키로 서명했는지를 확인하는 것을 의미합니다.
3. 거래가 유효하면 실행 클라이언트는 이를 로컬 메모풀(보류 중인 거래 목록)에 추가하고 실행 계층의 가십 네트워크를 통해 다른 노드에 브로드캐스트합니다. 다른 노드들이 거래에 대해 알게 되면 그들도 이를 자신의 로컬 메모풀에 추가합니다. 고급 사용자는 트랜잭션을 브로드캐스팅하지 않고 [Flashbots Auction](https://docs.flashbots.net/flashbots-auction/overview)과 같은 전문 블록 빌더에게 전달할 수 있습니다. 이를 통해 그들은 최대 수익([MEV](/developers/docs/mev/#mev-extraction))을 위해 예정된 블록의 트랜잭션을 정리할 수 있습니다.
4. 네트워크의 검증자 노드 중 하나가 현재 슬롯의 블록 제안자가 되며, 이전에 RANDAO를 사용하여 의사 난수로 선택되었습니다. 이 노드는 이더리움 블록체인에 추가될 다음 블록을 생성하고 브로드캐스트하며 글로벌 상태를 업데이트하는 역할을 담당합니다. 이 노드는 실행 클라이언트, 합의 클라이언트, 검증 클라이언트의 세 부분으로 구성됩니다. 실행 클라이언트는 로컬 메모풀의 거래를 "실행 페이로드"로 묶고 이를 로컬에서 실행하여 상태 변화를 생성합니다. 이 정보는 합의 클라이언트로 전달되며, 여기서 실행 페이로드는 네트워크가 체인의 최상위에 있는 블록 순서에 동의할 수 있도록 보상, 벌금, 슬래싱, 증명 등과 같은 정보를 포함하는 "비콘 블록"의 일부로 포장됩니다. 실행 클라이언트와 합의 클라이언트 간의 통신은 [합의 및 실행 클라이언트 연결하기](/developers/docs/networking-layer/#connecting-clients)에 더 자세히 설명되어 있습니다.
5. 다른 노드들은 합의 계층의 가십 네트워크에서 새로운 비콘 블록을 받습니다. 그들은 이를 실행 클라이언트에 전달하여 거래가 로컬에서 다시 실행되어 제안된 상태 변경이 유효한지 확인합니다. 그러면 검증자 클라이언트는 해당 블록이 유효하고 체인 뷰에서 논리적인 다음 블록임을 증명합니다(이는 [포크 선택 규칙](/developers/docs/consensus-mechanisms/pos/#fork-choice)에 정의된 대로 증명 가중치가 가장 큰 체인 위에 구축됨을 의미합니다). 블록은 그것을 증명한 각 노드의 로컬 데이터베이스에 추가됩니다.
6. 거래는 두 개의 체크포인트 사이에 "초과 다수 연결"이 있는 체인의 일부가 되면 "최종 확정"된 것으로 간주할 수 있습니다. 체크포인트는 각 에포크의 시작 시점에 발생하며, 각 슬롯에서 일부 활성 검증자만 증명하지만 모든 활성 검증자가 각 에포크 전체에서 증명한다는 사실을 고려하기 위해 존재합니다. 따라서 '초과 다수 연결'은 에포크 간에만 입증될 수 있습니다 (이는 네트워크에 스테이킹된 전체 ETH의 66%가 두 체크포인트에 동의하는 경우입니다).

최종 확정성에 대한 자세한 내용은 아래에서 확인할 수 있습니다.

## 최종 승인 {#finality}

거래는 많은 양의 ETH가 소각되지 않으면 변경할 수 없는 블록의 일부일 때 분산 네트워크에서 "최종 확정성"을 가집니다. 지분 증명 이더리움에서 finality는 이른바 체크포인트 블록을 통해 관리된다. 각 에포크 epoch의 첫번째 블록이 체크포인트이다. 검증인들은 유효하다고 생각하는 체크포인트 쌍을 투표한다. 두 개의 체크포인트가 전체 스테이킹된 ETH의 최소 3분의 2를 나타내는 투표를 유치하면 체크포인트가 업그레이드됩니다. 둘 중 더 최근 것이 "justified" 된다. 그리고 둘 중 더 이전 것은 이미 justified 되었다고 볼 수 있는데 이는 이전 에포크에서 이미 타깃이었기 때문이다. 이제 "finalized"로 업그레이드 되었다. 체크포인트를 업그레이드하는 이 프로세스는 \*\*[Casper the Friendly Finality Gadget(Casper-FFG)](https://arxiv.org/pdf/1710.09437)\*\*에 의해 처리됩니다. Casper-FFG는 합의를 위한 블록 최종성 도구입니다. 블록이 한번 최종 확정되면, 과반수 스테이커의 슬래싱 없이는 되돌리거나 변경할 수 없으므로 경제적으로 불가능해집니다.

최종 확정된 블록을 되돌리기 위해 공격자는 총 스테이킹된 ETH의 최소 3분의 1을 잃는 것을 감수해야 합니다. 이에 대한 정확한 이유는 이 [이더리움 재단 블로그 게시물](https://blog.ethereum.org/2016/05/09/on-settlement-finality/)에 설명되어 있습니다. 최종 승인 여부는 3분의 2 이상이 요구 되므로 네트워크가 최종 승인에 도달하지 않게 하려면 전체 지분의 3분의 1을 투표하면 된다. 이에 대항하기 위한 메커니즘이 있습니다. 바로 [미활동 유출](https://eth2book.info/bellatrix/part2/incentives/inactivity)입니다. 이는 블록체인이 4 에폭 연속으로 최종 승인에 실패할 경우 작동한다. 비활성 유출은 과반수에 반대하는 투표를 하는 검증자들로부터 스테이킹된 ETH를 소진시켜 과반수가 3분의 2 과반수를 회복하고 체인을 최종 확정할 수 있도록 합니다.

## 암호경제학적 보안 {#crypto-economic-security}

검증자는 책임이 따른다. 검증자는 블록 검증과 제안에 참여하기 위한 충분한 장비와 연결성이 있어야 한다. 그 대가로 검증자는 ETH로 보상을 받으며 (그들의 스테이킹 잔액이 증가합니다). 한편 검증자로 참여하는 일은 일반 사용자들이 개인적인 이익을 위해 또는 악한 감정을 품고 네트워크를 공격할 수 있는 루트가 될 수도 있다. 이 문제를 방지하기 위해, 검증자는 호출되었을 때 참여하지 않으면 ETH 보상을 받지 못하고, 부정행위를 할 경우 기존 지분이 소멸될 수 있습니다. 두 가지 주요 부정행위는 단일 슬롯에서 여러 블록을 제안하는 것(동시제안)과 상반되는 증명 제출입니다.

잘못된 검증자가 동시에 많이 벌어질수록 ETH가 삭감되는 금액이 많아집니다. 이는 ["상관관계 페널티"](https://eth2book.info/bellatrix/part2/incentives/slashing#the-correlation-penalty)로 알려져 있으며, 단일 검증자가 단독으로 슬래싱되는 경우 약 1%의 지분으로 경미할 수도 있고, 검증자 지분의 100%가 소멸(대량 슬래싱 이벤트)될 수도 있습니다. 첫째 날은 최대 1 ETH 까지 벌금을 부과할 수 있으며, 18일 째 되는 날에는 상관 벌칙을 받게 되고, 끝으로 36일 째 되는 날에는 네트워크로부터 추방당하게 된다. 비록 네트워크에 있지만 투표를 제출하지 않기 때문에 매일 소량의 인증 벌칙 (attestation penalty) 가 부과된다. 따라서 부정 행위를 위해 여러 사람들끼리 협조하는 일이 매우 어렵게 된다.

## 포크 선택 {#fork-choice}

네트워크가 최상의 그리고 부정 행위가 없는 상태라면 블록체인의 최상단에는 단일의 블록이 있으며 모든 검증자들은 이를 검증한다. 그러나 검증자는 네트워크 속도라든지 거짓 블록 제안 등의 사유로 인해 체인의 최상단이 서로 다른 모습일 수 있다.   따라서 합의 클라이언트는 그들 중 어떤 것을 선택해야 하는지 알기 위해 일종의 알고리즘이 필요하다. 지분 증명 이더리움에 사용되는 알고리즘은 [LMD-GHOST](https://arxiv.org/pdf/2003.03052.pdf)라고 하며, 기록상 증명 가중치가 가장 큰 포크를 식별하는 방식으로 작동합니다.

## 지분 증명과 보안 {#pos-and-security}

[51% 공격](https://www.investopedia.com/terms/1/51-attack.asp)의 위협은 작업 증명과 마찬가지로 지분 증명에도 여전히 존재하지만, 공격자에게는 훨씬 더 위험합니다. 공격자는 스테이킹된 ETH의 51%가 필요합니다. 이렇게 51% 이상 지분이 있어야만 공격을 위해 원하는 포크를 선정할 수 있다. 합의 클라이언트는 누적 증명의 가중치를 이용하여 올바른 체인을 알 수 있으며, 해당 공격자는 포크를 인정된 것으로 만들 수 있다. 하지만 proof-of-stake가 proof-of-work를 넘어서게 되면서 커뮤니티는 더 쉽게 반격할 수 있게 되었다.  예컨대 진정한 검증자는 소수 체인을 진흥시키고 공격자의 포크를 승인하지 않게 한다. 부정행위를 하는 자를 네트워크에서 강제로 추방시키고 이더 보유량을 회수할 수도 있다. 이런 부분들이 이른바 "51% 공격"에 대항하는 방어막이라고 볼 수 있다.

51% 공격 외에도 악의적인 행위자는 다음과 같은 다른 유형의 악의적인 활동을 시도할 수 있습니다:

- 장거리 공격(그러나 결말 장치는 이 공격 벡터를 무력화함)
- 단거리 '재조직' 공격(제안자 부스팅 및 증명 마감 기한이 이를 완화함)
- 반동 및 균형 공격(제안자 부스팅으로 완화되며, 이러한 공격은 이상적인 네트워크 조건에서만 시연됨)
- 눈사태 공격(포크 선택 알고리즘 규칙에 의해 무력화되며 최신 메시지만 고려)

결론적으로 지분 증명 방식은 PoW 방식 보다 더 안전하다.

## 장단점 {#pros-and-cons}

| 장점                                                                                                                                                                                                                                                                         | 단점                                                                  |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- |
| 스테이킹(staking)은 참가자들로 하여금 네트워크를 더 안전하게 해주며 이는 탈중앙화에 도움을 준다.  검증자 노드는 일반 노트북에서도 실행 가능하다. 스테이킹 풀(staking pool)은 일반 유저들이 32 ETH 씩이나 보유하지 않아도 지분(stake)를 가질 수 있도록 해준다. | 지분 증명 방식은 PoW방식보다 비교적 최신 방식이므로 실전 테스트가 덜 되어있을 수 있다. |
| 스테이킹은 더 탈중앙화 되어 있다. PoW 마이닝에서 만큼의 시너지(규모의 경제)를 발휘하지 않는다.                                                                                                                                                                | 지분 증명은 PoW 방식보다 요건이 더 까다롭다.                         |
| 지분 증명 방식은 PoW 방식보다 암호화폐 경제적으로 더 안전하다.                                                                                                                                                                                                                      | 이더리움 지분 증명 방식에 참여하기 위해서는 3개의 소프트웨어를 실행하여야 한다.       |
| 네트워크 참여자들에게 보상을 주기 위한 새로운 이더 발행량이 적다.                                                                                                                                                                                                                      |                                                                     |

### 작업 증명과의 비교 {#comparison-to-proof-of-work}

이더리움은 원래 작업 증명(Proof of Work)을 사용했으나 2022년 9월에 지분 증명(Proof of Stake)으로 전환했습니다. 지분 증명(PoS)은 작업 증명(PoW)에 비해 여러 가지 장점이 있습니다.

- 전력 소비 개선 - proof-of-work 식 연산에 필요한 전력 소비율보다 적은 전력이 필요하게 된다.
- 더 낮은 진입 장벽 및 장비 요건 - 블록 생성 기회를 얻기 위해 값비싼 장비를 구입하지 않아도 된다.
- 중앙화 리스크 개선 - 지분 증명 방식은 더 많은 노드가 참여하게 된다.
- 전력 소비가 줄어들기 때문에 사람들의 참여를 촉진하기 위해 비교적 적은 이더 발행이 요구된다.
- 악의적 행위에 대한 경제적 처벌은 작업 증명에 비해 공격자가 51% 공격을 더 비용이 많이 들게 만듭니다.
- 51% 공격이 암호-경제적 방어를 넘을 경우에도 커뮤니티는 정직한 체인의 사회적 회복을 이룰 수 있다.

## 더 읽어보기 {#further-reading}

- [지분 증명 FAQ](https://vitalik.eth.limo/general/2017/12/31/pos_faq.html) _비탈릭 부테린_
- [지분 증명이란 무엇인가](https://consensys.net/blog/blockchain-explained/what-is-proof-of-stake/) _ConsenSys_
- [지분 증명이란 무엇이며 왜 중요한가](https://bitcoinmagazine.com/culture/what-proof-of-stake-is-and-why-it-matters-1377531463) _비탈릭 부테린_
- [지분 증명이 필요한 이유(2020년 11월)](https://vitalik.eth.limo/general/2020/11/06/pos2020.html) _비탈릭 부테린_
- [지분 증명: 약한 주관성을 사랑하게 된 계기](https://blog.ethereum.org/2014/11/25/proof-stake-learned-love-weak-subjectivity/) _비탈릭 부테린_
- [지분 증명 이더리움 공격과 방어](https://mirror.xyz/jmcook.eth/YqHargbVWVNRQqQpVpzrqEQ8IqwNUJDIpwRP7SS5FXs)
- [지분 증명 설계 철학](https://medium.com/@VitalikButerin/a-proof-of-stake-design-philosophy-506585978d51) _비탈릭 부테린_
- [영상: 비탈릭 부테린이 렉스 프리드먼에게 설명하는 지분 증명](https://www.youtube.com/watch?v=3yrqBG-7EVE)

## 관련 주제 {#related-topics}

- [작업 증명](/developers/docs/consensus-mechanisms/pow/)
- [권위 증명](/developers/docs/consensus-mechanisms/poa/)
