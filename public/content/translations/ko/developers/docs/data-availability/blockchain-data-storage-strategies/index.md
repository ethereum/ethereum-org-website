---
title: 블록체인 데이터 저장 전략
description: 블록체인을 사용하여 데이터를 저장하는 방법에는 여러 가지가 있습니다. 이 글에서는 다양한 전략, 비용 및 장단점, 그리고 안전한 사용을 위한 요구 사항을 비교합니다.
lang: ko
---

블록체인에 직접 정보를 저장하거나 블록체인에 의해 보호되는 방식으로 정보를 저장하는 방법에는 여러 가지가 있습니다.

- EIP-4844 블롭
- 콜데이터
- L1 메커니즘을 사용한 오프체인
- 계약 "코드"
- 이벤트
- EVM 저장 공간

사용할 방법을 선택하는 기준은 다음과 같습니다.

- 정보의 출처. 콜데이터의 정보는 블록체인 자체에서 직접 가져올 수 없습니다.
- 정보의 목적지. 콜데이터는 이를 포함하는 트랜잭션에서만 사용할 수 있습니다. 이벤트는 온체인에서 전혀 접근할 수 없습니다.
- 어느 정도의 번거로움이 허용됩니까? 전체 노드를 실행하는 컴퓨터는 브라우저에서 실행되는 애플리케이션의 라이트 클라이언트보다 더 많은 처리를 수행할 수 있습니다.
- 모든 노드에서 정보에 쉽게 접근할 수 있도록 해야 합니까?
- 보안 요구 사항.

## 보안 요구 사항 {#security-requirements}

일반적으로 정보 보안은 세 가지 속성으로 구성됩니다.

- _기밀성_, 권한이 없는 주체는 정보를 읽을 수 없습니다. 이것은 많은 경우에 중요하지만 여기서는 그렇지 않습니다. _이더리움 상에 비공개 정보란 없습니다_. 블록체인은 누구나 상태 전환을 검증할 수 있기 때문에 작동하며, 따라서 비밀을 직접 저장하는 데 사용할 수 없습니다. 블록체인에 기밀 정보를 저장하는 방법이 있지만, 모두 키를 저장하기 위해 일부 오프체인 구성 요소에 의존합니다.

- _무결성_, 정보는 정확하며, 권한 없는 주체에 의해 또는 권한 없는 방식(예: 'Transfer' 이벤트 없이 [ERC-20 토큰](https://eips.ethereum.org/EIPS/eip-20#events) 전송)으로 변경될 수 없습니다. 블록체인에서는 모든 노드가 모든 상태 변경을 검증하여 무결성을 보장합니다.

- _가용성_, 정보는 모든 권한 있는 주체에게 제공됩니다. 블록체인에서는 일반적으로 모든 [전체 노드](https://ethereum.org/developers/docs/nodes-and-clients#full-node)에서 정보를 사용할 수 있도록 함으로써 이를 달성합니다.

여기에 있는 다양한 솔루션은 모두 L1에 해시가 게시되므로 뛰어난 무결성을 가집니다. 그러나 가용성 보장은 서로 다릅니다.

## 필수 구성 요소 {#prerequisites}

[블록체인 기초](/developers/docs/intro-to-ethereum/)에 대한 충분한 이해가 있어야 합니다. 또한 이 페이지는 독자가 [블록](/developers/docs/blocks/), [트랜잭션](/developers/docs/transactions/) 및 기타 관련 주제에 익숙하다고 가정합니다.

## EIP-4844 블롭 {#eip-4844-blobs}

[Dencun 하드포크](https://github.com/ethereum/consensus-specs/blob/dev/specs/deneb/beacon-chain.md)를 시작으로 이더리움 블록체인에는 제한된 수명(초기 약 [18일](https://github.com/ethereum/consensus-specs/blob/dev/specs/deneb/p2p-interface.md#configuration))을 가진 데이터 블롭을 이더리움에 추가하는 [EIP-4844](https://eips.ethereum.org/EIPS/eip-4844)가 포함됩니다. 이 블롭은 유사한 메커니즘을 사용하지만 [실행 가스](/developers/docs/gas)와는 별도로 가격이 책정됩니다. 임시 데이터를 게시하는 저렴한 방법입니다.

EIP-4844 블롭의 주요 사용 사례는 롤업이 트랜잭션을 게시하는 것입니다. [낙관적 롤업](/developers/docs/scaling/optimistic-rollups)은 블록체인에 트랜잭션을 게시해야 합니다. 이러한 트랜잭션은 롤업의 [시퀀서](https://docs.optimism.io/connect/resources/glossary#sequencer)가 잘못된 상태 루트를 게시할 경우 [검증자](https://docs.optimism.io/connect/resources/glossary#validator)가 실수를 수정할 수 있도록 [챌린지 기간](https://docs.optimism.io/connect/resources/glossary#challenge-period) 동안 누구나 사용할 수 있어야 합니다.

그러나 챌린지 기간이 지나고 상태 루트가 확정되면, 이러한 트랜잭션을 아는 것의 남은 목적은 체인의 현재 상태를 복제하는 것입니다. 이 상태는 체인 노드에서도 사용할 수 있으며, 처리 요구량이 훨씬 적습니다. 따라서 [블록 탐색기](/developers/docs/data-and-analytics/block-explorers)와 같은 몇 군데에는 트랜잭션 정보가 여전히 보존되어야 하지만, 이더리움이 제공하는 검열 저항성 수준에 대한 비용을 지불할 필요는 없습니다.

[영지식 롤업](/developers/docs/scaling/zk-rollups/#data-availability)도 다른 노드가 기존 상태를 복제하고 유효성 증명을 검증할 수 있도록 트랜잭션 데이터를 게시하지만, 이 또한 단기적인 요구 사항입니다.

작성 시점에 EIP-4844에 게시하는 비용은 바이트당 1wei(10<sup>-18</sup> ETH)이며, 이는 블롭을 게시하는 트랜잭션을 포함한 모든 트랜잭션에 드는 [21,000 실행 가스](https://eth.blockscout.com/tx/0xf6cfaf0431c73dd1d96369a5e6707d64f463ccf477a4131265397f1d81466929?tab=index)와 비교하면 무시할 수 있는 수준입니다. 현재 EIP-4844 가격은 [blobscan.com](https://blobscan.com/blocks)에서 확인할 수 있습니다.

다음은 유명 롤업이 게시한 블롭을 볼 수 있는 주소입니다.

| 롤업                                   | 메일박스 주소                                                                                                                 |
| ------------------------------------ | ----------------------------------------------------------------------------------------------------------------------- |
| [Optimism](https://www.optimism.io/) | [`0xFF00000000000000000000000000000000000010`](https://blobscan.com/address/0xFF00000000000000000000000000000000000010) |
| [Arbitrum](https://arbitrum.io/)     | [`0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6`](https://blobscan.com/address/0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6) |
| [Base](https://base.org/)            | [`0xFF00000000000000000000000000000000008453`](https://blobscan.com/address/0xFF00000000000000000000000000000000008453) |

## 콜데이터 {#calldata}

콜데이터는 트랜잭션의 일부로 전송되는 바이트를 의미합니다. 이는 해당 트랜잭션을 포함하는 블록의 블록체인 영구 기록의 일부로 저장됩니다.

이는 블록체인에 데이터를 영구적으로 저장하는 가장 저렴한 방법입니다. 바이트당 비용은 4 실행 가스(바이트가 0인 경우) 또는 16 가스(다른 값인 경우)입니다. 데이터가 압축되는 것이 일반적인 관행이라면 모든 바이트 값의 가능성이 동일하므로 평균 비용은 바이트당 약 15.95 가스입니다.

작성 시점에서 가격은 12 gwei/가스 및 2300 $/ETH이며, 이는 킬로바이트당 약 45센트의 비용을 의미합니다. 이것이 EIP-4844 이전의 가장 저렴한 방법이었기 때문에, 롤업이 [오류 증명](https://docs.optimism.io/stack/protocol/overview#fault-proofs)을 위해 사용 가능한 트랜잭션 정보를 저장하는 데 사용한 방법이지만 온체인에서 직접 액세스할 필요는 없습니다.

다음은 유명 롤업이 게시한 트랜잭션을 볼 수 있는 주소입니다.

| 롤업                                   | 메일박스 주소                                                                                                                       |
| ------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------- |
| [Optimism](https://www.optimism.io/) | [`0xFF00000000000000000000000000000000000010`](https://eth.blockscout.com/address/0xFF00000000000000000000000000000000000010) |
| [Arbitrum](https://arbitrum.io/)     | [`0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6`](https://eth.blockscout.com/address/0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6) |
| [Base](https://base.org/)            | [`0xFF00000000000000000000000000000000008453`](https://eth.blockscout.com/address/0xFF00000000000000000000000000000000008453) |

## L1 메커니즘을 사용한 오프체인 {#offchain-with-l1-mechs}

보안 장단점에 따라 정보를 다른 곳에 두고 필요할 때 데이터를 사용할 수 있도록 보장하는 메커니즘을 사용하는 것이 허용될 수 있습니다. 이것이 작동하기 위한 두 가지 요구 사항이 있습니다.

1. 블록체인에 데이터의 [해시](https://en.wikipedia.org/wiki/Cryptographic_hash_function)를 게시하는 것을 _입력 약정_이라고 합니다. 이것은 단일 32바이트 단어일 수 있으므로 비싸지 않습니다. 입력 약정이 사용 가능한 한, 동일한 값으로 해시되는 다른 데이터를 찾는 것이 불가능하므로 무결성이 보장됩니다. 따라서 잘못된 데이터가 제공되면 감지할 수 있습니다.

2. 가용성을 보장하는 메커니즘을 갖추십시오. 예를 들어, [Redstone](https://redstone.xyz/docs/what-is-redstone)에서는 모든 노드가 가용성 챌린지를 제출할 수 있습니다. 시퀀서가 마감일까지 온체인에서 응답하지 않으면 입력 약정은 폐기되므로 정보는 게시되지 않은 것으로 간주됩니다.

상태 루트에 대해 최소 한 명의 정직한 검증자가 있다는 점에 이미 의존하고 있으므로 이는 낙관적 롤업에 허용됩니다. 이러한 정직한 검증자는 또한 블록을 처리할 데이터를 가지고 있는지 확인하고, 정보가 오프체인에서 사용 불가능한 경우 가용성 챌린지를 발행합니다. 이러한 유형의 낙관적 롤업은 [플라즈마](/developers/docs/scaling/plasma/)라고 합니다.

## 계약 코드 {#contract-code}

한 번만 작성하고 덮어쓰지 않으며 온체인에서 사용 가능해야 하는 정보는 계약 코드로 저장할 수 있습니다. 이는 데이터로 "스마트 계약"을 만들고 [`EXTCODECOPY`](https://www.evm.codes/#3c?fork=shanghai)를 사용하여 정보를 읽는 것을 의미합니다. 장점은 코드 복사 비용이 상대적으로 저렴하다는 것입니다.

메모리 확장 비용 외에, `EXTCODECOPY`는 계약에 처음 액세스할 때(즉 "콜드" 상태일 때) 2,600 가스, 동일한 계약에서 후속 복사 시 100 가스, 그리고 32바이트 단어당 3 가스가 추가로 듭니다. 바이트당 15.95 가스가 드는 콜데이터와 비교할 때, 이는 약 200바이트부터 더 저렴합니다. [메모리 확장 비용 공식](https://www.evm.codes/about#memoryexpansion)에 따르면, 4MB 이상의 메모리가 필요하지 않는 한, 메모리 확장 비용은 콜데이터를 추가하는 비용보다 적습니다.

물론 이것은 데이터를 _읽는_ 비용일 뿐입니다. 계약을 생성하는 데에는 약 32,000 가스 + 200 가스/바이트가 듭니다. 이 방법은 동일한 정보를 여러 다른 트랜잭션에서 여러 번 읽어야 할 때만 경제적입니다.

`0xEF`로 시작하지 않는 한 계약 코드는 의미가 없을 수 있습니다. `0xEF`로 시작하는 계약은 훨씬 더 엄격한 요구 사항을 가진 [이더리움 객체 형식](https://notes.ethereum.org/@ipsilon/evm-object-format-overview)으로 해석됩니다.

## 이벤트 {#events}

[이벤트](https://docs.alchemy.com/docs/solidity-events)는 스마트 계약에서 방출되며 오프체인 소프트웨어에 의해 읽힙니다.
장점은 오프체인 코드가 이벤트를 수신할 수 있다는 것입니다. 비용은 [가스](https://www.evm.codes/#a0?fork=cancun)이며, 375에 데이터 바이트당 8 가스가 추가됩니다. 12 gwei/가스 및 2300 $/ETH에서, 이는 1센트에 킬로바이트당 22센트를 더한 값으로 환산됩니다.

## 저장 공간 {#storage}

스마트 계약은 [영구 저장 공간](https://docs.alchemy.com/docs/smart-contract-storage-layout#what-is-storage-memory)에 접근할 수 있습니다. 그러나 매우 비쌉니다. 이전에 비어 있던 저장 슬롯에 32바이트 단어를 쓰는 데 [22,100 가스가 들 수 있습니다](https://www.evm.codes/#55?fork=cancun). 12 gwei/가스 및 2300 $/ETH에서, 이는 쓰기 작업당 약 61센트, 또는 킬로바이트당 19.5달러입니다.

이것은 이더리움에서 가장 비싼 형태의 저장 공간입니다.

## 요약 {#summary}

이 표는 다양한 옵션, 장점 및 단점을 요약합니다.

| 저장 유형             | 데이터 소스      | 가용성 보장                                                                                                            | 온체인 가용성                          | 추가 제한 사항                         |
| ----------------- | ----------- | ----------------------------------------------------------------------------------------------------------------- | -------------------------------- | -------------------------------- |
| EIP-4844 블롭       | 오프체인        | [약 18일](https://github.com/ethereum/consensus-specs/blob/dev/specs/deneb/p2p-interface.md#configuration)간 이더리움 보장 | 해시만 사용 가능                        |                                  |
| 콜데이터              | 오프체인        | 이더리움 영구 보장(블록체인의 일부)                                                                           | 계약에 기록된 경우, 그리고 해당 트랜잭션에서만 사용 가능 |                                  |
| L1 메커니즘을 사용한 오프체인 | 오프체인        | 챌린지 기간 동안 "정직한 검증자 한 명" 보장                                                                                        | 해시만                              | 챌린지 기간 동안에만 챌린지 메커니즘에 의해 보장됨     |
| 계약 코드             | 온체인 또는 오프체인 | 이더리움 영구 보장(블록체인의 일부)                                                                           | 네                                | "임의의" 주소에 기록되며, `0xEF`로 시작할 수 없음 |
| 이벤트               | 온체인         | 이더리움 영구 보장(블록체인의 일부)                                                                           | 아니오                              |                                  |
| 스토리지              | 온체인         | 이더리움 영구 보장(블록체인의 일부이며 덮어쓸 때까지 현재 상태 유지)                                                        | 네                                |                                  |
