---
title: "EIP-1271: ஸ்மார்ட் ஒப்பந்த கையொப்பங்களில் கையொப்பமிடுதல் மற்றும் சரிபார்த்தல்"
description: EIP-1271 உடன் ஸ்மார்ட் ஒப்பந்த கையொப்ப உருவாக்கம் மற்றும் சரிபார்ப்பு பற்றிய ஒரு மேலோட்டம். ஸ்மார்ட் ஒப்பந்த உருவாக்குநர்கள் (டெவலப்பர்கள்) உருவாக்கிக்கொள்ள ஒரு உறுதியான உதாரணத்தை வழங்க Safe-இல் (முன்னர் Gnosis Safe) பயன்படுத்தப்படும் EIP-1271 செயலாக்கத்தையும் நாங்கள் விளக்குகிறோம்.
author: Nathan H. Leung
lang: ta
tags:
  [
    "eip-1271",
    "ஸ்மார்ட் ஒப்பந்தங்கள்",
    "சரிபார்த்தல்",
    "கையொப்பமிடுதல்"
  ]
skill: intermediate
published: 2023-01-12
---

[EIP-1271](https://eips.ethereum.org/EIPS/eip-1271) தரநிலையானது ஸ்மார்ட் ஒப்பந்தங்கள் கையொப்பங்களைச் சரிபார்க்க அனுமதிக்கிறது.

இந்த வழிகாட்டியில், டிஜிட்டல் கையொப்பங்கள், EIP-1271-இன் பின்னணி மற்றும் [Safe](https://safe.global/) (முன்னர் Gnosis Safe) பயன்படுத்தும் EIP-1271-இன் குறிப்பிட்ட செயலாக்கம் ஆகியவற்றின் மேலோட்டத்தை நாங்கள் வழங்குகிறோம். அனைத்தும் சேர்ந்து, இது உங்கள் சொந்த ஒப்பந்தங்களில் EIP-1271-ஐச் செயல்படுத்துவதற்கான ஒரு தொடக்கப் புள்ளியாக அமையும்.

## கையொப்பம் என்றால் என்ன?

இந்தச் சூழலில், ஒரு கையொப்பம் (இன்னும் துல்லியமாக, ஒரு “டிஜிட்டல் கையொப்பம்”) என்பது ஒரு செய்தி மற்றும் அந்தச் செய்தி ஒரு குறிப்பிட்ட நபர்/அனுப்புநர்/முகவரியிலிருந்து வந்தது என்பதற்கான ஒருவிதமான ஆதாரமும் ஆகும்.

உதாரணமாக, ஒரு டிஜிட்டல் கையொப்பம் இப்படி இருக்கலாம்:

1. செய்தி: “எனது Ethereum பணப்பையைப் பயன்படுத்தி இந்த இணையதளத்தில் உள்நுழைய விரும்புகிறேன்.”
2. கையொப்பமிடுபவர்: எனது முகவரி `0x000…`
3. ஆதாரம்: `0x000…` ஆன நான் தான் இந்த முழு செய்தியையும் உண்மையில் உருவாக்கினேன் என்பதற்கு இங்கே சில சான்றுகள் உள்ளன (இது பொதுவாக மறைகுறியீட்டு சம்பந்தப்பட்டது).

ஒரு டிஜிட்டல் கையொப்பத்தில் “செய்தி” மற்றும் “கையொப்பம்” ஆகிய இரண்டும் அடங்கும் என்பதைக் கவனத்தில் கொள்வது முக்கியம்.

ஏன்? உதாரணமாக, கையொப்பமிட ஒரு ஒப்பந்தத்தை நீங்கள் என்னிடம் கொடுத்தால், பிறகு நான் கையொப்பப் பக்கத்தை வெட்டிவிட்டு, ஒப்பந்தத்தின் மீதிப் பகுதி இல்லாமல் எனது கையொப்பங்களை மட்டும் உங்களிடம் திருப்பிக் கொடுத்தால், அந்த ஒப்பந்தம் செல்லுபடியாகாது.

அதே வழியில், அதனுடன் தொடர்புடைய செய்தி இல்லாமல் ஒரு டிஜிட்டல் கையொப்பத்திற்கு எந்த அர்த்தமும் இல்லை!

## EIP-1271 ஏன் உள்ளது?

Ethereum-அடிப்படையிலான பிளாக்செயின்களில் பயன்படுத்த டிஜிட்டல் கையொப்பத்தை உருவாக்க, உங்களுக்குப் பொதுவாக வேறு யாருக்கும் தெரியாத ஒரு இரகசிய தனிப்பட்ட திறவுகோல் தேவை. இதுதான் உங்கள் கையொப்பத்தை உங்களுடையதாக ஆக்குகிறது (இரகசிய திறவுகோல் பற்றி அறியாமல் வேறு யாராலும் அதே கையொப்பத்தை உருவாக்க முடியாது).

உங்கள் Ethereum கணக்குடன் (அதாவது, உங்கள் வெளிப்புறத்திற்குச் சொந்தமான கணக்கு/EOA) ஒரு தனிப்பட்ட திறவுகோல் இணைக்கப்பட்டுள்ளது, மேலும் ஒரு இணையதளம் அல்லது dapp உங்களிடம் கையொப்பம் கேட்கும்போது (எ.கா., “Ethereum உடன் உள்நுழைய”) இது பொதுவாகப் பயன்படுத்தப்படும் தனிப்பட்ட திறவுகோல் ஆகும்.

ethers.js போன்ற ஒரு மூன்றாம் தரப்பு நூலகத்தைப் பயன்படுத்தி நீங்கள் உருவாக்கும் [கையொப்பத்தை ஒரு செயலி சரிபார்க்கலாம்](https://www.alchemy.com/docs/how-to-verify-a-message-signature-on-ethereum), [உங்கள் தனிப்பட்ட திறவுகோலை அறியாமலேயே](https://en.wikipedia.org/wiki/Public-key_cryptography) அதைச் செய்யலாம். மேலும் கையொப்பத்தை உருவாக்கியது _நீங்கள்தான்_ என்பதில் நம்பிக்கையுடன் இருக்கலாம்.

> உண்மையில், EOA டிஜிட்டல் கையொப்பங்கள் பொது-திறவுகோல் மறைகுறியீட்டைப் பயன்படுத்துவதால், அவற்றை **offchain**-இல் உருவாக்கிச் சரிபார்க்கலாம்! வாயுவற்ற DAO வாக்களிப்பு இப்படித்தான் செயல்படுகிறது — onchain-இல் வாக்குகளைச் சமர்ப்பிப்பதற்குப் பதிலாக, டிஜிட்டல் கையொப்பங்களை மறைகுறியீட்டு நூலகங்களைப் பயன்படுத்தி offchain-இல் உருவாக்கி சரிபார்க்கலாம்.

EOA கணக்குகளுக்கு ஒரு தனிப்பட்ட திறவுகோல் இருந்தாலும், ஸ்மார்ட் ஒப்பந்தக் கணக்குகளுக்கு எந்தவிதமான தனிப்பட்ட அல்லது இரகசிய திறவுகோலும் இல்லை (எனவே "Ethereum உடன் உள்நுழைக" போன்றவை இயல்பாக ஸ்மார்ட் ஒப்பந்தக் கணக்குகளுடன் வேலை செய்யாது).

EIP-1271 தீர்க்க முனையும் சிக்கல் இதுதான்: ஸ்மார்ட் ஒப்பந்தத்தில் கையொப்பத்தில் இணைக்கக்கூடிய “இரகசியம்” எதுவும் இல்லை என்றால், ஒரு ஸ்மார்ட் ஒப்பந்தக் கையொப்பம் செல்லுபடியாகும் என்று எப்படிச் சொல்வது?

## EIP-1271 எப்படி வேலை செய்கிறது?

செய்திகளில் கையொப்பமிடப் பயன்படுத்தக்கூடிய தனிப்பட்ட திறவுகோல்கள் ஸ்மார்ட் ஒப்பந்தங்களுக்கு இல்லை. எனவே ஒரு கையொப்பம் உண்மையானதுதானா என்று நாம் எப்படிச் சொல்வது?

சரி, ஒரு கையொப்பம் உண்மையானதா என்று ஸ்மார்ட் ஒப்பந்தத்திடமே நாம் _கேட்கலாம்_ என்பது ஒரு யோசனை!

EIP-1271 செய்வது என்னவென்றால், கொடுக்கப்பட்ட கையொப்பம் செல்லுபடியாகுமா என்று ஒரு ஸ்மார்ட் ஒப்பந்தத்திடம் “கேட்கும்” இந்த யோசனையை அது தரப்படுத்துகிறது.

EIP-1271-ஐச் செயல்படுத்தும் ஒரு ஒப்பந்தத்தில், ஒரு செய்தி மற்றும் ஒரு கையொப்பத்தை உள்ளீடாக எடுத்துக்கொள்ளும் `isValidSignature` என்ற செயல்பாடு இருக்க வேண்டும். பின்னர் ஒப்பந்தம் சில சரிபார்ப்பு தர்க்கத்தை இயக்கலாம் (விவரக்குறிப்பு இங்கே எதையும் குறிப்பாக அமல்படுத்தவில்லை), பின்னர் கையொப்பம் செல்லுபடியாகுமா இல்லையா என்பதைக் குறிக்கும் மதிப்பைத் திருப்பியளிக்கலாம்.

`isValidSignature` ஒரு செல்லுபடியாகும் முடிவைத் திருப்பியளித்தால், அது ஏறக்குறைய ஒப்பந்தம் “ஆம், நான் இந்தக் கையொப்பம் + செய்தியை அங்கீகரிக்கிறேன்!” என்று சொல்வது போலாகும்.

### இடைமுகம்

EIP-1271 விவரக்குறிப்பில் உள்ள சரியான இடைமுகம் இதோ (நாம் கீழே `_hash` அளவுருவைப் பற்றி பேசுவோம், ஆனால் இப்போதைக்கு, அதை சரிபார்க்கப்படும் செய்தி என்று நினைத்துக் கொள்ளுங்கள்):

```jsx
pragma solidity ^0.5.0;

contract ERC1271 {

  // பைட்டுகள்4(keccak256("isValidSignature(bytes32,bytes)")
  bytes4 constant internal MAGICVALUE = 0x1626ba7e;

  /**
   * @dev வழங்கப்பட்ட துண்டிக்கு வழங்கப்பட்ட கையொப்பம் செல்லுபடியாகுமா என்பதைத் திருப்பியளிக்க வேண்டும்
   * @param _hash      கையொப்பமிடப்பட வேண்டிய தரவின் துண்டி
   * @param _signature _hash உடன் தொடர்புடைய கையொப்ப பைட் வரிசை
   *
   * செயல்பாடு நிறைவேறும்போது bytes4 மேஜிக் மதிப்பு 0x1626ba7e-ஐத் திருப்பியளிக்க வேண்டும்.
   * நிலையை மாற்றக்கூடாது (solc < 0.5-க்கு STATICCALL-ஐப் பயன்படுத்துதல், solc > 0.5-க்கு view மாற்றியமைப்பியைப் பயன்படுத்துதல்)
   * வெளிப்புற அழைப்புகளை அனுமதிக்க வேண்டும்
   */
  function isValidSignature(
    bytes32 _hash,
    bytes memory _signature)
    public
    view
    returns (bytes4 magicValue);
}
```

## எடுத்துக்காட்டு EIP-1271 செயலாக்கம்: Safe

ஒப்பந்தங்கள் `isValidSignature`-ஐ பல வழிகளில் செயல்படுத்தலாம் — விவரக்குறிப்பு சரியான செயலாக்கத்தைப் பற்றி அதிகம் கூறவில்லை.

EIP-1271-ஐச் செயல்படுத்தும் ஒரு குறிப்பிடத்தக்க ஒப்பந்தம் Safe (முன்னர் Gnosis Safe) ஆகும்.

Safe-இன் குறியீட்டில், `isValidSignature` [செயல்படுத்தப்பட்டுள்ளது](https://github.com/safe-global/safe-contracts/blob/main/contracts/handler/CompatibilityFallbackHandler.sol), இதனால் கையொப்பங்களை [இரண்டு வழிகளில்](https://ethereum.stackexchange.com/questions/122635/signing-messages-as-a-gnosis-safe-eip1271-support) உருவாக்கிச் சரிபார்க்க முடியும்:

1. Onchain செய்திகள்
   1. உருவாக்கம்: ஒரு safe உரிமையாளர் ஒரு செய்தியில் “கையொப்பமிட” ஒரு புதிய safe பரிவர்த்தனையை உருவாக்குகிறார், அந்தச் செய்தியை தரவுகளாக பரிவர்த்தனைக்குள் அனுப்புகிறார். multisig வரம்பை அடைய போதுமான உரிமையாளர்கள் பரிவர்த்தனையில் கையெழுத்திட்டவுடன், பரிவர்த்தனை ஒளிபரப்பப்பட்டு இயக்கப்படுகிறது. பரிவர்த்தனையில், (`signMessage(bytes calldata _data)`) எனப்படும் ஒரு safe செயல்பாடு உள்ளது, இது அந்தச் செய்தியை “அங்கீகரிக்கப்பட்ட” செய்திகளின் பட்டியலில் சேர்க்கிறது.
   2. சரிபார்ப்பு: Safe ஒப்பந்தத்தில் `isValidSignature`-ஐ அழைக்கவும், சரிபார்க்க வேண்டிய செய்தியை செய்தி அளவுருவாகவும் மற்றும் [கையொப்ப அளவுருவுக்கு ஒரு காலி மதிப்பையும்](https://github.com/safe-global/safe-contracts/blob/main/contracts/handler/CompatibilityFallbackHandler.sol#L32) (அதாவது `0x`) அனுப்பவும். கையொப்ப அளவுரு காலியாக இருப்பதை Safe பார்க்கும், மேலும் கையொப்பத்தை மறைகுறியீட்டு முறையில் சரிபார்ப்பதற்குப் பதிலாக, அந்தச் செய்தி “அங்கீகரிக்கப்பட்ட” செய்திகளின் பட்டியலில் உள்ளதா என்பதைச் சரிபார்க்க வேண்டும் என்பதை அது அறிந்துகொள்ளும்.
2. Offchain செய்திகள்:
   1. உருவாக்கம்: ஒரு safe உரிமையாளர் offchain-இல் ஒரு செய்தியை உருவாக்குகிறார், பின்னர் multisig ஒப்புதல் வரம்பை மீறும் அளவுக்கு போதுமான கையொப்பங்கள் கிடைக்கும் வரை மற்ற safe உரிமையாளர்களை தனித்தனியாக செய்தியில் கையொப்பமிட வைக்கிறார்.
   2. சரிபார்ப்பு: `isValidSignature`-ஐ அழைக்கவும். செய்தி அளவுருவில், சரிபார்க்கப்பட வேண்டிய செய்தியை அனுப்பவும். கையொப்ப அளவுருவில், ஒவ்வொரு safe உரிமையாளரின் தனிப்பட்ட கையொப்பங்களையும் ஒன்றன்பின் ஒன்றாக இணைத்து அனுப்பவும். வரம்பை எட்டுவதற்கு போதுமான கையொப்பங்கள் உள்ளனவா என்பதையும் **மற்றும்** ஒவ்வொரு கையொப்பமும் செல்லுபடியாகுமா என்பதையும் Safe சரிபார்க்கும். அப்படியானால், வெற்றிகரமான கையொப்ப சரிபார்ப்பைக் குறிக்கும் ஒரு மதிப்பை அது திருப்பி அனுப்பும்.

## `_hash` அளவுரு என்பது சரியாக என்ன? முழு செய்தியையும் ஏன் அனுப்பக்கூடாது?

[EIP-1271 இடைமுகத்தில்](https://eips.ethereum.org/EIPS/eip-1271) உள்ள `isValidSignature` செயல்பாடு, செய்தியை நேரடியாக எடுத்துக்கொள்ளாமல், அதற்குப் பதிலாக ஒரு `_hash` அளவுருவை எடுத்துக்கொள்கிறது என்பதை நீங்கள் கவனித்திருக்கலாம். இதன் பொருள் என்னவென்றால், `isValidSignature`-க்கு முழு தன்னிச்சையான நீளமுள்ள செய்தியை அனுப்புவதற்குப் பதிலாக, நாம் அதற்குப் பதிலாக செய்தியின் 32-பைட் துண்டியை (பொதுவாக keccak256) அனுப்புகிறோம்.

calldata-வின் ஒவ்வொரு பைட்டும் — அதாவது, ஒரு ஸ்மார்ட் ஒப்பந்தச் செயல்பாட்டிற்கு அனுப்பப்படும் செயல்பாட்டு அளவுரு தரவு — [16 gas செலவாகும் (பூஜ்ய பைட்டாக இருந்தால் 4 gas)](https://eips.ethereum.org/EIPS/eip-2028), எனவே ஒரு செய்தி நீளமாக இருந்தால் இது நிறைய gas-ஐச் சேமிக்க முடியும்.

### முந்தைய EIP-1271 விவரக்குறிப்புகள்

பயன்பாட்டில் `bytes` வகை முதல் அளவுருவுடன் (நிலையான நீளமுள்ள `bytes32`-க்கு பதிலாக தன்னிச்சையான நீளம்) மற்றும் `message` என்ற அளவுரு பெயரைக் கொண்ட `isValidSignature` செயல்பாட்டுடன் கூடிய EIP-1271 விவரக்குறிப்புகள் உள்ளன. இது EIP-1271 தரநிலையின் ஒரு [பழைய பதிப்பு](https://github.com/safe-global/safe-contracts/issues/391#issuecomment-1075427206) ஆகும்.

## எனது சொந்த ஒப்பந்தங்களில் EIP-1271 எவ்வாறு செயல்படுத்தப்பட வேண்டும்?

விவரக்குறிப்பு இங்கே மிகவும் பரந்ததாக உள்ளது. Safe செயலாக்கத்தில் சில நல்ல யோசனைகள் உள்ளன:

- ஒப்பந்தத்தின் "உரிமையாளரிடமிருந்து" வரும் EOA கையொப்பங்களைச் செல்லுபடியாகும் எனக் கருதலாம்.
- நீங்கள் அங்கீகரிக்கப்பட்ட செய்திகளின் பட்டியலைச் சேமித்து, அவற்றை மட்டுமே செல்லுபடியாகும் எனக் கருதலாம்.

இறுதியில், ஒப்பந்த உருவாக்குநராக (டெவலப்பராக) இது உங்களைப் பொறுத்தது!

## முடிவுரை

[EIP-1271](https://eips.ethereum.org/EIPS/eip-1271) என்பது ஸ்மார்ட் ஒப்பந்தங்கள் கையொப்பங்களைச் சரிபார்க்க அனுமதிக்கும் ஒரு பல்துறை தரநிலையாகும். இது ஸ்மார்ட் ஒப்பந்தங்கள் EOAs போல அதிகமாகச் செயல்பட வழிவகுக்கிறது — உதாரணமாக, "Ethereum உடன் உள்நுழைக" என்பது ஸ்மார்ட் ஒப்பந்தங்களுடன் வேலை செய்வதற்கான வழியை வழங்குகிறது — மேலும் இது பல வழிகளில் செயல்படுத்தப்படலாம் (Safe கருத்தில் கொள்ள ஒரு அற்பமற்ற, சுவாரஸ்யமான செயலாக்கத்தைக் கொண்டுள்ளது).
