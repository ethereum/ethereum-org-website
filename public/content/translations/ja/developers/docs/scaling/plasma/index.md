---
title: "プラズマチェーン"
description: "現在、イーサリアムコミュニティで活用されているスケーリング・ソリューションとしてのプラズマチェーンを紹介する。"
lang: ja
incomplete: true
sidebarDepth: 3
---

プラズマチェーンとは、イーサリアムメインネットに固定されているものの、独自のメカニズムに基づいてブロックを検証し、オフチェーンでトランザクションを実行するメインネットとは別個のブロックチェーンです。 ブラズマチェーンは「子チェーン」と呼ばれる場合もあり、基本的にはイーサリアムメインネットの小規模なコピーだと言えるでしょう。 プラズマチェーンは、([オプティミスティック・ロールアップ](/developers/docs/scaling/optimistic-rollups/)のように) [不正証明](/glossary/#fraud-proof)を使用して紛争を仲裁します。

マークルツリーは、 (イーサリアムメインネットを含む) 親チェーンから帯域幅をオフロードするために、これらの子チェーンを無限にスタックすることができるものです。 しかし、これらの子チェーンは、セキュリティの一部を（不正証明を通じて）イーサリアムが保証するため、子チェーンにおけるセキュリティおよび効率性はいくつかの設計上の制限により影響を受けます。

## 前提条件 {#prerequisites}

すべての基礎的なトピックを十分に理解し、[イーサリアムのスケーリング](/developers/docs/scaling/)の概要を理解している必要があります。

## プラズマチェーンとは何か

プラズマチェーンは、イーサリアムをはじめとするパブリックブロックチェーンにおけるスケーラビリティを向上させるためのフレームワークです。 オリジナルの[プラズマのホワイトペーパー](http://plasma.io/plasma.pdf)で説明されているように、プラズマチェーンは別のブロックチェーン(「ルートチェーン」と呼ばれる)の上に構築されます。 これらの「子チェーン」はそれぞれ、ルートチェーンを拡張するものであり、一般的には親チェーン上でデプロイされたスマートコントラクトによって管理されます。

プラズマコントラクトは、とりわけ、ユーザーがイーサリアムメインネットとプラズマチェーンの間で資産を移動できるようにする[ブリッジ](/developers/docs/bridges/)として機能します。 この点では[サイドチェーン](/developers/docs/scaling/sidechains/)に似ていますが、プラズマチェーンは、少なくともある程度は、イーサリアムメインネットのセキュリティから恩恵を受けます。 一方サイドチェーンでは、セキュリティを単独で担う必要があります。

## プラズマはどのように機能するか？

プラズマフレームワークの基本的なコンポーネントには、以下が含まれます：

### オフチェーンでの計算 {#offchain-computation}

イーサリアムにおける現在の処理速度は、毎秒15〜20トランザクションが限界であり、短期的により多くのユーザーに対応するためのスケーラビリティが実現できる見通しは低いと言わざるを得ません。 この問題は主に、イーサリアムの[コンセンサス・メカニズム](/developers/docs/consensus-mechanisms/)が、ブロックチェーンの状態が更新されるたびに、多数のピアツーピア・ノードによる検証を必要とするために存在します。

イーサリアムのコンセンサス・メカニズムはセキュリティを維持する上で必要ですが、あらゆるユースケースで必須なわけではありません。 例えば、アリスがボブに対して毎日1杯のコーヒー代を支払うという取引の場合、二人の間には一定の信頼関係があるため、イーサリアムのネットワーク全体でこれを検証する必要はないでしょう。

プラズマでは、イーサリアムメインネットがすべてのトランザクションを検証する必要はないと前提します。 トランザクションをメインネット外で処理することで、ノードはすべてのトランザクションを検証する責任から解放されます。

プラズマチェーンでは、処理速度とコストを最適化するためにオフチェーンでの計算が必須になります。 例えば、大部分のプラズマチェーンでは、トランザクションの順位付けと実行を管理する役割を、1名の「オペレーター」に担わせています。 トランザクションを検証する役割を1つのエンティティのみに負わせることで、プラズマチェーンは処理時間をメインネットよりも短縮できるのです。

### 状態コミットメント {#state-commitments}

プラズマはオフチェーンでトランザクションを実行しますが、メインのイーサリアム実行レイヤーで決済されます。そうでなければ、プラズマチェーンはイーサリアムのセキュリティ保証から恩恵を受けることはできません。 しかし、プラズマチェーンの状態を把握せずにオフチェーンのトランザクションをファイナライズする場合は、このセキュリティモデルが破綻し、無効なトランザクションが横行してしまうでしょう。 このため、プラズマチェーンにおけるブロック生成の責任を負うエンティティであるオペレーターは、定期的に、イーサリアムに「状態コミットメント」を書き込む必要があります。

[コミットメント・スキーム](https://en.wikipedia.org/wiki/Commitment_scheme)とは、値やステートメントを相手に明かすことなく、それにコミットするための暗号技術です。 このようなコミットメントは、コミットした後は値やステートメントが改変できなくなるという意味で「拘束力」を持ちます。 プラズマにおける状態コミットメントは、「マークルルート」([マークルツリー](/whitepaper/#merkle-trees)から派生)の形式を取ります。このマークルルートは、オペレーターがイーサリアムチェーン上のプラズマコントラクトに定期的に送信します。

マークルルートとは、大容量の情報を圧縮することができる暗号プリミティブです。 マークルルート（この文脈では「ブロックルート」とも呼びます）は、ひとつのブロックに含まれるすべてのトランザクションを表すことができます。 また、マークルルートを用いることで、あるデータセットの小規模な一部分に基づき全体を簡単に検証することができます。 例えば、ユーザーは特定のブロックにトランザクションが含まれていることを証明するために、[マークル証明](/developers/tutorials/merkle-proofs-for-offline-data-integrity/#main-content)を作成できます。

マークルルートは、オフチェーンの状態についての情報をイーサリアムに提供する上で重要な役割を果たします。 マークルルートは、「特定の時点で保存したもの」と考えることができます。オペレーターは、「これがＸ時点におけるプラズマチェーンの状態であり、これがその証拠であるマークルルートです」とメインネットに伝えるのです。 オペレーターは、マークルルートでプラズマチェーンの_現在の状態_にコミットしています。これが「状態コミットメント」と呼ばれる理由です。

### エントリーとエグジット {#entries-and-exits}

イーサリアムのユーザーがプラズマを活用するには、メインネットとプラズマチェーン間の資金移動を管理するメカニズムが必要になります。 しかし、プラズマチェーン上の任意のアドレスにイーサを送金することはできません。プラズマチェーンは他のチェーンとの資金移動に対応していないため、トランザクションは失敗するか、資金が失われることになります。

プラズマチェーンでは、ユーザーの参入および退出を処理するために、イーサリアム上で実行されるマスターコントラクトを使用します。 このマスターコントラクトは同時に、（上述の）状態コミットメントを追跡し、不正証明（以下を参照）により悪意の行為を罰する役割も担っています。

#### プラズマチェーンへのエントリー {#entering-the-plasma-chain}

ユーザー（以下では、アリスと呼びます）がプラズマチェーンに参加するには、プラズマコントラクトにETHあるいはその他のERC-20トークンを入金する必要があります。 コントラクトへの入金を監視するプラズマのオペレーターは、アリスが初回に行った入金と同額を作成し、プラズマチェーン上のアリスのアドレスにリリースします。 アリスは、プラズマチェーン（子チェーン）上でこの資金を受け取ったことを確認することが義務付けられており、その上で、他のトランザクションでこの資金を使うことができます。

#### プラズマチェーンからのエグジット {#exiting-the-plasma-chain}

プラズマチェーンからの退出プロセスは、いくつかの理由により参加時よりも複雑です。 最大の理由は、イーサリアムは当該プラズマチェーンの状態について情報を持つものの、その情報が正しいかどうか検証できないためです。 つまり、悪意のユーザーは、正しくない主張（「私は1,000 ETHを所有している」）と述べて、この主張を裏付けるために虚偽の証明を提出することで詐欺を働くことができるのです。

このような悪意のユーザーによる資金の引き出しを防ぐために、「チャレンジ期間」という仕組みが導入されています。 チャレンジ期間（通常は1週間）においては、すべてのユーザーが出金リクエストに対して不正証明を用いて異議を申し立てることができます。 異議申立が認められれば、出金リクエストは却下されます。

しかし通常のケースでは、ユーザーは正直に行動し、自分が所有する資金について正しい主張を行います。 この場合、アリスは、プラズマコントラクトにトランザクションを送信することで、ルートチェーン（イーサリアム）に対する出金リクエストを開始します。

アリスは同時に、プラズマチェーン上で資金を作成するトランザクションが、特定のブロックに追加されていることを証明するマークル証明を提出しなければなりません。 これは、[未使用トランザクションアウトプット(UTXO)](https://en.wikipedia.org/wiki/Unspent_transaction_output)モデルを使用する[Plasma MVP](https://www.learnplasma.org/en/learn/mvp.html)のような、プラズマのイテレーションに必要です。

[Plasma Cash](https://www.learnplasma.org/en/learn/cash.html)のような他のものは、UTXOの代わりに[非代替性トークン](/developers/docs/standards/tokens/erc-721/)として資金を表します。 この場合、資金を引き出すには、プラズマチェーン上でトークンを所有していることを証明しなければなりません。 この証明は、当該トークンにおける最新の2回のトランザクションを送信し、同時にこれらのトランザクションがブロックに追加されたことを証明するマークル証明を提出することで行います。

ユーザーはさらに、自らの正直な行動を保証するために、出金リクエストにボンド（担保）を預け入れる必要があります。 異議申立を通じてアリスの出金リクエストが無効であることが証明された場合、アリスのボンドは没収され、その一部は異議申立を行ったユーザーに報酬として提供されます。

このチャレンジ期間において不正証明が提出されなかった場合、アリスの出金リクエストは正当だと見なされ、アリスはプラズマコントラクト上の資金をイーサリアムに移動することができます。

### 紛争の仲裁 {#dispute-arbitration}

あらゆるブロックチェーンと同様に、プラズマチェーンにおいても、参加ユーザーが悪意で行動した場合（資金の二重支出など）にトランザクションのインテグリティを強制するためのメカニズムが必要になります。 これを実現するために、プラズマチェーンでは不正証明を用いて、状態遷移の正しさに関する紛争を仲裁し、悪意の行動を罰しています。 不正証明は、あるプラズマ子チェーンが親チェーンまたはルートチェーンに対して苦情を申し立てるメカニズムとして用いられます。

不正証明とは、特定の状態遷移が無効であるとの主張を指す用語です。 具体的には、アリスというユーザーが同じ資金を二度使用した場合が該当します。 アリスが、ボブとのトランザクションで彼女のUTXOをすでに使用したにも関わらず、この（すでにボブが所有している）UTXOを、他のトランザクションでも使用しようとするような場合です。

ボブは、アリスによる資金の引き出しを防ぐために、アリスはすでに当該UTXOを以前のトランザクションで使用済みであることの証拠と、このトランザクションがブロックに追加済みであることを証明するマークル証明を提出することで、不正証明を作成することができます。 プラズマキャッシュでも同様のプロセスが実行され、ボブは、アリスが引き出そうとしているトークンはすでにボブに移転済みであることの証明を提供する必要があります。

ボブの異議申立が認められると、アリスの出金リクエストは却下されます。 しかしこのアプローチでは、ボブは常にチェーン上の出金リクエストを監視しなければなりません。 ボブがオフラインであれば、アリスはチャレンジ期間の終了後に悪意の引き出しを実行できてしまうのです。

## プラズマにおける集団エグジット問題 {#the-mass-exit-problem-in-plasma}

大量退出の問題とは、特定のプラズマチェーンから大量のユーザーが同時に出金しようとする際に発生する問題を指します。 この問題が存在する理由は、プラズマの最大の問題点の1つである**データの可用性がないこと**と関係があります。

データの可用性とは、提案されたブロックの情報が実際にブロックチェーンネットワークで公開されていることを検証する能力を指します。 ブロックの生成者が当該ブロック自体を公開しているが、ブロック生成に用いたデータを秘匿する場合、このブロックは「可用性がない」ことになります。

ノードがブロックをダウンロードし、トランザクションの有効性を検証するためには、ブロックの可用性が必須です。 ブロックチェーンは、ブロック生産者にすべてのトランザクションデータをオンチェーンに投稿させることで、データの可用性を確保します。

データの可用性は、イーサリアムのベースレイヤー上に構築されるオフチェーンのスケーリング・プロトコルのセキュリティ保護にも役立ちます。 オフチェーンのオペレーターに対してトランザクションデータをイーサリアム上で公開するように強制することで、どのユーザーも、チェーンの正しい状態を参照した不正証明を作成して無効なブロックに異議を申し立てることができるのです。

プラズマチェーンは、主にオペレーターがトランザクションデータを保存し、**メインネットには一切データを公開しません**(定期的な状態コミットメントは例外です)。 つまりユーザーは、トランザクションが無効であると主張するために不正証明を作成する必要がある場合、オペレーターが提供するブロックデータに依存せざるを得ません。 このシステムが正常に機能すれば、ユーザーは常に不正証明を用いて資金の安全性を維持できます。

しかし、単なるユーザーではなく、オペレーター自体が悪意の当事者である場合に問題が発生します。 オペレーターは、当該ブロックチェーンに対して単独で管理権を持つため、チェーン上の他のユーザーに帰属する資金を盗み取るなど、より大規模に無効な状態遷移を進めたいと考えるインセンティブがより大きくなるのです。

このようなケースでは、通常の不正証明システムでは対応できません。 オペレーターは、アリスやボブの資金を自らのウォレットに転送する無効のトランザクションを作成した上で、不正証明を作成するのに必要なデータを秘匿することが簡単にできるからです。 これは、オペレーターが他のユーザーやメインネットに対してデータを提供することが義務付けられていないために発生する問題です。

ですから、最も楽天的な解決策は、当該プラズマチェーンのユーザーを「大量退出」させることでしょう。 大量のユーザーを一挙に退出させることで、悪意のオペレーターにおける資金窃盗の試みを遅延させ、ユーザーに対する一定の保護策を講じることができます。 出金リクエストは、個々のUTXO（またはトークン）が作成された時点に基づいて順番付けられるため、悪意のオペレーターが正直なユーザーのトランザクションを先回りして実行することはできません。

それでもなお、無効な出金処理に伴う混乱に乗じて利益を得ようとする機会主義的なユーザーの発生を防ぐためには、大量退出時における出金リクエストについても検証できる方法が必要になります。 解決策はシンプルです。ユーザーが出金するには、チェーンの最後の**有効な状態**を投稿することを要求します。

このアプローチでも、すべて問題が解決されたわけではありません。 例えば、あるプラズマチェーンに参加している全ユーザーの退出が必要な場合（オペレーターが悪意の行為を行う場合は発生する可能性があります）、このプラズマチェーンの有効な状態全体を、イーサリアムのベースレイヤーに同時にダンプしなければなりません。 プラズマチェーンのサイズが任意であり（高スループット＝データ量が多い）、イーサリアムでは処理速度に限界があることを考えると、このソリューションは理想的ではありません。

この退出アプローチは理論的には妥当ですが、現実的にはイーサリアムのネットワーク全体における大渋滞を引き起こすでしょう。 イーサリアムの機能が損なわれるばかりか、大規模なユーザー退出がうまく連携されていない場合、各ユーザーが自らの資金を引き出す前に、オペレーターが当該プラズマチェーンのすべてのアカウントにおける残高を奪い取ってしまう可能性があります。

## プラズマの長所と短所 {#pros-and-cons-of-plasma}

| 長所                                                                                                             | 短所                                                                                                                  |
| -------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------- |
| 高スループットおよびトランザクションあたりの低コスト。                                                                                    | 汎用的な計算はサポートしていません(スマートコントラクトは実行できません)。 述語論理により、基本的なトークンの転送、スワップ、およびその他数種類のトランザクションタイプのみに対応しています。 |
| 任意のユーザー間の取引に適している（プラズマチェーン上で設定されたユーザーペア間においては、間接費用が発生しない）。                                                     | 資金の安全性を保護するには、ネットワークを定期的に監視する（ライブネス要件）か、この役割を特定のユーザーに委任する必要がある。                                                     |
| メインチェーンとは無関係の具体的なユースケースで活用するために導入できる。 企業を含むあらゆるユーザーが、プラズマ上のスマートコントラクトをカスタマイズすることで、様々な文脈に合わせたスケーラブルなインフラを実現できる。 | データの保存およびリクエストによる提供につき、1名あるいは複数のオペレーターに依存する。                                                                        |
| 計算およびストレージをオフチェーンに移動させることで、イーサリアムメインネットの負荷を軽減します。                                                              | チャレンジ期間が設けられているため、出金プロセスは数日を要する。 この遅延は、代替可能資産であれば流動性プロバイダーが軽減できるが、それに伴って資本コストが発生する。                                 |
|                                                                                                                | 大量のユーザーが一気に退出を求める場合、イーサリアムメインネットの混雑が予想される。                                                                          |

## プラズマとレイヤー2スケーリング・プロトコルの比較 {#plasma-vs-layer-2}

プラズマは、以前はイーサリアムに対する有益なスケーリングソリューションだと考えられていましたが、現在では[レイヤー2(L2)スケーリングプロトコル](/layer-2/)に取って代わられています。 L2のスケーリング・ソリューションは、プラズマチェーンにおけるいくつかの問題点を解消しています：

### 効率性 {#efficiency}

[ゼロ知識ロールアップ](/developers/docs/scaling/zk-rollups)は、オフチェーンで処理されたトランザクションの各バッチの有効性について、暗号学的証明を生成します。 これにより、ユーザー（およびオペレーター）が無効な状態遷移を進めることができなくなるため、チャレンジ期間や退出ゲームを実行する必要がなくなります。 さらにユーザーは、資金の安全性を保護するために定期的にチェーンを監視する必要がなくなります。

### スマートコントラクトのサポート {#support-for-smart-contracts}

プラズマフレームワークのもう一つの問題は、[イーサリアムのスマートコントラクトの実行をサポートできないこと](https://ethresear.ch/t/why-smart-contracts-are-not-feasible-on-plasma/2598/4)でした。 このため、大部分のプラズマの実装は、単純な決済システムやERC-20トークンのやりとりを目的とするものでした。

逆に、オプティミスティック・ロールアップは[イーサリアム仮想マシン](/developers/docs/evm/)と互換性があり、イーサリアムネイティブの[スマートコントラクト](/developers/docs/smart-contracts/)を実行できるため、[分散型アプリケーション](/developers/docs/dapps/)をスケーリングするための有用で_安全な_ソリューションとなります。 同様に、ZKロールアップが任意のロジックを処理し、スマートコントラクトを実行できるようにする[EVMのゼロ知識実装(zkEVM)を作成する](https://ethresear.ch/t/a-zk-evm-specification/11549)計画が進行中です。

### データの非可用性 {#data-unavailability}

すでに述べたように、プラズマチェーンではデータの可用性が提供されないという問題があります。 悪意のオペレーターがチェーン上で無効な状態遷移を進める場合、オペレーターは不正証明を作成するのに必要なデータを秘匿できるため、ユーザーが異議を申し立てることができなくなります。 ロールアップでは、オペレーターに対してトランザクションデータをイーサリアム上で公開するように強制することで、この問題を回避できます。これにより、どのユーザーでもチェーンの状態を検証し、必要に応じて不正証明を作成することが可能になります。

### 集団エグジット問題 {#mass-exit-problem}

プラズマチェーンにおける大量退出の問題に対しては、ゼロ知識ロールアップやオプティミスティック・ロールアップでは様々な解決策を提案しています。 ゼロ知識ロールアップの場合、いかなるシナリオでもオペレーターが他のユーザーの資金を窃盗できないことを保証するための暗号メカニズムを採用しています。

同様に、オプティミスティック・ロールアップでは、資金の引き出しに対して遅延期間を設けることで、どのユーザーでも異議を申し立てることができ、悪意の出金リクエストを実行できないようにしています。 これはプラズマチェーンにおける対策と似ていますが、オプティミスティック・ロールアップにおける検証者は、不正証明を作成するのに必要なデータにアクセスできる点が異なります。 これにより、ロールアップのユーザーの場合、ユーザーが混乱状態において先を競ってイーサリアムメインネットに逃げ出すというような状況が発生しないようになっています。

## サイドチェーンおよびシャーディングとの相違点 {#plasma-sidechains-sharding}

プラズマチェーン、サイドチェーン、およびシャーディングは、いずれも何らかの方法でイーサリアムメインネットに接続されており、かなりの程度類似した技術だと言えます。 しかし、メインネットとの接続の水準や強度は異なっているため、これらのスケーリング・ソリューションにおけるセキュリティ特性が異なります。

### プラズマとサイドチェーンの比較 {#plasma-vs-sidechains}

[サイドチェーン](/developers/docs/scaling/sidechains/)は、双方向のブリッジを介してイーサリアムメインネットに接続された、独立して運用されるブロックチェーンです。 [ブリッジ](/bridges/)は、ユーザーが2つのブロックチェーン間でトークンを交換してサイドチェーン上で取引できるようにすることで、イーサリアムメインネットの混雑を緩和し、スケーラビリティを向上させます。
サイドチェーンはメインネットとは別個のコンセンサス・メカニズムを採用しており、通常はメインネットよりもはるかに小規模なネットワークです。 このため、ブリッジを介してサイドチェーンに資産を転送できる状態はリスクを高めます。サイドチェーンに対しては、イーサリアムメインネットによるセキュリティの保証が提供されないため、サイドチェーンへの攻撃が発生した際には資産を喪失するリスクがあります。

一方プラズマチェーンでは、メインネットによりセキュリティが保証されます。 このため、サイドチェーンと比較した場合はセキュリティがはるかに堅牢であると言えます。 サイドチェーンとプラズマチェーンはいずれも様々なコンセンサス・プロトコルを採用できますが、プラズマチェーンの場合は、各ブロックに対するマークルルートがメインネット上で公開される点が異なります。 ブロックルートとは、プラズマチェーン上のトランザクションに関する情報を検証するために用いることができる、情報の一部分を指します。 プラズマチェーンへの攻撃が発生した場合、適切な証明を用いることで、資金を安全にメインネットに戻すことができます。

### プラズマとシャーディングの比較 {#plasma-vs-sharding}

プラズマチェーンとシャードチェーンは、どちらもイーサリアムメインネット上で定期的に暗号学的な証明を公開しています。 しかし、そのセキュリティ特性は異なります。

シャードチェーンの場合、各データシャードに関する詳細情報を含む「照合ヘッダー」をメインネット上でコミットします。 メインネット上の各ノードは、データシャードの有効性を検証した上で強制するため、無効なシャード遷移を防止でき、悪意の行為からネットワークを保護することができます。

一方プラズマチェーンでは、子チェーンの状態について最小限の情報しかメインネットに提供されない点が異なります。 つまり、メインネットでは子チェーンで実行されたトランザクションを事実上検証できないため、プラズマチェーンの方がセキュリティが低くなります。

**注**: イーサリアムブロックチェーンのシャーディングは、もはやロードマップにはありません。 これは、ロールアップと[Danksharding](/roadmap/danksharding)によるスケーリングに取って代わられました。

### Plasmaを使用する {#use-plasma}

複数のプロジェクトにおいて、Dappで活用できるプラズマの実装が提供されています。

- [Polygon](https://polygon.technology/) (旧Matic Network)

## 参考リンク {#further-reading}

- [プラズマを学ぶ](https://www.learnplasma.org/en/)
- [「共有セキュリティ」が何を意味し、なぜそれが非常に重要なのかについての簡単なリマインダー](https://old.reddit.com/r/ethereum/comments/sgd3zt/a_quick_reminder_of_what_shared_security_means/)
- [サイドチェーン、プラズマ、シャーディングの比較](https://vitalik.eth.limo/general/2019/06/12/plasma_vs_sharding.html)
- [プラズマを理解する、パート1: 基礎](https://www.theblockcrypto.com/amp/post/10793/understanding-plasma-part-1-the-basics)
- [プラズマの誕生と終焉](https://medium.com/dragonfly-research/the-life-and-death-of-plasma-b72c6a59c5ad#)

_役に立つコミュニティリソースを知っていますか? Edit this page and add it!_
