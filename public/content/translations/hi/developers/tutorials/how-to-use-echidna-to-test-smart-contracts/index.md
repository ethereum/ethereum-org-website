---
title: "рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдзреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ"
description: "рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдзреЛрдВ рдХрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ"
author: "Trailofbits"
lang: hi
tags:
  [
    "рд╕реЛрд▓рд┐рдбреАрдЯреА",
    "рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдз",
    "рд╕реБрд░рдХреНрд╖рд╛",
    "рдкрд░рд┐рдХреНрд╖рдг",
    "рдлрд╝рдЬрд╝рд┐рдВрдЧ"
  ]
skill: advanced
published: 2020-04-10
source: "рд╕реБрд░рдХреНрд╖рд┐рдд рдЕрдиреБрдмрдВрдз рдмрдирд╛рдирд╛"
sourceUrl: https://github.com/crytic/building-secure-contracts/tree/master/program-analysis/echidna
---

## рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди {#installation}

Echidna рдХреЛ рдбреЙрдХрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпрд╛ рдкреНрд░реА-рдХрдВрдкрд╛рдЗрд▓реНрдб рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рдбреЙрдХрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Echidna {#echidna-through-docker}

```bash
docker pull trailofbits/eth-security-toolbox
docker run -it -v "$PWD":/home/training trailofbits/eth-security-toolbox
```

_рдЕрдВрддрд┐рдо рдХрдорд╛рдВрдб рдЖрдкрдХреА рд╡рд░реНрддрдорд╛рди рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рддрдХ рдкрд╣реБрдВрдЪ рд╡рд╛рд▓реЗ рдбреЙрдХрд░ рдореЗрдВ eth-security-toolbox рдЪрд▓рд╛рддрд╛ рд╣реИред рдЖрдк рдЕрдкрдиреЗ рд╣реЛрд╕реНрдЯ рд╕реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдбреЙрдХрд░ рд╕реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рдЯреВрд▓ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ_

рдбреЙрдХрд░ рдХреЗ рдЕрдВрджрд░, рдЪрд▓рд╛рдПрдБ:

```bash
solc-select 0.5.11
cd /home/training
```

### рдмрд╛рдЗрдирд░реА {#binary}

[https://github.com/crytic/echidna/releases/tag/v1.4.0.0](https://github.com/crytic/echidna/releases/tag/v1.4.0.0)

## рдкреНрд░реЙрдкрд░реНрдЯреА-рдЖрдзрд╛рд░рд┐рдд рдлрд╝рдЬрд╝рд┐рдВрдЧ рдХрд╛ рдкрд░рд┐рдЪрдп {#introduction-to-property-based-fuzzing}

Echidna рдПрдХ рдкреНрд░реЙрдкрд░реНрдЯреА-рдЖрдзрд╛рд░рд┐рдд рдлрд╝рдЬрд╝рд░ рд╣реИ, рд╣рдордиреЗ рдЕрдкрдиреЗ рдкрд┐рдЫрд▓реЗ рдмреНрд▓реЙрдЧрдкреЛрд╕реНрдЯ рдореЗрдВ рдЗрд╕рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛ рд╣реИ ([1](https://blog.trailofbits.com/2018/03/09/echidna-a-smart-fuzzer-for-ethereum/), [2](https://blog.trailofbits.com/2018/05/03/state-machine-testing-with-echidna/), [3](https://blog.trailofbits.com/2020/03/30/an-echidna-for-all-seasons/))ред

### рдлрд╝рдЬрд╝рд┐рдВрдЧ {#fuzzing}

[рдлрд╝рдЬрд╝рд┐рдВрдЧ](https://wikipedia.org/wiki/Fuzzing) рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореБрджрд╛рдп рдореЗрдВ рдПрдХ рдЬрд╛рдиреА-рдорд╛рдиреА рддрдХрдиреАрдХ рд╣реИред рдЗрд╕рдореЗрдВ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЗрдВ рдмрдЧ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрдореЛрдмреЗрд╢ рд░реИрдВрдбрдо рдЗрдирдкреБрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдлрд╝рдЬрд╝рд░ (рдЬреИрд╕реЗ [AFL](http://lcamtuf.coredump.cx/afl/) рдпрд╛ [LibFuzzer](https://llvm.org/docs/LibFuzzer.html)) рдмрдЧ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрд╢рд▓ рдЙрдкрдХрд░рдг рдорд╛рдиреЗ рдЬрд╛рддреЗ рд╣реИрдВред

рдЗрдирдкреБрдЯ рдХреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд░реИрдВрдбрдо рдЬреЗрдирд░реЗрд╢рди рд╕реЗ рдкрд░реЗ, рдЕрдЪреНрдЫреЗ рдЗрдирдкреБрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЗрдВ рдФрд░ рд░рдгрдиреАрддрд┐рдпрд╛рдБ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- рдкреНрд░рддреНрдпреЗрдХ рдирд┐рд╖реНрдкрд╛рджрди рд╕реЗ рдлрд╝реАрдбрдмреИрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬреЗрдирд░реЗрд╢рди рдХреЛ рдЧрд╛рдЗрдб рдХрд░рдирд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рдирдпрд╛ рдЬреЗрдирд░реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЗрдирдкреБрдЯ рдПрдХ рдирдП рдкрд╛рде рдХреА рдЦреЛрдЬ рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХреЗ рдХрд░реАрдм рдирдП рдЗрдирдкреБрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░рдирд╛ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИред
- рдПрдХ рд╕рдВрд░рдЪрдирд╛рддреНрдордХ рдмрд╛рдзрд╛ рдХрд╛ рд╕рдореНрдорд╛рди рдХрд░рддреЗ рд╣реБрдП рдЗрдирдкреБрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░рдирд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдЗрдирдкреБрдЯ рдореЗрдВ рдЪреЗрдХрд╕рдо рдХреЗ рд╕рд╛рде рдПрдХ рд╣реЗрдбрд░ рд╣реИ, рддреЛ рдлрд╝рдЬрд╝рд░ рдХреЛ рдЪреЗрдХрд╕рдо рдХреЛ рдорд╛рдиреНрдп рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЗрдирдкреБрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░рдиреЗ рджреЗрдирд╛ рд╕рдордЭ рдореЗрдВ рдЖрдПрдЧрд╛ред
- рдирдП рдЗрдирдкреБрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреНрдЮрд╛рдд рдЗрдирдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛: рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдорд╛рдиреНрдп рдЗрдирдкреБрдЯ рдХреЗ рдПрдХ рдмрдбрд╝реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рддрдХ рдкрд╣реБрдБрдЪ рд╣реИ, рддреЛ рдЖрдкрдХрд╛ рдлрд╝рдЬрд╝рд░ рд╢реБрд░реВ рд╕реЗ рдЬреЗрдирд░реЗрд╢рди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдЙрдирд╕реЗ рдирдП рдЗрдирдкреБрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрдиреНрд╣реЗрдВ рдЖрдорддреМрд░ рдкрд░ _рд╕реАрдб_ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

### рдкреНрд░реЙрдкрд░реНрдЯреА-рдЖрдзрд╛рд░рд┐рдд рдлрд╝рдЬрд╝рд┐рдВрдЧ {#property-based-fuzzing}

Echidna рдлрд╝рдЬрд╝рд░ рдХреЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд░рд┐рд╡рд╛рд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ: [QuickCheck](https://wikipedia.org/wiki/QuickCheck) рд╕реЗ рдмрд╣реБрдд рдкреНрд░реЗрд░рд┐рдд рдкреНрд░реЙрдкрд░реНрдЯреА-рдЖрдзрд╛рд░рд┐рдд рдлрд╝рдЬрд╝рд┐рдВрдЧред рдХреНрд▓рд╛рд╕рд┐рдХ рдлрд╝рдЬрд╝рд░ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЬреЛ рдХреНрд░реИрд╢ рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛, Echidna рдпреВрдЬрд╝рд░-рдбрд┐рдлрд╛рдЗрдВрдб рдЗрдирд╡реЗрд░рд┐рдПрдВрдЯ рдХреЛ рддреЛрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ред

рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдзреЛрдВ рдореЗрдВ, рдЗрдирд╡реЗрд░рд┐рдПрдВрдЯ Solidity рдлрд╝рдВрдХреНрд╢рди рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рдЕрдиреБрдмрдВрдз рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдХрд┐рд╕реА рднреА рдЧрд▓рдд рдпрд╛ рдЕрдорд╛рдиреНрдп рд╕реНрдЯреЗрдЯ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- рдЧрд▓рдд рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓: рд╣рдорд▓рд╛рд╡рд░ рдЕрдиреБрдмрдВрдз рдХрд╛ рдорд╛рд▓рд┐рдХ рдмрди рдЧрдпрд╛ред
- рдЧрд▓рдд рд╕реНрдЯреЗрдЯ рдорд╢реАрди: рдЕрдиреБрдмрдВрдз рдХреЗ рдкреЙрдЬрд╝ рд╣реЛрдиреЗ рдкрд░ рдЯреЛрдХрди рдЯреНрд░рд╛рдВрд╕рдлрд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
- рдЧрд▓рдд рдЕрдВрдХрдЧрдгрд┐рдд: рдпреВрдЬрд╝рд░ рдЕрдкрдиреЗ рдмреИрд▓реЗрдВрд╕ рдХреЛ рдЕрдВрдбрд░рдлреНрд▓реЛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрд╕реАрдорд┐рдд рдореБрдлреНрдд рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Echidna рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдирд╛ {#testing-a-property-with-echidna}

рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ Echidna рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдз рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд▓рдХреНрд╖реНрдп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдз [`token.sol`](https://github.com/crytic/building-secure-contracts/blob/master/program-analysis/echidna/example/token.sol) рд╣реИ:

```solidity
contract Token{
  mapping(address => uint) public balances;
  function airdrop() public{
      balances[msg.sender] = 1000;
  }
  function consume() public{
      require(balances[msg.sender]>0);
      balances[msg.sender] -= 1;
  }
  function backdoor() public{
      balances[msg.sender] += 1;
  }
}
```

рд╣рдо рдпрд╣ рдорд╛рди рд▓реЗрдВрдЧреЗ рдХрд┐ рдЗрд╕ рдЯреЛрдХрди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЧреБрдг рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП:

- рдХрд┐рд╕реА рдХреЗ рдкрд╛рд╕ рднреА рдЕрдзрд┐рдХрддрдо 1000 рдЯреЛрдХрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ
- рдЯреЛрдХрди рдХреЛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ (рдпрд╣ рдПрдХ ERC20 рдЯреЛрдХрди рдирд╣реАрдВ рд╣реИ)

### рдПрдХ рдкреНрд░реЙрдкрд░реНрдЯреА рд▓рд┐рдЦреЗрдВ {#write-a-property}

Echidna рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ Solidity рдлрд╝рдВрдХреНрд╢рди рд╣реИрдВред рдПрдХ рдкреНрд░реЙрдкрд░реНрдЯреА рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:

- рдХреЛрдИ рдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯ рди рд╣реЛ
- рд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░ `true` рд▓реМрдЯрд╛рдПрдБ
- рдЗрд╕рдХрд╛ рдирд╛рдо `echidna` рд╕реЗ рд╢реБрд░реВ рд╣реЛ

Echidna рдпреЗ рдХрд░реЗрдЧрд╛:

- рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЖрд░реНрдмрд┐рдЯреНрд░рд░реА рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдЬреЗрдирд░реЗрдЯ рдХрд░реЗрдВред
- рдХрд┐рд╕реА рднреА рдРрд╕реЗ рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░реЗрдВ, рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдХреЛрдИ рдкреНрд░реЙрдкрд░реНрдЯреА `false` рд▓реМрдЯрд╛рддреА рд╣реИ рдпрд╛ рдПрд░рд░ рдереНрд░реЛ рдХрд░рддреА рд╣реИред
- рдХрд┐рд╕реА рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╕рдордп рд╕рд╛рдЗрдб-рдЗрдлреЗрдХреНрдЯ рдХреЛ рдЦрд╛рд░рд┐рдЬ рдХрд░ рджреЗрдВ (рдпрд╛рдиреА, рдпрджрд┐ рдкреНрд░реЙрдкрд░реНрдЯреА рд╕реНрдЯреЗрдЯ рд╡реИрд░рд┐рдПрдмрд▓ рдХреЛ рдмрджрд▓рддреА рд╣реИ, рддреЛ рдЗрд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХреЗ рдмрд╛рдж рдЦрд╛рд░рд┐рдЬ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░реЙрдкрд░реНрдЯреА рдЬрд╛рдБрдЪрддреА рд╣реИ рдХрд┐ рдХреЙрд▓рд░ рдХреЗ рдкрд╛рд╕ 1000 рд╕реЗ рдЕрдзрд┐рдХ рдЯреЛрдХрди рдирд╣реАрдВ рд╣реИрдВ:

```solidity
function echidna_balance_under_1000() public view returns(bool){
      return balances[msg.sender] <= 1000;
}
```

рдЕрдкрдиреЗ рдЕрдиреБрдмрдВрдз рдХреЛ рдЕрдкрдиреА рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рд╕реЗ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирд╣реЗрд░рд┐рдЯреЗрдВрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

```solidity
contract TestToken is Token{
      function echidna_balance_under_1000() public view returns(bool){
            return balances[msg.sender] <= 1000;
      }
  }
```

[`token.sol`](https://github.com/crytic/building-secure-contracts/blob/master/program-analysis/echidna/example/token.sol) рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЯреЛрдХрди рд╕реЗ рдЗрдирд╣реЗрд░рд┐рдЯ рдХрд░рддрд╛ рд╣реИред

### рдПрдХ рдЕрдиреБрдмрдВрдз рд╢реБрд░реВ рдХрд░реЗрдВ {#initiate-a-contract}

Echidna рдХреЛ рдмрд┐рдирд╛ рдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯ рд╡рд╛рд▓реЗ [рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░](/developers/docs/smart-contracts/anatomy/#constructor-functions) рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ рдЕрдиреБрдмрдВрдз рдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

Echidna рдореЗрдВ рдХреБрдЫ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрддреЗ рд╣реИрдВ:

- `0x00a329c0648769A73afAc7F9381E08FB43dBEA72` рдЬреЛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред
- `0x10000`, `0x20000`, рдФрд░ `0x00a329C0648769a73afAC7F9381e08fb43DBEA70` рдЬреЛ рд░реИрдВрдбрдорд▓реА рдЕрдиреНрдп рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВред

рд╣рдорд╛рд░реЗ рд╡рд░реНрддрдорд╛рди рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдореЗрдВ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╣рдорд╛рд░рд╛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдЦрд╛рд▓реА рд╣реИред

### Echidna рдЪрд▓рд╛рдПрдБ {#run-echidna}

Echidna рдХреЛ рдЗрд╕рдХреЗ рд╕рд╛рде рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

```bash
echidna-test contract.sol
```

рдпрджрд┐ contract.sol рдореЗрдВ рдХрдИ рдЕрдиреБрдмрдВрдз рд╣реИрдВ, рддреЛ рдЖрдк рд▓рдХреНрд╖реНрдп рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
echidna-test contract.sol --contract MyContract
```

### рд╕рд╛рд░рд╛рдВрд╢: рдПрдХ рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдирд╛ {#summary-testing-a-property}

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ Echidna рдХреЗ рд░рди рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рджреЗрддрд╛ рд╣реИ:

```solidity
contract TestToken is Token{
    constructor() public {}
        function echidna_balance_under_1000() public view returns(bool){
          return balances[msg.sender] <= 1000;
        }
  }
```

```bash
echidna-test testtoken.sol --contract TestToken
...

echidna_balance_under_1000: failed!ЁЯТе
  Call sequence, shrinking (1205/5000):
    airdrop()
    backdoor()

...
```

Echidna рдиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдпрджрд┐ `backdoor` рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди рд╣реЛрддрд╛ рд╣реИред

## рдлрд╝рдЬрд╝рд┐рдВрдЧ рдЕрднрд┐рдпрд╛рди рдХреЗ рджреМрд░рд╛рди рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдирд╛ {#filtering-functions-to-call-during-a-fuzzing-campaign}

рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдлрд╝рдЬрд╝ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреИрд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПред
рд▓рдХреНрд╖реНрдп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдз рд╣реИ:

```solidity
contract C {
  bool state1 = false;
  bool state2 = false;
  bool state3 = false;
  bool state4 = false;

  function f(uint x) public {
    require(x == 12);
    state1 = true;
  }

  function g(uint x) public {
    require(state1);
    require(x == 8);
    state2 = true;
  }

  function h(uint x) public {
    require(state2);
    require(x == 42);
    state3 = true;
  }

 function i() public {
    require(state3);
    state4 = true;
  }

  function reset1() public {
    state1 = false;
    state2 = false;
    state3 = false;
    return;
  }

  function reset2() public {
    state1 = false;
    state2 = false;
    state3 = false;
    return;
  }

  function echidna_state4() public returns (bool) {
    return (!state4);
  }
}
```

рдпрд╣ рдЫреЛрдЯрд╛ рдЙрджрд╛рд╣рд░рдг Echidna рдХреЛ рдПрдХ рд╕реНрдЯреЗрдЯ рд╡реИрд░рд┐рдПрдмрд▓ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдХреЗ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЕрдиреБрдХреНрд░рдо рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИред
рдпрд╣ рдПрдХ рдлрд╝рдЬрд╝рд░ рдХреЗ рд▓рд┐рдП рдХрдард┐рди рд╣реИ (рдпрд╣ [Manticore](https://github.com/trailofbits/manticore) рдЬреИрд╕реЗ рд╕рд┐рдореНрдмреЙрд▓рд┐рдХ рдПрдХреНрд╕рд┐рдХреНрдпреВрд╢рди рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИ)ред
рд╣рдо рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
echidna-test multi.sol
...
echidna_state4: passed! ЁЯОЙ
Seed: -3684648582249875403
```

### рдлрд╝рдВрдХреНрд╢рди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдирд╛ {#filtering-functions}

Echidna рдХреЛ рдЗрд╕ рдЕрдиреБрдмрдВрдз рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рдЕрдиреБрдХреНрд░рдо рдЦреЛрдЬрдиреЗ рдореЗрдВ рдкрд░реЗрд╢рд╛рдиреА рд╣реЛрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рджреЛ рд░реАрд╕реЗрдЯ рдлрд╝рдВрдХреНрд╢рди (`reset1` рдФрд░ `reset2`) рд╕рднреА рд╕реНрдЯреЗрдЯ рд╡реИрд░рд┐рдПрдмрд▓ рдХреЛ `false` рдкрд░ рд╕реЗрдЯ рдХрд░ рджреЗрдВрдЧреЗред
рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╣рдо рд░реАрд╕реЗрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рдпрд╛ рдХреЗрд╡рд▓ `f`, `g`,
`h` рдФрд░ `i` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ Echidna рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```yaml
filterBlacklist: true
filterFunctions: ["reset1", "reset2"]
```

рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдирд╛ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```yaml
filterBlacklist: false
filterFunctions: ["f", "g", "h", "i"]
```

- `filterBlacklist` рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `true` рд╣реИред
- рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдХреЗрд╡рд▓ рдирд╛рдо рд╕реЗ рдХреА рдЬрд╛рдПрдЧреА (рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдмрд┐рдирд╛)ред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ `f()` рдФрд░ `f(uint256)` рд╣реИ, рддреЛ рдлрд╝рд┐рд▓реНрдЯрд░ `"f"` рджреЛрдиреЛрдВ рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдореЗрд▓ рдЦрд╛рдПрдЧрд╛ред

### Echidna рдЪрд▓рд╛рдПрдБ {#run-echidna-1}

`blacklist.yaml` рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде Echidna рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

```bash
echidna-test multi.sol --config blacklist.yaml
...
echidna_state4: failed!ЁЯТе
  Call sequence:
    f(12)
    g(8)
    h(42)
    i()
```

Echidna рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рдЧрд▓рдд рд╕рд╛рдмрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдХрд╛ рдХреНрд░рдо рд▓рдЧрднрдЧ рддреБрд░рдВрдд рдЦреЛрдЬ рд▓реЗрдЧрд╛ред

### рд╕рд╛рд░рд╛рдВрд╢: рдлрд╝рдВрдХреНрд╢рди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдирд╛ {#summary-filtering-functions}

Echidna рдПрдХ рдлрд╝рдЬрд╝рд┐рдВрдЧ рдЕрднрд┐рдпрд╛рди рдХреЗ рджреМрд░рд╛рди рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдпрд╛ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

```yaml
filterBlacklist: true
filterFunctions: ["f1", "f2", "f3"]
```

```bash
echidna-test contract.sol --config config.yaml
...
```

Echidna `filterBlacklist` рдмреВрд▓рд┐рдпрди рдХреЗ рдорд╛рди рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╛ рддреЛ `f1`, `f2` рдФрд░ `f3` рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХрд░рдХреЗ рдпрд╛ рдХреЗрд╡рд▓ рдЗрдиреНрд╣реЗрдВ рдХреЙрд▓ рдХрд░рдХреЗ рдПрдХ рдлрд╝рдЬрд╝рд┐рдВрдЧ рдЕрднрд┐рдпрд╛рди рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред

## Echidna рдХреЗ рд╕рд╛рде Solidity рдХреЗ рдПрд╕рд░реНрдЯ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХреИрд╕реЗ рдХрд░реЗрдВ {#how-to-test-soliditys-assert-with-echidna}

рдЗрд╕ рдЫреЛрдЯреЗ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ, рд╣рдо рдпрд╣ рджрд┐рдЦрд╛рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдЕрдиреБрдмрдВрдзреЛрдВ рдореЗрдВ рдПрд╕рд░реНрд╢рди рдЪреЗрдХрд┐рдВрдЧ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВред рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ рдЕрдиреБрдмрдВрдз рд╣реИ:

```solidity
contract Incrementor {
  uint private counter = 2**200;

  function inc(uint val) public returns (uint){
    uint tmp = counter;
    counter += val;
    // tmp <= counter
    return (counter - tmp);
  }
}
```

### рдПрдХ рдПрд╕рд░реНрд╢рди рд▓рд┐рдЦреЗрдВ {#write-an-assertion}

рд╣рдо рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ `tmp` рдЕрдкрдиреЗ рдЕрдВрддрд░ рдХреЛ рд▓реМрдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж `counter` рд╕реЗ рдХрдо рдпрд╛ рдЙрд╕рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред рд╣рдо рдПрдХ
Echidna рдкреНрд░реЙрдкрд░реНрдЯреА рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ `tmp` рдорд╛рди рдХреЛ рдХрд╣реАрдВ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдЗрд╕ рддрд░рд╣ рдХреЗ рдПрдХ рдПрд╕рд░реНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```solidity
contract Incrementor {
  uint private counter = 2**200;

  function inc(uint val) public returns (uint){
    uint tmp = counter;
    counter += val;
    assert (tmp <= counter);
    return (counter - tmp);
  }
}
```

### Echidna рдЪрд▓рд╛рдПрдБ {#run-echidna-2}

рдПрд╕рд░реНрд╢рди рд╡рд┐рдлрд▓рддрд╛ рдкрд░реАрдХреНрд╖рдг рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ [Echidna рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓](https://github.com/crytic/echidna/wiki/Config) `config.yaml` рдмрдирд╛рдПрдБ:

```yaml
checkAsserts: true
```

рдЬрдм рд╣рдо Echidna рдореЗрдВ рдЗрд╕ рдЕрдиреБрдмрдВрдз рдХреЛ рдЪрд▓рд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЕрдкреЗрдХреНрд╖рд┐рдд рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддреЗ рд╣реИрдВ:

```bash
echidna-test assert.sol --config config.yaml
Analyzing contract: assert.sol:Incrementor
assertion in inc: failed!ЁЯТе
  Call sequence, shrinking (2596/5000):
    inc(21711016731996786641919559689128982722488122124807605757398297001483711807488)
    inc(7237005577332262213973186563042994240829374041602535252466099000494570602496)
    inc(86844066927987146567678238756515930889952488499230423029593188005934847229952)

Seed: 1806480648350826486
```

рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, Echidna `inc` рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХреБрдЫ рдПрд╕рд░реНрд╢рди рд╡рд┐рдлрд▓рддрд╛ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИред рдкреНрд░рддрд┐ рдлрд╝рдВрдХреНрд╢рди рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдПрд╕рд░реНрд╢рди рдЬреЛрдбрд╝рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рд▓реЗрдХрд┐рди Echidna рдпрд╣ рдирд╣реАрдВ рдмрддрд╛ рд╕рдХрддрд╛ рдХрд┐ рдХреМрди рд╕рд╛ рдПрд╕рд░реНрд╢рди рд╡рд┐рдлрд▓ рд╣реБрдЖред

### рдПрд╕рд░реНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдм рдФрд░ рдХреИрд╕реЗ рдХрд░реЗрдВ {#when-and-how-use-assertions}

рдПрд╕рд░реНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдкрд╖реНрдЯ рдЧреБрдгреЛрдВ рдХреЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдпрджрд┐ рдЬрд╛рдБрдЪ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реНрдерд┐рддрд┐рдпрд╛рдБ рд╕реАрдзреЗ рдХреБрдЫ рдСрдкрд░реЗрд╢рди `f` рдХреЗ рд╕рд╣реА рдЙрдкрдпреЛрдЧ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред рдХреБрдЫ рдХреЛрдб рдХреЗ рдмрд╛рдж рдПрд╕рд░реНрд╢рди рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдпрд╣ рд▓рд╛рдЧреВ рд╣реЛрдЧрд╛ рдХрд┐ рдЬрд╛рдБрдЪ рдЙрд╕рдХреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рд╣реЛрдЧреА:

```solidity
function f(..) public {
    // some complex code
    ...
    assert (condition);
    ...
}

```

рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рдПрдХ рд╕реНрдкрд╖реНрдЯ echidna рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдХреЛ рд░реИрдВрдбрдо рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдпрд╣ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрд╕реЗ рдХрдм рдЬрд╛рдБрдЪ рдХреА рдЬрд╛рдПрдЧреАред рдпрд╣ рд╕рдорд╛рдзрд╛рди рдХрд░рдирд╛ рдЕрднреА рднреА рд╕рдВрднрд╡ рд╣реИ:

```solidity
function echidna_assert_after_f() public returns (bool) {
    f(..);
    return(condition);
}
```

рд╣рд╛рд▓рд╛рдБрдХрд┐, рдХреБрдЫ рд╕рдорд╕реНрдпрд╛рдПрдБ рд╣реИрдВ:

- рдпрд╣ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдпрджрд┐ `f` рдХреЛ `internal` рдпрд╛ `external` рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ `f` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рди рдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
- рдпрджрд┐ `f` рд░рд┐рд╡рд░реНрдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдкреНрд░реЙрдкрд░реНрдЯреА рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧреАред

рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╣рдо рдПрд╕рд░реНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ рдкрд░ [рдЬреЙрди рд░реЗрдЧреЗрд░ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢](https://blog.regehr.org/archives/1091) рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддреЗ рд╣реИрдВ:

- рдПрд╕рд░реНрд╢рди рдЬрд╛рдБрдЪ рдХреЗ рджреМрд░рд╛рди рдХрд┐рд╕реА рднреА рд╕рд╛рдЗрдб рдЗрдлреЗрдХреНрдЯ рдХреЛ рдордЬрдмреВрд░ рди рдХрд░реЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: `assert(ChangeStateAndReturn() == 1)`
- рд╕реНрдкрд╖реНрдЯ рдХрдердиреЛрдВ рдХрд╛ рджрд╛рд╡рд╛ рди рдХрд░реЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `assert(var >= 0)` рдЬрд╣рд╛рдБ `var` рдХреЛ `uint` рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдЕрдВрдд рдореЗрдВ, рдХреГрдкрдпрд╛ `assert` рдХреЗ рдмрдЬрд╛рдп `require` рдХрд╛ **рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ**, рдХреНрдпреЛрдВрдХрд┐ Echidna рдЗрд╕рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧрд╛ рдкрд╛рдПрдЧрд╛ (рд▓реЗрдХрд┐рди рдЕрдиреБрдмрдВрдз рд╡реИрд╕реЗ рднреА рд░рд┐рд╡рд░реНрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛)ред

### рд╕рд╛рд░рд╛рдВрд╢: рдПрд╕рд░реНрд╢рди рдЪреЗрдХрд┐рдВрдЧ {#summary-assertion-checking}

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ Echidna рдХреЗ рд░рди рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рджреЗрддрд╛ рд╣реИ:

```solidity
contract Incrementor {
  uint private counter = 2**200;

  function inc(uint val) public returns (uint){
    uint tmp = counter;
    counter += val;
    assert (tmp <= counter);
    return (counter - tmp);
  }
}
```

```bash
echidna-test assert.sol --config config.yaml
Analyzing contract: assert.sol:Incrementor
assertion in inc: failed!ЁЯТе
  Call sequence, shrinking (2596/5000):
    inc(21711016731996786641919559689128982722488122124807605757398297001483711807488)
    inc(7237005577332262213973186563042994240829374041602535252466099000494570602496)
    inc(86844066927987146567678238756515930889952488499230423029593188005934847229952)

Seed: 1806480648350826486
```

Echidna рдиреЗ рдкрд╛рдпрд╛ рдХрд┐ `inc` рдореЗрдВ рдПрд╕рд░реНрд╢рди рд╡рд┐рдлрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрдбрд╝реЗ рдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдХрдИ рдмрд╛рд░ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рдПрдХ Echidna рдХреЙрд░реНрдкрд╕ рдХреЛ рдПрдХрддреНрд░ рдХрд░рдирд╛ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ {#collecting-and-modifying-an-echidna-corpus}

рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ Echidna рдХреЗ рд╕рд╛рде рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдХреЗ рдХреЙрд░реНрдкрд╕ рдХреЛ рдХреИрд╕реЗ рдПрдХрддреНрд░ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПред рд▓рдХреНрд╖реНрдп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдз [`magic.sol`](https://github.com/crytic/building-secure-contracts/blob/master/program-analysis/echidna/example/magic.sol) рд╣реИ:

```solidity
contract C {
  bool value_found = false;
  function magic(uint magic_1, uint magic_2, uint magic_3, uint magic_4) public {
    require(magic_1 == 42);
    require(magic_2 == 129);
    require(magic_3 == magic_4+333);
    value_found = true;
    return;
  }

  function echidna_magic_values() public returns (bool) {
    return !value_found;
  }

}
```

рдпрд╣ рдЫреЛрдЯрд╛ рдЙрджрд╛рд╣рд░рдг Echidna рдХреЛ рдПрдХ рд╕реНрдЯреЗрдЯ рд╡реИрд░рд┐рдПрдмрд▓ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдорд╛рди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдлрд╝рдЬрд╝рд░ рдХреЗ рд▓рд┐рдП рдХрдард┐рди рд╣реИ
(рдпрд╣ [Manticore](https://github.com/trailofbits/manticore) рдЬреИрд╕реЗ рд╕рд┐рдореНрдмреЙрд▓рд┐рдХ рдПрдХреНрд╕рд┐рдХреНрдпреВрд╢рди рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИ)ред
рд╣рдо рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
echidna-test magic.sol
...

echidna_magic_values: passed! ЁЯОЙ

Seed: 2221503356319272685
```

рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдо рдЕрднреА рднреА рдЗрд╕ рдлрд╝рдЬрд╝рд┐рдВрдЧ рдЕрднрд┐рдпрд╛рди рдХреЛ рдЪрд▓рд╛рддреЗ рд╕рдордп рдХреЙрд░реНрдкрд╕ рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдПрдХ рдХреЙрд░реНрдкрд╕ рдПрдХрддреНрд░ рдХрд░рдирд╛ {#collecting-a-corpus}

рдХреЙрд░реНрдкрд╕ рд╕рдВрдЧреНрд░рд╣ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдХреЙрд░реНрдкрд╕ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдмрдирд╛рдПрдБ:

```bash
mkdir corpus-magic
```

рдФрд░ рдПрдХ [Echidna рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓](https://github.com/crytic/echidna/wiki/Config) `config.yaml`:

```yaml
coverage: true
corpusDir: "corpus-magic"
```

рдЕрдм рд╣рдо рдЕрдкрдирд╛ рдЯреВрд▓ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХрддреНрд░ рдХрд┐рдП рдЧрдП рдХреЙрд░реНрдкрд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
echidna-test magic.sol --config config.yaml
```

Echidna рдЕрднреА рднреА рд╕рд╣реА рдореИрдЬрд┐рдХ рдорд╛рди рдирд╣реАрдВ рдЦреЛрдЬ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдЙрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдПрдХрддреНрд░ рдХрд┐рдП рдЧрдП рдХреЙрд░реНрдкрд╕ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрдирдореЗрдВ рд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдереА:

```json
[
  {
    "_gas'": "0xffffffff",
    "_delay": ["0x13647", "0xccf6"],
    "_src": "00a329c0648769a73afac7f9381e08fb43dbea70",
    "_dst": "00a329c0648769a73afac7f9381e08fb43dbea72",
    "_value": "0x0",
    "_call": {
      "tag": "SolCall",
      "contents": [
        "magic",
        [
          {
            "contents": [
              256,
              "93723985220345906694500679277863898678726808528711107336895287282192244575836"
            ],
            "tag": "AbiUInt"
          },
          {
            "contents": [256, "334"],
            "tag": "AbiUInt"
          },
          {
            "contents": [
              256,
              "68093943901352437066264791224433559271778087297543421781073458233697135179558"
            ],
            "tag": "AbiUInt"
          },
          {
            "tag": "AbiUInt",
            "contents": [256, "332"]
          }
        ]
      ]
    },
    "_gasprice'": "0xa904461f1"
  }
]
```

рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдЗрдирдкреБрдЯ рд╣рдорд╛рд░реА рдкреНрд░реЙрдкрд░реНрдЯреА рдореЗрдВ рд╡рд┐рдлрд▓рддрд╛ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд▓реЗ рдЪрд░рдг рдореЗрдВ, рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЗрд╕реЗ рдЙрд╕рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред

### рдПрдХ рдХреЙрд░реНрдкрд╕ рдХреЛ рд╕реАрдб рдХрд░рдирд╛ {#seeding-a-corpus}

`magic` рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдХреЛ рдХреБрдЫ рдорджрдж рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдо рдЗрд╕рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд
рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдХреЛ рдХреЙрдкреА рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ:

```bash
cp corpus/2712688662897926208.txt corpus/new.txt
```

рд╣рдо `magic(42,129,333,0)` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `new.txt` рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВрдЧреЗред рдЕрдм, рд╣рдо Echidna рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
echidna-test magic.sol --config config.yaml
...
echidna_magic_values: failed!ЁЯТе
  Call sequence:
    magic(42,129,333,0)


Unique instructions: 142
Unique codehashes: 1
Seed: -7293830866560616537

```

рдЗрд╕ рдмрд╛рд░, рдЗрд╕рдиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рддреБрд░рдВрдд рдЙрд▓реНрд▓рдВрдШрди рд╣реБрдЖ рд╣реИред

## рдЙрдЪреНрдЪ рдЧреИрд╕ рдЦрдкрдд рд╡рд╛рд▓реЗ рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдЦреЛрдЬрдирд╛ {#finding-transactions-with-high-gas-consumption}

рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ Echidna рдХреЗ рд╕рд╛рде рдЙрдЪреНрдЪ рдЧреИрд╕ рдЦрдкрдд рд╡рд╛рд▓реЗ рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдХреИрд╕реЗ рдЦреЛрдЬреЗрдВред рд▓рдХреНрд╖реНрдп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдорд╛рд░реНрдЯ рдЕрдиреБрдмрдВрдз рд╣реИ:

```solidity
contract C {
  uint state;

  function expensive(uint8 times) internal {
    for(uint8 i=0; i < times; i++)
      state = state + i;
  }

  function f(uint x, uint y, uint8 times) public {
    if (x == 42 && y == 123)
      expensive(times);
    else
      state = 0;
  }

  function echidna_test() public returns (bool) {
    return true;
  }

}
```

рдпрд╣рд╛рдБ `expensive` рдореЗрдВ рдПрдХ рдмрдбрд╝реА рдЧреИрд╕ рдЦрдкрдд рд╣реЛ рд╕рдХрддреА рд╣реИред

рд╡рд░реНрддрдорд╛рди рдореЗрдВ, Echidna рдХреЛ рд╣рдореЗрд╢рд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░реЙрдкрд░реНрдЯреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ: рдпрд╣рд╛рдБ `echidna_test` рд╣рдореЗрд╢рд╛ `true` рд▓реМрдЯрд╛рддрд╛ рд╣реИред
рд╣рдо рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Echidna рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```
echidna-test gas.sol
...
echidna_test: passed! ЁЯОЙ

Seed: 2320549945714142710
```

### рдЧреИрд╕ рдХреА рдЦрдкрдд рдХреЛ рдорд╛рдкрдирд╛ {#measuring-gas-consumption}

Echidna рдХреЗ рд╕рд╛рде рдЧреИрд╕ рдХреА рдЦрдкрдд рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ `config.yaml` рдмрдирд╛рдПрдБ:

```yaml
estimateGas: true
```

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдореЗрдВ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдЕрдиреБрдХреНрд░рдо рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рднреА рдХрдо рдХрд░реЗрдВрдЧреЗ:

```yaml
seqLen: 2
estimateGas: true
```

### Echidna рдЪрд▓рд╛рдПрдБ {#run-echidna-3}

рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдмрди рдЬрд╛рддреА рд╣реИ, рддреЛ рд╣рдо Echidna рдХреЛ рдЗрд╕ рддрд░рд╣ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
echidna-test gas.sol --config config.yaml
...
echidna_test: passed! ЁЯОЙ

f used a maximum of 1333608 gas
  Call sequence:
    f(42,123,249) Gas price: 0x10d5733f0a Time delay: 0x495e5 Block delay: 0x88b2

Unique instructions: 157
Unique codehashes: 1
Seed: -325611019680165325

```

- рджрд┐рдЦрд╛рдИ рдЧрдИ рдЧреИрд╕ [HEVM](https://github.com/dapphub/dapptools/tree/master/src/hevm#hevm-) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХ рдЕрдиреБрдорд╛рди рд╣реИред

### рдЧреИрд╕ рдХрдо рдХрд░рдиреЗ рд╡рд╛рд▓реА рдХреЙрд▓ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдирд╛ {#filtering-out-gas-reducing-calls}

рдКрдкрд░ **рдлрд╝рдЬрд╝рд┐рдВрдЧ рдЕрднрд┐рдпрд╛рди рдХреЗ рджреМрд░рд╛рди рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдирд╛** рдкрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ
рдЕрдкрдиреЗ рдкрд░реАрдХреНрд╖рдг рд╕реЗ рдХреБрдЫ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╣рдЯрд╛рдпрд╛ рдЬрд╛рдПред  
рдпрд╣ рдПрдХ рд╕рдЯреАрдХ рдЧреИрд╕ рдЕрдиреБрдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:

```solidity
contract C {
  address [] addrs;
  function push(address a) public {
    addrs.push(a);
  }
  function pop() public {
    addrs.pop();
  }
  function clear() public{
    addrs.length = 0;
  }
  function check() public{
    for(uint256 i = 0; i < addrs.length; i++)
      for(uint256 j = i+1; j < addrs.length; j++)
        if (addrs[i] == addrs[j])
          addrs[j] = address(0x0);
  }
  function echidna_test() public returns (bool) {
      return true;
  }
}
```

рдпрджрд┐ Echidna рд╕рднреА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдЙрдЪреНрдЪ рдЧреИрд╕ рд▓рд╛рдЧрдд рд╡рд╛рд▓реЗ рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдЖрд╕рд╛рдиреА рд╕реЗ рдирд╣реАрдВ рдорд┐рд▓реЗрдВрдЧреЗ:

```
echidna-test pushpop.sol --config config.yaml
...
pop used a maximum of 10746 gas
...
check used a maximum of 23730 gas
...
clear used a maximum of 35916 gas
...
push used a maximum of 40839 gas
```

рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд▓рд╛рдЧрдд `addrs` рдХреЗ рдЖрдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ рдФрд░ рд░реИрдВрдбрдо рдХреЙрд▓ рдРрд░реЗ рдХреЛ рд▓рдЧрднрдЧ рдЦрд╛рд▓реА рдЫреЛрдбрд╝ рджреЗрддреЗ рд╣реИрдВред
`pop` рдФрд░ `clear` рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рд╕реЗ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдореЗрдВ рдмрд╣реБрдд рдмреЗрд╣рддрд░ рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддреЗ рд╣реИрдВ:

```yaml
filterBlacklist: true
filterFunctions: ["pop", "clear"]
```

```
echidna-test pushpop.sol --config config.yaml
...
push used a maximum of 40839 gas
...
check used a maximum of 1484472 gas
```

### рд╕рд╛рд░рд╛рдВрд╢: рдЙрдЪреНрдЪ рдЧреИрд╕ рдЦрдкрдд рд╡рд╛рд▓реЗ рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдЦреЛрдЬрдирд╛ {#summary-finding-transactions-with-high-gas-consumption}

Echidna `estimateGas` рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдЪреНрдЪ рдЧреИрд╕ рдЦрдкрдд рд╡рд╛рд▓реЗ рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрд╢рди рдЦреЛрдЬ рд╕рдХрддрд╛ рд╣реИ:

```yaml
estimateGas: true
```

```bash
echidna-test contract.sol --config config.yaml
...
```

Echidna рдлрд╝рдЬрд╝рд┐рдВрдЧ рдЕрднрд┐рдпрд╛рди рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рд░ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрддрдо рдЧреИрд╕ рдЦрдкрдд рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдиреБрдХреНрд░рдо рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░реЗрдЧрд╛ред
