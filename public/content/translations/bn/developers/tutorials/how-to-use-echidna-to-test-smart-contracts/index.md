---
title: "рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛рж░ ржЬржирзНржп Echidna ржХрзАржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи"
description: "рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛рж░ ржЬржирзНржп Echidna ржХрзАржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи"
author: "Trailofbits"
lang: bn
tags:
  [
    "рж╕рж▓рж┐ржбрж┐ржЯрж┐",
    "рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ",
    "ржирж┐рж░рж╛ржкрждрзНрждрж╛",
    "ржкрж░рзАржХрзНрж╖рж╛",
    "ржлрж╛ржЬрж┐ржВ"
  ]
skill: advanced
published: 2020-04-10
source: "рж╕рзБрж░ржХрзНрж╖рж┐ржд ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ рждрзИрж░рж┐ ржХрж░рж╛"
sourceUrl: https://github.com/crytic/building-secure-contracts/tree/master/program-analysis/echidna
---

## ржЗржирж╕рзНржЯрж▓рзЗрж╢ржи {#installation}

ржбржХрж╛рж░рзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЕржержмрж╛ ржкрзНрж░рж┐-ржХржорзНржкрж╛ржЗрж▓ржб ржмрж╛ржЗржирж╛рж░рж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ Echidna ржЗржирж╕рзНржЯрж▓ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред

### ржбржХрж╛рж░рзЗрж░ ржорж╛ржзрзНржпржорзЗ Echidna {#echidna-through-docker}

```bash
docker pull trailofbits/eth-security-toolbox
docker run -it -v "$PWD":/home/training trailofbits/eth-security-toolbox
```

_рж╢рзЗрж╖ ржХржорж╛ржирзНржбржЯрж┐ ржПржХржЯрж┐ docker-ржП eth-security-toolbox ржЪрж╛рж▓рж╛рзЯ ржпрзЗржЯрж┐рж░ ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржбрж┐рж░рзЗржХрзНржЯрж░рж┐рждрзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЖржЫрзЗред ржЖржкржирж┐ ржЖржкржирж╛рж░ рж╣рзЛрж╕рзНржЯ ржерзЗржХрзЗ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржПржмржВ docker ржерзЗржХрзЗ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛрждрзЗ ржЯрзБрж▓рж╕ ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рзЗржи_

ржбржХрж╛рж░рзЗрж░ ржнрж┐рждрж░рзЗ, ржЪрж╛рж▓рж╛ржи:

```bash
solc-select 0.5.11
cd /home/training
```

### ржмрж╛ржЗржирж╛рж░рж┐ {#binary}

[https://github.com/crytic/echidna/releases/tag/v1.4.0.0](https://github.com/crytic/echidna/releases/tag/v1.4.0.0)

## ржкрзНрж░ржкрж╛рж░рзНржЯрж┐-ржнрж┐рждрзНрждрж┐ржХ ржлрж╛ржЬрж┐ржВ ржПрж░ ржнрзВржорж┐ржХрж╛ {#introduction-to-property-based-fuzzing}

Echidna рж╣рж▓рзЛ ржПржХржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐-ржнрж┐рждрзНрждрж┐ржХ ржлрж╛ржЬрж╛рж░, ржпрж╛ ржЖржорж░рж╛ ржЖржорж╛ржжрзЗрж░ ржЖржЧрзЗрж░ ржмрзНрж▓ржЧржкрзЛрж╕рзНржЯржЧрзБрж▓рзЛрждрзЗ ржмрж░рзНржгржирж╛ ржХрж░рзЗржЫрж┐ ([1](https://blog.trailofbits.com/2018/03/09/echidna-a-smart-fuzzer-for-ethereum/), [2](https://blog.trailofbits.com/2018/05/03/state-machine-testing-with-echidna/), [3](https://blog.trailofbits.com/2020/03/30/an-echidna-for-all-seasons/)).

### ржлрж╛ржЬрж┐ржВ {#fuzzing}

[ржлрж╛ржЬрж┐ржВ](https://wikipedia.org/wiki/Fuzzing) ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржХржорж┐ржЙржирж┐ржЯрж┐рждрзЗ ржПржХржЯрж┐ рж╕рзБржкрж░рж┐ржЪрж┐ржд ржХрзМрж╢рж▓ред ржПржЯрж┐рждрзЗ ржкрзНрж░рзЛржЧрзНрж░рж╛ржорзЗрж░ ржоржзрзНржпрзЗ ржмрж╛ржЧ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛рж░ ржЬржирзНржп ржХржо-ржмрзЗрж╢рж┐ рж░тАНрзНржпрж╛ржирзНржбржо ржЗржиржкрзБржЯ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржпрж╝ред ржкрзНрж░ржЪрж▓рж┐ржд рж╕ржлржЯржУрзЯрзНржпрж╛рж░рзЗрж░ ржЬржирзНржп ржлрж╛ржЬрж╛рж░ (ржпрзЗржоржи [AFL](http://lcamtuf.coredump.cx/afl/) ржмрж╛ [LibFuzzer](https://llvm.org/docs/LibFuzzer.html)) ржмрж╛ржЧ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛рж░ ржЬржирзНржп ржжржХрзНрж╖ ржЯрзБрж▓рж╕ рж╣рж┐рж╕рзЗржмрзЗ ржкрж░рж┐ржЪрж┐рждред

рж╢рзБржзрзБржорж╛рждрзНрж░ рж░тАНрзНржпрж╛ржирзНржбржо ржЗржиржкрзБржЯ рждрзИрж░рж┐ ржХрж░рж╛рж░ ржмрж╛ржЗрж░рзЗржУ, ржнрж╛рж▓рзЛ ржЗржиржкрзБржЯ рждрзИрж░рж┐ ржХрж░рж╛рж░ ржЬржирзНржп ржЕржирзЗржХ ржХрзМрж╢рж▓ ржПржмржВ рж╕рзНржЯрзНрж░рзНржпрж╛ржЯрзЗржЬрж┐ рж░ржпрж╝рзЗржЫрзЗ, ржпрж╛рж░ ржоржзрзНржпрзЗ рж░ржпрж╝рзЗржЫрзЗ:

- ржкрзНрж░рждрж┐ржЯрж┐ ржПржХрзНрж╕рж┐ржХрж┐ржЙрж╢ржи ржерзЗржХрзЗ ржлрж┐ржбржмрзНржпрж╛ржХ ржкрж╛ржУрзЯрж╛ ржПржмржВ рждрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЬрзЗржирж╛рж░рзЗрж╢ржиржХрзЗ ржЧрж╛ржЗржб ржХрж░рж╛ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржпржжрж┐ ржПржХржЯрж┐ ржирждрзБржи ржЬрзЗржирж╛рж░рзЗржЯрзЗржб ржЗржиржкрзБржЯ ржПржХржЯрж┐ ржирждрзБржи ржкрже ржЖржмрж┐рж╖рзНржХрж╛рж░ ржХрж░рзЗ, рждржмрзЗ рждрж╛рж░ ржХрж╛ржЫрж╛ржХрж╛ржЫрж┐ ржирждрзБржи ржЗржиржкрзБржЯ ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж╛ ржЕрж░рзНржержкрзВрж░рзНржг рж╣рждрзЗ ржкрж╛рж░рзЗред
- ржПржХржЯрж┐ ржХрж╛ржарж╛ржорзЛржЧржд рж╕рзАржорж╛ржмржжрзНржзрждрж╛ржХрзЗ рж╕ржорзНржорж╛ржи ржХрж░рзЗ ржЗржиржкрзБржЯ рждрзИрж░рж┐ ржХрж░рж╛ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржпржжрж┐ ржЖржкржирж╛рж░ ржЗржиржкрзБржЯрзЗ ржПржХржЯрж┐ ржЪрзЗржХрзНрж╕рж╛ржорж╕рж╣ ржПржХржЯрж┐ рж╣рзЗржбрж╛рж░ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржлрж╛ржЬрж╛рж░ржХрзЗ ржЪрзЗржХрзНрж╕рж╛ржо ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯ ржХрж░рзЗ ржПржоржи ржЗржиржкрзБржЯ рждрзИрж░рж┐ ржХрж░рждрзЗ ржжрзЗржУрзЯрж╛ржЯрж╛ ржпрзБржХрзНрждрж┐ржпрзБржХрзНржд рж╣ржмрзЗред
- ржирждрзБржи ржЗржиржкрзБржЯ рждрзИрж░рж┐ ржХрж░рж╛рж░ ржЬржирзНржп ржкрж░рж┐ржЪрж┐ржд ржЗржиржкрзБржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛: ржпржжрж┐ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ ржмрзИржз ржЗржиржкрзБржЯрзЗрж░ ржПржХржЯрж┐ ржмрзЬ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржЖржкржирж╛рж░ ржлрж╛ржЬрж╛рж░ рж╕рзНржХрзНрж░рзНржпрж╛ржЪ ржерзЗржХрзЗ ржЬрзЗржирж╛рж░рзЗрж╢ржи рж╢рзБрж░рзБ ржХрж░рж╛рж░ ржкрж░рж┐ржмрж░рзНрждрзЗ рж╕рзЗржЧрзБрж▓рзЛ ржерзЗржХрзЗ ржирждрзБржи ржЗржиржкрзБржЯ рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗред ржПржЧрзБрж▓рзЛржХрзЗ рж╕рж╛ржзрж╛рж░ржгржд _рж╕рж┐ржб_ ржмрж▓рж╛ рж╣рзЯред

### ржкрзНрж░ржкрж╛рж░рзНржЯрж┐-ржнрж┐рждрзНрждрж┐ржХ ржлрж╛ржЬрж┐ржВ {#property-based-fuzzing}

Echidna ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж╛ржЬрж╛рж░ ржкрж░рж┐ржмрж╛рж░рзЗрж░ ржЕржирзНрждрж░рзНржЧржд: ржПржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐-ржнрж┐рждрзНрждрж┐ржХ ржлрж╛ржЬрж┐ржВ ржпрж╛ [QuickCheck](https://wikipedia.org/wiki/QuickCheck) ржжрзНржмрж╛рж░рж╛ ржмрзНржпрж╛ржкржХржнрж╛ржмрзЗ ржЕржирзБржкрзНрж░рж╛ржгрж┐рждред ржХрзНрж▓рж╛рж╕рж┐ржХ ржлрж╛ржЬрж╛рж░рзЗрж░ ржмрж┐ржкрж░рзАрждрзЗ, ржпрж╛ ржХрзНрж░рзНржпрж╛рж╢ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗ, Echidna ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА-рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржЗржиржнрзЗрж░рж┐рзЯрзЗржирзНржЯржЧрзБрж▓рзЛ ржнрж╛ржЩрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржмрзЗред

рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯрзЗ, ржЗржиржнрзЗрж░рж┐рзЯрзЗржирзНржЯржЧрзБрж▓рзЛ рж╣рж▓рзЛ рж╕рж▓рж┐ржбрж┐ржЯрж┐ ржлрж╛ржВрж╢ржи, ржпрж╛ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ ржкрзМржБржЫрж╛рждрзЗ ржкрж╛рж░рзЗ ржПржоржи ржпрзЗржХрзЛржирзЛ ржнрзБрж▓ ржмрж╛ ржЕржмрзИржз рж╕рзНржЯрзЗржЯржХрзЗ ржЙржкрж╕рзНржерж╛ржкржи ржХрж░рждрзЗ ржкрж╛рж░рзЗ, ржпрж╛рж░ ржоржзрзНржпрзЗ рж░рзЯрзЗржЫрзЗ:

- ржнрзБрж▓ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХржирзНржЯрзНрж░рзЛрж▓: ржЖржХрзНрж░ржоржгржХрж╛рж░рзА ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯрзЗрж░ ржорж╛рж▓рж┐ржХ рж╣рзЯрзЗ ржЧрж┐рзЯрзЗржЫрзЗред
- ржнрзБрж▓ рж╕рзНржЯрзЗржЯ ржорзЗрж╢рж┐ржи: ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ ржкржЬ ржХрж░рж╛ ржЕржмрж╕рзНржерж╛ржпрж╝ ржЯрзЛржХрзЗржиржЧрзБрж▓рзЛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред
- ржнрзБрж▓ ржЕрзНржпрж╛рж░рж┐ржержорзЗржЯрж┐ржХ: ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рждрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЖржирзНржбрж╛рж░ржлрзНрж▓рзЛ ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржПржмржВ рж╕рзАржорж╛рж╣рзАржи ржлрзНрж░рж┐ ржЯрзЛржХрзЗржи ржкрзЗрждрзЗ ржкрж╛рж░рзЗред

### Echidna ржжрж┐рзЯрзЗ ржПржХржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛ {#testing-a-property-with-echidna}

ржЖржорж░рж╛ ржжрзЗржЦржм ржХрзАржнрж╛ржмрзЗ Echidna ржжрж┐рзЯрзЗ ржПржХржЯрж┐ рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛ ржпрж╛рзЯред ржЯрж╛рж░рзНржЧрзЗржЯ рж╣рж▓рзЛ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ [`token.sol`](https://github.com/crytic/building-secure-contracts/blob/master/program-analysis/echidna/example/token.sol):

```solidity
contract Token{
  mapping(address => uint) public balances;
  function airdrop() public{
      balances[msg.sender] = 1000;
  }
  function consume() public{
      require(balances[msg.sender]>0);
      balances[msg.sender] -= 1;
  }
  function backdoor() public{
      balances[msg.sender] += 1;
  }
}
```

ржЖржорж░рж╛ ржПржЗ ржЕржирзБржорж╛ржиржЯрж┐ ржХрж░ржм ржпрзЗ ржПржЗ ржЯрзЛржХрзЗржирзЗрж░ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржмрзИрж╢рж┐рж╖рзНржЯрзНржпржЧрзБрж▓рзЛ ржЕржмрж╢рзНржпржЗ ржерж╛ржХрждрзЗ рж╣ржмрзЗ:

- ржпрзЗржХрзЛржирзЛ ржмрзНржпржХрзНрждрж┐рж░ ржХрж╛ржЫрзЗ рж╕рж░рзНржмрзЛржЪрзНржЪ 1000ржЯрж┐ ржЯрзЛржХрзЗржи ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ
- ржЯрзЛржХрзЗржиржЯрж┐ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛ (ржПржЯрж┐ ржХрзЛржирзЛ ERC20 ржЯрзЛржХрзЗржи ржирзЯ)

### ржПржХржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ рж▓рж┐ржЦрзБржи {#write-a-property}

Echidna ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ржЧрзБрж▓рзЛ рж╣рж▓рзЛ рж╕рж▓рж┐ржбрж┐ржЯрж┐ ржлрж╛ржВрж╢ржиред ржПржХржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐рждрзЗ ржЕржмрж╢рзНржпржЗ ржерж╛ржХрждрзЗ рж╣ржмрзЗ:

- ржХрзЛржирзЛ ржЖрж░рзНржЧрзБржорзЗржирзНржЯ ржерж╛ржХржмрзЗ ржирж╛
- рж╕ржлрж▓ рж╣рж▓рзЗ `true` рж░рж┐ржЯрж╛рж░рзНржи ржХрж░ржмрзЗ
- ржПрж░ ржирж╛ржо `echidna` ржжрж┐рзЯрзЗ рж╢рзБрж░рзБ рж╣рждрзЗ рж╣ржмрзЗ

Echidna ржХрж░ржмрзЗ:

- ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛рж░ ржЬржирзНржп рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ ржЖрж░рзНржмрж┐ржЯрзНрж░рж╛рж░рж┐ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░ржмрзЗред
- ржХрзЛржирзЛ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ `false` рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж▓рзЗ ржмрж╛ ржХрзЛржирзЛ ржПрж░рж░ ржерзНрж░рзЛ ржХрж░рж▓рзЗ рж╕рзЗржЗ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржиржЧрзБрж▓рзЛ рж░рж┐ржкрзЛрж░рзНржЯ ржХрж░ржмрзЗред
- ржПржХржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржХрж▓ ржХрж░рж╛рж░ рж╕ржоржпрж╝ рж╕рж╛ржЗржб-ржЗржлрзЗржХрзНржЯ ржмрж╛рждрж┐рж▓ ржХрж░ржмрзЗ (ржЕрж░рзНржерж╛рзО, ржпржжрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржХрзЛржирзЛ рж╕рзНржЯрзЗржЯ ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ, ржкрж░рзАржХрзНрж╖рж╛рж░ ржкрж░рзЗ рждрж╛ ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣ржпрж╝)

ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзЗ ржпрзЗ ржХрж▓рж╛рж░рзЗрж░ ржХрж╛ржЫрзЗ 1000ржЯрж┐рж░ ржмрзЗрж╢рж┐ ржЯрзЛржХрзЗржи ржирзЗржЗ:

```solidity
function echidna_balance_under_1000() public view returns(bool){
      return balances[msg.sender] <= 1000;
}
```

ржЖржкржирж╛рж░ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯржХрзЗ ржЖржкржирж╛рж░ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржерзЗржХрзЗ ржЖрж▓рж╛ржжрж╛ ржХрж░рждрзЗ ржЗржирж╣рзЗрж░рж┐ржЯрзЗржирзНрж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи:

```solidity
contract TestToken is Token{
      function echidna_balance_under_1000() public view returns(bool){
            return balances[msg.sender] <= 1000;
      }
  }
```

[`token.sol`](https://github.com/crytic/building-secure-contracts/blob/master/program-analysis/echidna/example/token.sol) ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ржЯрж┐ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рзЗ ржПржмржВ ржЯрзЛржХрзЗржи ржерзЗржХрзЗ ржЗржирж╣рзЗрж░рж┐ржЯ ржХрж░рзЗред

### ржПржХржЯрж┐ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ рж╢рзБрж░рзБ ржХрж░рзБржи {#initiate-a-contract}

Echidna-ржПрж░ ржЬржирзНржп ржЖрж░рзНржЧрзБржорзЗржирзНржЯ ржЫрж╛рзЬрж╛ ржПржХржЯрж┐ [ржХржирзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░](/developers/docs/smart-contracts/anatomy/#constructor-functions) ржкрзНрж░рзЯрзЛржЬржиред ржпржжрж┐ ржЖржкржирж╛рж░ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЗржирж┐рж╢рж┐рзЯрж╛рж▓рж╛ржЗржЬрзЗрж╢ржи ржкрзНрж░рзЯрзЛржЬржи рж╣рзЯ, рждржмрзЗ ржЖржкржирж╛ржХрзЗ рждрж╛ ржХржирзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░рзЗрж░ ржоржзрзНржпрзЗ ржХрж░рждрзЗ рж╣ржмрзЗред

Echidna-рждрзЗ ржХрж┐ржЫрзБ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЕрзНржпрж╛ржбрзНрж░рзЗрж╕ рж░рзЯрзЗржЫрзЗ:

- `0x00a329c0648769A73afAc7F9381E08FB43dBEA72` ржпрж╛ ржХржирзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░ржХрзЗ ржХрж▓ ржХрж░рзЗред
- `0x10000`, `0x20000`, ржПржмржВ `0x00a329C0648769a73afAC7F9381e08fb43DBEA70` ржпрж╛ рж░тАНрзНржпрж╛ржирзНржбржоржнрж╛ржмрзЗ ржЕржирзНржп ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛржХрзЗ ржХрж▓ ржХрж░рзЗред

ржЖржорж╛ржжрзЗрж░ ржмрж░рзНрждржорж╛ржи ржЙржжрж╛рж╣рж░ржгрзЗ ржХрзЛржирзЛ ржмрж┐рж╢рзЗрж╖ ржЗржирж┐рж╢рж┐рзЯрж╛рж▓рж╛ржЗржЬрзЗрж╢ржирзЗрж░ ржкрзНрж░рзЯрзЛржЬржи ржирзЗржЗ, ржлрж▓рж╕рзНржмрж░рзВржк ржЖржорж╛ржжрзЗрж░ ржХржирзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░ржЯрж┐ ржЦрж╛рж▓рж┐ред

### Echidna ржЪрж╛рж▓рж╛ржи {#run-echidna}

Echidna ржЪрж╛рж▓рзБ ржХрж░рж╛ рж╣рзЯ ржПржнрж╛ржмрзЗ:

```bash
echidna-test contract.sol
```

ржпржжрж┐ contract.sol-ржП ржПржХрж╛ржзрж┐ржХ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ ржерж╛ржХрзЗ, ржЖржкржирж┐ ржЯрж╛рж░рзНржЧрзЗржЯ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи:

```bash
echidna-test contract.sol --contract MyContract
```

### рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк: ржПржХржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛ {#summary-testing-a-property}

ржирж┐ржорзНржирж▓рж┐ржЦрж┐рждржЯрж┐ ржЖржорж╛ржжрзЗрж░ ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржЙржкрж░ echidna ржЪрж╛рж▓рж╛ржирзЛрж░ рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк:

```solidity
contract TestToken is Token{
    constructor() public {}
        function echidna_balance_under_1000() public view returns(bool){
          return balances[msg.sender] <= 1000;
        }
  }
```

```bash
echidna-test testtoken.sol --contract TestToken
...

echidna_balance_under_1000: failed!ЁЯТе
  Call sequence, shrinking (1205/5000):
    airdrop()
    backdoor()

...
```

Echidna ржЦрзБржБржЬрзЗ ржкрзЗрзЯрзЗржЫрзЗ ржпрзЗ `backdoor` ржХрж▓ ржХрж░рж╛ рж╣рж▓рзЗ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ржЯрж┐ рж▓ржЩрзНржШрж┐ржд рж╣рзЯред

## ржлрж╛ржЬрж┐ржВ ржХрзНржпрж╛ржорзНржкрзЗржЗржирзЗрж░ рж╕ржоржпрж╝ ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржлрж╛ржВрж╢ржи ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ {#filtering-functions-to-call-during-a-fuzzing-campaign}

ржЖржорж░рж╛ ржжрзЗржЦржм ржлрж╛ржЬ ржХрж░рж╛ рж╣ржмрзЗ ржПржоржи ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛ ржХрзАржнрж╛ржмрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ рж╣рзЯред
ржЯрж╛рж░рзНржЧрзЗржЯ рж╣рж▓рзЛ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ:

```solidity
contract C {
  bool state1 = false;
  bool state2 = false;
  bool state3 = false;
  bool state4 = false;

  function f(uint x) public {
    require(x == 12);
    state1 = true;
  }

  function g(uint x) public {
    require(state1);
    require(x == 8);
    state2 = true;
  }

  function h(uint x) public {
    require(state2);
    require(x == 42);
    state3 = true;
  }

 function i() public {
    require(state3);
    state4 = true;
  }

  function reset1() public {
    state1 = false;
    state2 = false;
    state3 = false;
    return;
  }

  function reset2() public {
    state1 = false;
    state2 = false;
    state3 = false;
    return;
  }

  function echidna_state4() public returns (bool) {
    return (!state4);
  }
}
```

ржПржЗ ржЫрзЛржЯ ржЙржжрж╛рж╣рж░ржгржЯрж┐ Echidna-ржХрзЗ ржПржХржЯрж┐ рж╕рзНржЯрзЗржЯ ржнрзНржпрж╛рж░рж┐ржпрж╝рзЗржмрж▓ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи рж╕рж┐ржХрзЛржпрж╝рзЗржирзНрж╕ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рждрзЗ ржмрж╛ржзрзНржп ржХрж░рзЗред
ржПржЯрж┐ ржПржХржЯрж┐ ржлрж╛ржЬрж╛рж░рзЗрж░ ржЬржирзНржп ржХржарж┐ржи (ржПрж░ ржЬржирзНржп [Manticore](https://github.com/trailofbits/manticore)-ржПрж░ ржорждрзЛ ржПржХржЯрж┐ рж╕рж┐ржорзНржмрж▓рж┐ржХ ржПржХрзНрж╕рж┐ржХрж┐ржЙрж╢ржи ржЯрзБрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░ ржкрж░рж╛ржорж░рзНрж╢ ржжрзЗржУрзЯрж╛ рж╣рзЯ)ред
ржПржЯрж┐ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ Echidna ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рж┐:

```bash
echidna-test multi.sol
...
echidna_state4: passed! ЁЯОЙ
Seed: -3684648582249875403
```

### ржлрж╛ржВрж╢ржи ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ {#filtering-functions}

ржПржЗ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛рж░ ржЬржирзНржп рж╕ржарж┐ржХ рж╕рж┐ржХрзЛрзЯрзЗржирзНрж╕ ржЦрзБржБржЬрзЗ ржкрзЗрждрзЗ Echidna-ржПрж░ рж╕ржорж╕рзНржпрж╛ рж╣ржЪрзНржЫрзЗ ржХрж╛рж░ржг ржжрзБржЯрж┐ рж░рж┐рж╕рзЗржЯ ржлрж╛ржВрж╢ржи (`reset1` ржПржмржВ `reset2`) рж╕ржорж╕рзНржд рж╕рзНржЯрзЗржЯ ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓ржХрзЗ `false`-ржП рж╕рзЗржЯ ржХрж░рзЗ ржжрзЗржмрзЗред
рждржмрзЗ, ржЖржорж░рж╛ рж░рж┐рж╕рзЗржЯ ржлрж╛ржВрж╢ржиржХрзЗ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рждрзЗ ржмрж╛ рж╢рзБржзрзБржорж╛рждрзНрж░ `f`, `g`,
`h` ржПржмржВ `i` ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛржХрзЗ рж╣рзЛрзЯрж╛ржЗржЯрж▓рж┐рж╕рзНржЯ ржХрж░рждрзЗ ржПржХржЯрж┐ ржмрж┐рж╢рзЗрж╖ Echidna ржлрж┐ржЪрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред

ржлрж╛ржВрж╢ржи ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рждрзЗ, ржЖржорж░рж╛ ржПржЗ ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓ржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

```yaml
filterBlacklist: true
filterFunctions: ["reset1", "reset2"]
```

ржлрж╛ржВрж╢ржи ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛рж░ ржЖрж░рзЗржХржЯрж┐ ржЙржкрж╛рзЯ рж╣рж▓рзЛ рж╣рзЛржпрж╝рж╛ржЗржЯрж▓рж┐рж╕рзНржЯрзЗржб ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛржХрзЗ рждрж╛рж▓рж┐ржХрж╛ржнрзБржХрзНржд ржХрж░рж╛ред ржПржЯрж┐ ржХрж░рж╛рж░ ржЬржирзНржп, ржЖржорж░рж╛ ржПржЗ ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓ржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

```yaml
filterBlacklist: false
filterFunctions: ["f", "g", "h", "i"]
```

- `filterBlacklist` ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ `true` ржерж╛ржХрзЗред
- ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ рж╢рзБржзрзБржорж╛рждрзНрж░ ржирж╛ржорзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржХрж░рж╛ рж╣ржмрзЗ (ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ ржЫрж╛рзЬрж╛)ред ржЖржкржирж╛рж░ ржпржжрж┐ `f()` ржПржмржВ `f(uint256)` ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ `"f"` ржлрж┐рж▓рзНржЯрж╛рж░ржЯрж┐ ржЙржнржпрж╝ ржлрж╛ржВрж╢ржирзЗрж░ рж╕рж╛ржерзЗржЗ ржорж┐рж▓ржмрзЗред

### Echidna ржЪрж╛рж▓рж╛ржи {#run-echidna-1}

`blacklist.yaml` ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓ ржжрж┐рзЯрзЗ Echidna ржЪрж╛рж▓рж╛рждрзЗ:

```bash
echidna-test multi.sol --config blacklist.yaml
...
echidna_state4: failed!ЁЯТе
  Call sequence:
    f(12)
    g(8)
    h(42)
    i()
```

Echidna ржкрзНрж░рж╛ржпрж╝ рж╕ржЩрзНржЧрзЗ рж╕ржЩрзНржЧрзЗржЗ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ржЯрж┐ ржнрзБрж▓ ржкрзНрж░ржорж╛ржг ржХрж░рж╛рж░ ржЬржирзНржп ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржирзЗрж░ рж╕рж┐ржХрзЛржпрж╝рзЗржирзНрж╕ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░ржмрзЗред

### рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк: ржлрж╛ржВрж╢ржи ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ {#summary-filtering-functions}

Echidna ржПржХржЯрж┐ ржлрж╛ржЬрж┐ржВ ржХрзНржпрж╛ржорзНржкрзЗржЗржирзЗрж░ рж╕ржоржпрж╝ ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛржХрзЗ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржмрж╛ рж╣рзЛржпрж╝рж╛ржЗржЯрж▓рж┐рж╕рзНржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗ, ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ:

```yaml
filterBlacklist: true
filterFunctions: ["f1", "f2", "f3"]
```

```bash
echidna-test contract.sol --config config.yaml
...
```

`filterBlacklist` ржмрзБрж▓рж┐рзЯрж╛ржирзЗрж░ ржорж╛ржирзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ Echidna `f1`, `f2` ржПржмржВ `f3` ржХрзЗ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рзЗ ржмрж╛ рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржЧрзБрж▓рзЛржХрзЗ ржХрж▓ ржХрж░рзЗ ржПржХржЯрж┐ ржлрж╛ржЬрж┐ржВ ржХрзНржпрж╛ржорзНржкрзЗржЗржи рж╢рзБрж░рзБ ржХрж░рзЗред

## Echidna ржжрж┐рзЯрзЗ Solidity-ржПрж░ ржЕрзНржпрж╛рж╕рж╛рж░рзНржЯ ржХрзАржнрж╛ржмрзЗ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░ржмрзЗржи {#how-to-test-soliditys-assert-with-echidna}

ржПржЗ рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржЯрж┐ржЙржЯрзЛрж░рж┐ржпрж╝рж╛рж▓рзЗ, ржЖржорж░рж╛ ржжрзЗржЦрж╛ржм ржХрзАржнрж╛ржмрзЗ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯрзЗ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржЪрзЗржХрж┐ржВ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рждрзЗ Echidna ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛ржпрж╝ред ржзрж░рж╛ ржпрж╛ржХ ржЖржорж╛ржжрзЗрж░ ржХрж╛ржЫрзЗ ржПржЗрж░ржХржо ржПржХржЯрж┐ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ ржЖржЫрзЗ:

```solidity
contract Incrementor {
  uint private counter = 2**200;

  function inc(uint val) public returns (uint){
    uint tmp = counter;
    counter += val;
    // tmp <= counter
    return (counter - tmp);
  }
}
```

### ржПржХржЯрж┐ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи рж▓рж┐ржЦрзБржи {#write-an-assertion}

ржЖржорж░рж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рждрзЗ ржЪрж╛ржЗ ржпрзЗ `tmp` ржПрж░ ржкрж╛рж░рзНржержХрзНржп рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛рж░ ржкрж░рзЗ `counter`-ржПрж░ ржЪрзЗржпрж╝рзЗ ржХржо ржмрж╛ рж╕ржорж╛ржиред ржЖржорж░рж╛ ржПржХржЯрж┐
Echidna ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ рж▓рж┐ржЦрждрзЗ ржкрж╛рж░рждрж╛ржо, ржХрж┐ржирзНрждрзБ ржЖржорж╛ржжрзЗрж░ `tmp` ржорж╛ржиржЯрж┐ ржХрзЛржерж╛ржУ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рждрзЗ рж╣ржмрзЗред ржкрж░рж┐ржмрж░рзНрждрзЗ, ржЖржорж░рж╛ ржПржЗрж░ржХржо ржПржХржЯрж┐ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

```solidity
contract Incrementor {
  uint private counter = 2**200;

  function inc(uint val) public returns (uint){
    uint tmp = counter;
    counter += val;
    assert (tmp <= counter);
    return (counter - tmp);
  }
}
```

### Echidna ржЪрж╛рж▓рж╛ржи {#run-echidna-2}

ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржлрзЗржЗрж▓рж┐ржУрж░ ржЯрзЗрж╕рзНржЯрж┐ржВ рж╕ржХрзНрж╖ржо ржХрж░рждрзЗ, ржПржХржЯрж┐ [Echidna ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓](https://github.com/crytic/echidna/wiki/Config) `config.yaml` рждрзИрж░рж┐ ржХрж░рзБржи:

```yaml
checkAsserts: true
```

ржпржЦржи ржЖржорж░рж╛ Echidna-рждрзЗ ржПржЗ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯржЯрж┐ ржЪрж╛рж▓рж╛ржЗ, ржЖржорж░рж╛ ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржлрж▓рж╛ржлрж▓ ржкрж╛ржЗ:

```bash
echidna-test assert.sol --config config.yaml
Analyzing contract: assert.sol:Incrementor
assertion in inc: failed!ЁЯТе
  Call sequence, shrinking (2596/5000):
    inc(21711016731996786641919559689128982722488122124807605757398297001483711807488)
    inc(7237005577332262213973186563042994240829374041602535252466099000494570602496)
    inc(86844066927987146567678238756515930889952488499230423029593188005934847229952)

Seed: 1806480648350826486
```

ржЖржкржирж┐ ржжрзЗржЦрждрзЗ ржкрж╛ржЪрзНржЫрзЗржи, Echidna `inc` ржлрж╛ржВрж╢ржирзЗ ржХрж┐ржЫрзБ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржлрзЗржЗрж▓рж┐ржУрж░ рж░рж┐ржкрзЛрж░рзНржЯ ржХрж░ржЫрзЗред ржкрзНрж░рждрж┐ржЯрж┐ ржлрж╛ржВрж╢ржирзЗ ржПржХрж╛ржзрж┐ржХ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржпрзЛржЧ ржХрж░рж╛ рж╕ржорзНржнржм, ржХрж┐ржирзНрждрзБ Echidna ржмрж▓рждрзЗ ржкрж╛рж░рзЗ ржирж╛ ржХрзЛржи ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржиржЯрж┐ ржмрзНржпрж░рзНрже рж╣рзЯрзЗржЫрзЗред

### ржХржЦржи ржПржмржВ ржХрзАржнрж╛ржмрзЗ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи {#when-and-how-use-assertions}

ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржиржЧрзБрж▓рзЛ рж╕рзБрж╕рзНржкрж╖рзНржЯ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐рж░ ржмрж┐ржХрж▓рзНржк рж╣рж┐рж╕рзЗржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ, ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ ржпржжрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛рж░ рж╢рж░рзНрждржЧрзБрж▓рзЛ ржХрзЛржирзЛ `f` ржЕржкрж╛рж░рзЗрж╢ржирзЗрж░ рж╕ржарж┐ржХ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕рж╛ржерзЗ рж╕рж░рж╛рж╕рж░рж┐ рж╕ржорзНржкрж░рзНржХрж┐ржд рж╣ржпрж╝ред ржХрж┐ржЫрзБ ржХрзЛржбрзЗрж░ ржкрж░рзЗ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржпрзЛржЧ ржХрж░рж▓рзЗ рждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░ржмрзЗ ржпрзЗ ржПржЯрж┐ ржПржХрзНрж╕рж┐ржХрж┐ржЙржЯ рж╣ржУрзЯрж╛рж░ ржарж┐ржХ ржкрж░рзЗржЗ ржЪрзЗржХржЯрж┐ ржШржЯржмрзЗ:

```solidity
function f(..) public {
    // ржХрж┐ржЫрзБ ржЬржЯрж┐рж▓ ржХрзЛржб
    ...
    assert (condition);
    ...
}

```

ржмрж┐ржкрж░рзАрждрзЗ, ржПржХржЯрж┐ рж╕рзБрж╕рзНржкрж╖рзНржЯ echidna ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ рж░тАНрзНржпрж╛ржирзНржбржоржнрж╛ржмрзЗ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржПржХрзНрж╕рж┐ржХрж┐ржЙржЯ рж╣ржмрзЗ ржПржмржВ ржПржЯрж┐ ржарж┐ржХ ржХржЦржи ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржмрзЗ рждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛рж░ ржХрзЛржирзЛ рж╕рж╣ржЬ ржЙржкрж╛ржпрж╝ ржирзЗржЗред ржПржЗ ржУрзЯрж╛рж░рзНржХржЕрзНржпрж╛рж░рж╛ржЙржирзНржбржЯрж┐ ржХрж░рж╛ ржПржЦржиржУ рж╕ржорзНржнржм:

```solidity
function echidna_assert_after_f() public returns (bool) {
    f(..);
    return(condition);
}
```

рждржмрзЗ, ржХрж┐ржЫрзБ рж╕ржорж╕рзНржпрж╛ ржЖржЫрзЗ:

- ржпржжрж┐ `f`-ржХрзЗ `internal` ржмрж╛ `external` рж╣рж┐рж╕рзЗржмрзЗ ржбрж┐ржХрзНрж▓рзЗрзЯрж╛рж░ ржХрж░рж╛ рж╣ржпрж╝ рждржмрзЗ ржПржЯрж┐ ржмрзНржпрж░рзНрже рж╣ржпрж╝ред
- `f`-ржХрзЗ ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржХрзЛржи ржЖрж░рзНржЧрзБржорзЗржирзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржЙржЪрж┐ржд рждрж╛ рж╕рзНржкрж╖рзНржЯ ржирзЯред
- ржпржжрж┐ `f` рж░рж┐ржнрж╛рж░рзНржЯ ржХрж░рзЗ, ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ржЯрж┐ ржмрзНржпрж░рзНрже рж╣ржмрзЗред

рж╕рж╛ржзрж╛рж░ржгржнрж╛ржмрзЗ, ржЖржорж░рж╛ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржХрзАржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржпрж╝ рж╕рзЗ рж╕ржорзНржкрж░рзНржХрзЗ [ржЬржи рж░рзЗржЧрзЗрж░рзЗрж░ рж╕рзБржкрж╛рж░рж┐рж╢](https://blog.regehr.org/archives/1091) ржЕржирзБрж╕рж░ржг ржХрж░рж╛рж░ ржкрж░рж╛ржорж░рзНрж╢ ржжрж┐ржЗ:

- ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржЪрзЗржХрж┐ржВржпрж╝рзЗрж░ рж╕ржоржпрж╝ ржХрзЛржирзЛ рж╕рж╛ржЗржб ржПржлрзЗржХрзНржЯ ржЬрзЛрж░ ржХрж░рзЗ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░ржмрзЗржи ржирж╛ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк: `assert(ChangeStateAndReturn() == 1)`
- рж╕рзНржкрж╖рзНржЯ рж╕рзНржЯрзЗржЯржорзЗржирзНржЯ ржЕрзНржпрж╛рж╕рж╛рж░рзНржЯ ржХрж░ржмрзЗржи ржирж╛ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, `assert(var >= 0)` ржпрзЗржЦрж╛ржирзЗ `var`-ржХрзЗ `uint` рж╣рж┐рж╕рзЗржмрзЗ ржбрж┐ржХрзНрж▓рзЗрзЯрж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред

ржЕржмрж╢рзЗрж╖рзЗ, ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ `assert`-ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ `require` **ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи ржирж╛**, ржХрж╛рж░ржг Echidna ржПржЯрж┐ рж╕ржирж╛ржХрзНржд ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ (ржХрж┐ржирзНрждрзБ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯржЯрж┐ ржпрж╛ржЗрж╣рзЛржХ рж░рж┐ржнрж╛рж░рзНржЯ ржХрж░ржмрзЗ)ред

### рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк: ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржи ржЪрзЗржХрж┐ржВ {#summary-assertion-checking}

ржирж┐ржорзНржирж▓рж┐ржЦрж┐рждржЯрж┐ ржЖржорж╛ржжрзЗрж░ ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржЙржкрж░ echidna ржЪрж╛рж▓рж╛ржирзЛрж░ рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк:

```solidity
contract Incrementor {
  uint private counter = 2**200;

  function inc(uint val) public returns (uint){
    uint tmp = counter;
    counter += val;
    assert (tmp <= counter);
    return (counter - tmp);
  }
}
```

```bash
echidna-test assert.sol --config config.yaml
Analyzing contract: assert.sol:Incrementor
assertion in inc: failed!ЁЯТе
  Call sequence, shrinking (2596/5000):
    inc(21711016731996786641919559689128982722488122124807605757398297001483711807488)
    inc(7237005577332262213973186563042994240829374041602535252466099000494570602496)
    inc(86844066927987146567678238756515930889952488499230423029593188005934847229952)

Seed: 1806480648350826486
```

Echidna ржЦрзБржБржЬрзЗ ржкрзЗржпрж╝рзЗржЫрзЗ ржпрзЗ `inc`-ржПрж░ ржоржзрзНржпрзЗ ржЕрзНржпрж╛рж╕рж╛рж░рж╢ржиржЯрж┐ ржмрзНржпрж░рзНрже рж╣рждрзЗ ржкрж╛рж░рзЗ ржпржжрж┐ ржПржЗ ржлрж╛ржВрж╢ржиржЯрж┐ржХрзЗ ржмржбрж╝ ржЖрж░рзНржЧрзБржорзЗржирзНржЯ рж╕рж╣ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржХрж▓ ржХрж░рж╛ рж╣ржпрж╝ред

## ржПржХржЯрж┐ Echidna ржХрж░рзНржкрж╛рж╕ рж╕ржВржЧрзНрж░рж╣ ржПржмржВ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛ {#collecting-and-modifying-an-echidna-corpus}

ржЖржорж░рж╛ ржжрзЗржЦржм Echidna-ржПрж░ рж╕рж╛ржерзЗ ржПржХржЯрж┐ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржХрж░рзНржкрж╛рж╕ ржХрзАржнрж╛ржмрзЗ рж╕ржВржЧрзНрж░рж╣ ржПржмржВ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржпрж╝ред ржЯрж╛рж░рзНржЧрзЗржЯ рж╣рж▓рзЛ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ [`magic.sol`](https://github.com/crytic/building-secure-contracts/blob/master/program-analysis/echidna/example/magic.sol):

```solidity
contract C {
  bool value_found = false;
  function magic(uint magic_1, uint magic_2, uint magic_3, uint magic_4) public {
    require(magic_1 == 42);
    require(magic_2 == 129);
    require(magic_3 == magic_4+333);
    value_found = true;
    return;
  }

  function echidna_magic_values() public returns (bool) {
    return !value_found;
  }

}
```

ржПржЗ ржЫрзЛржЯ ржЙржжрж╛рж╣рж░ржгржЯрж┐ Echidna-ржХрзЗ ржПржХржЯрж┐ рж╕рзНржЯрзЗржЯ ржнрзНржпрж╛рж░рж┐ржпрж╝рзЗржмрж▓ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛рж░ ржЬржирзНржп ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржи ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рждрзЗ ржмрж╛ржзрзНржп ржХрж░рзЗред ржПржЯрж┐ ржПржХржЯрж┐ ржлрж╛ржЬрж╛рж░рзЗрж░ ржЬржирзНржп ржХржарж┐ржи
(ржПрж░ ржЬржирзНржп [Manticore](https://github.com/trailofbits/manticore)-ржПрж░ ржорждрзЛ ржПржХржЯрж┐ рж╕рж┐ржорзНржмрж▓рж┐ржХ ржПржХрзНрж╕рж┐ржХрж┐ржЙрж╢ржи ржЯрзБрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░ ржкрж░рж╛ржорж░рзНрж╢ ржжрзЗржУрзЯрж╛ рж╣рзЯ)ред
ржПржЯрж┐ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ Echidna ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рж┐:

```bash
echidna-test magic.sol
...

echidna_magic_values: passed! ЁЯОЙ

Seed: 2221503356319272685
```

рждржмрзЗ, ржЖржорж░рж╛ ржПржЗ ржлрж╛ржЬрж┐ржВ ржХрзНржпрж╛ржорзНржкрзЗржЗржи ржЪрж╛рж▓рж╛ржирзЛрж░ рж╕ржоржпрж╝ ржХрж░рзНржкрж╛рж╕ рж╕ржВржЧрзНрж░рж╣ ржХрж░рждрзЗ Echidna ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред

### ржПржХржЯрж┐ ржХрж░рзНржкрж╛рж╕ рж╕ржВржЧрзНрж░рж╣ ржХрж░рж╛ {#collecting-a-corpus}

ржХрж░рзНржкрж╛рж╕ рж╕ржВржЧрзНрж░рж╣ рж╕ржХрзНрж╖ржо ржХрж░рждрзЗ, ржПржХржЯрж┐ ржХрж░рзНржкрж╛рж╕ ржбрж┐рж░рзЗржХрзНржЯрж░рж┐ рждрзИрж░рж┐ ржХрж░рзБржи:

```bash
mkdir corpus-magic
```

ржПржмржВ ржПржХржЯрж┐ [Echidna ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓](https://github.com/crytic/echidna/wiki/Config) `config.yaml`:

```yaml
coverage: true
corpusDir: "corpus-magic"
```

ржПржЦржи ржЖржорж░рж╛ ржЖржорж╛ржжрзЗрж░ ржЯрзБрж▓ржЯрж┐ ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рж┐ ржПржмржВ рж╕ржВржЧрзГрж╣рзАржд ржХрж░рзНржкрж╛рж╕ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

```bash
echidna-test magic.sol --config config.yaml
```

Echidna ржПржЦржиржУ рж╕ржарж┐ржХ ржорзНржпрж╛ржЬрж┐ржХ ржнрзНржпрж╛рж▓рзБ ржЦрзБржБржЬрзЗ ржкрж╛ржЪрзНржЫрзЗ ржирж╛, рждржмрзЗ ржЖржорж░рж╛ ржПрж░ рж╕ржВржЧрзГрж╣рзАржд ржХрж░рзНржкрж╛рж╕ржЯрж┐ ржжрзЗржЦрждрзЗ ржкрж╛рж░рж┐ред
ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржПржЗ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ ржЫрж┐рж▓:

```json
[
  {
    "_gas'": "0xffffffff",
    "_delay": ["0x13647", "0xccf6"],
    "_src": "00a329c0648769a73afac7f9381e08fb43dbea70",
    "_dst": "00a329c0648769a73afac7f9381e08fb43dbea72",
    "_value": "0x0",
    "_call": {
      "tag": "SolCall",
      "contents": [
        "magic",
        [
          {
            "contents": [
              256,
              "93723985220345906694500679277863898678726808528711107336895287282192244575836"
            ],
            "tag": "AbiUInt"
          },
          {
            "contents": [256, "334"],
            "tag": "AbiUInt"
          },
          {
            "contents": [
              256,
              "68093943901352437066264791224433559271778087297543421781073458233697135179558"
            ],
            "tag": "AbiUInt"
          },
          {
            "tag": "AbiUInt",
            "contents": [256, "332"]
          }
        ]
      ]
    },
    "_gasprice'": "0xa904461f1"
  }
]
```

рж╕рзНржкрж╖рзНржЯрждржЗ, ржПржЗ ржЗржиржкрзБржЯржЯрж┐ ржЖржорж╛ржжрзЗрж░ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐рждрзЗ ржлрзЗржЗрж▓рж┐ржУрж░ ржЯрзНрж░рж┐ржЧрж╛рж░ ржХрж░ржмрзЗ ржирж╛ред рждржмрзЗ, ржкрж░ржмрж░рзНрждрзА ржзрж╛ржкрзЗ, ржЖржорж░рж╛ ржжрзЗржЦржм ржПрж░ ржЬржирзНржп ржХрзАржнрж╛ржмрзЗ ржПржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╣рзЯред

### ржПржХржЯрж┐ ржХрж░рзНржкрж╛рж╕ рж╕рж┐ржбрж┐ржВ ржХрж░рж╛ {#seeding-a-corpus}

`magic` ржлрж╛ржВрж╢ржиржЯрж┐рж░ рж╕рж╛ржерзЗ ржорзЛржХрж╛ржмрж┐рж▓рж╛ ржХрж░рж╛рж░ ржЬржирзНржп Echidna-ржПрж░ ржХрж┐ржЫрзБ рж╕рж╛рж╣рж╛ржпрзНржп ржкрзНрж░ржпрж╝рзЛржЬржиред ржЖржорж░рж╛ ржПрж░ ржЬржирзНржп ржЙржкржпрзБржХрзНржд
ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп ржЗржиржкрзБржЯржЯрж┐ ржХржкрж┐ ржПржмржВ ржоржбрж┐ржлрж╛ржЗ ржХрж░рждрзЗ ржпрж╛ржЪрзНржЫрж┐:

```bash
cp corpus/2712688662897926208.txt corpus/new.txt
```

ржЖржорж░рж╛ `magic(42,129,333,0)` ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп `new.txt` ржоржбрж┐ржлрж╛ржЗ ржХрж░ржмред ржПржЦржи, ржЖржорж░рж╛ Echidna ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рж┐:

```bash
echidna-test magic.sol --config config.yaml
...
echidna_magic_values: failed!ЁЯТе
  Call sequence:
    magic(42,129,333,0)


Unique instructions: 142
Unique codehashes: 1
Seed: -7293830866560616537

```

ржПржмрж╛рж░, ржПржЯрж┐ ржЦрзБржБржЬрзЗ ржкрзЗржпрж╝рзЗржЫрзЗ ржпрзЗ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ржЯрж┐ рж╕ржЩрзНржЧрзЗ рж╕ржЩрзНржЧрзЗ рж▓ржЩрзНржШрж┐ржд рж╣ржпрж╝рзЗржЫрзЗред

## ржЙржЪрзНржЪ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪрзЗрж░ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЦрзЛржБржЬрж╛ {#finding-transactions-with-high-gas-consumption}

ржЖржорж░рж╛ ржжрзЗржЦржм Echidna ржжрж┐рзЯрзЗ ржХрзАржнрж╛ржмрзЗ ржЙржЪрзНржЪ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪрзЗрж░ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛ ржпрж╛рзЯред ржЯрж╛рж░рзНржЧрзЗржЯ рж╣рж▓рзЛ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рж╕рзНржорж╛рж░рзНржЯ ржХржирзНржЯрзНрж░рзНржпрж╛ржХрзНржЯ:

```solidity
contract C {
  uint state;

  function expensive(uint8 times) internal {
    for(uint8 i=0; i < times; i++)
      state = state + i;
  }

  function f(uint x, uint y, uint8 times) public {
    if (x == 42 && y == 123)
      expensive(times);
    else
      state = 0;
  }

  function echidna_test() public returns (bool) {
    return true;
  }

}
```

ржПржЦрж╛ржирзЗ `expensive`-ржПрж░ ржПржХржЯрж┐ ржмрзЬ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред

ржмрж░рзНрждржорж╛ржирзЗ, Echidna-ржПрж░ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛рж░ ржЬржирзНржп рж╕ржмрж╕ржоржпрж╝ ржПржХржЯрж┐ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржкрзНрж░ржпрж╝рзЛржЬржи: ржПржЦрж╛ржирзЗ `echidna_test` рж╕ржмрж╕ржоржпрж╝ `true` рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗред
ржПржЯрж┐ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ Echidna ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рж┐:

```
echidna-test gas.sol
...
echidna_test: passed! ЁЯОЙ

Seed: 2320549945714142710
```

### ржЧрзНржпрж╛рж╕ ржЦрж░ржЪ ржкрж░рж┐ржорж╛ржк ржХрж░рж╛ {#measuring-gas-consumption}

Echidna-ржПрж░ рж╕рж╛ржерзЗ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪ рж╕ржХрзНрж╖ржо ржХрж░рждрзЗ, ржПржХржЯрж┐ ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓ `config.yaml` рждрзИрж░рж┐ ржХрж░рзБржи:

```yaml
estimateGas: true
```

ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ, ржлрж▓рж╛ржлрж▓ржЧрзБрж▓рзЛ рж╕рж╣ржЬрзЗ ржмрзЛржЭрж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи рж╕рж┐ржХрзЛржпрж╝рзЗржирзНрж╕рзЗрж░ ржЖржХрж╛рж░ржУ ржХржорж┐ржпрж╝рзЗ ржжрзЗржм:

```yaml
seqLen: 2
estimateGas: true
```

### Echidna ржЪрж╛рж▓рж╛ржи {#run-echidna-3}

ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓ рждрзИрж░рж┐ рж╣ржпрж╝рзЗ ржЧрзЗрж▓рзЗ, ржЖржорж░рж╛ ржПржЗржнрж╛ржмрзЗ Echidna ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рж┐:

```bash
echidna-test gas.sol --config config.yaml
...
echidna_test: passed! ЁЯОЙ

f used a maximum of 1333608 gas
  Call sequence:
    f(42,123,249) Gas price: 0x10d5733f0a Time delay: 0x495e5 Block delay: 0x88b2

Unique instructions: 157
Unique codehashes: 1
Seed: -325611019680165325

```

- [HEVM](https://github.com/dapphub/dapptools/tree/master/src/hevm#hevm-) ржжрзНржмрж╛рж░рж╛ ржкрзНрж░ржжрждрзНржд ржПржХржЯрж┐ ржЕржирзБржорж╛ржи рж╣рж▓рзЛ ржжрзЗржЦрж╛ржирзЛ ржЧрзНржпрж╛рж╕ред

### ржЧрзНржпрж╛рж╕-ржХржорж╛ржирзЛ ржХрж▓ржЧрзБрж▓рзЛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ {#filtering-out-gas-reducing-calls}

ржЙржкрж░рзЗ **ржлрж╛ржЬрж┐ржВ ржХрзНржпрж╛ржорзНржкрзЗржЗржирзЗрж░ рж╕ржоржпрж╝ ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржлрж╛ржВрж╢ржи ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛** ржмрж┐рж╖рзЯржХ ржЯрж┐ржЙржЯрзЛрж░рж┐ржпрж╝рж╛рж▓ржЯрж┐ ржжрзЗржЦрж╛ржпрж╝ ржХрзАржнрж╛ржмрзЗ ржЖржкржирж╛рж░ ржЯрзЗрж╕рзНржЯрж┐ржВ ржерзЗржХрзЗ ржХрж┐ржЫрзБ ржлрж╛ржВрж╢ржи рж╕рж░рж╛ржирзЛ ржпрж╛рзЯред  
ржПржХржЯрж┐ рж╕ржарж┐ржХ ржЧрзНржпрж╛рж╕ ржЕржирзБржорж╛ржи ржкрж╛ржУржпрж╝рж╛рж░ ржЬржирзНржп ржПржЯрж┐ ржЕрждрзНржпржирзНржд ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг рж╣рждрзЗ ржкрж╛рж░рзЗред
ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржЙржжрж╛рж╣рж░ржгржЯрж┐ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рзБржи:

```solidity
contract C {
  address [] addrs;
  function push(address a) public {
    addrs.push(a);
  }
  function pop() public {
    addrs.pop();
  }
  function clear() public{
    addrs.length = 0;
  }
  function check() public{
    for(uint256 i = 0; i < addrs.length; i++)
      for(uint256 j = i+1; j < addrs.length; j++)
        if (addrs[i] == addrs[j])
          addrs[j] = address(0x0);
  }
  function echidna_test() public returns (bool) {
      return true;
  }
}
```

ржпржжрж┐ Echidna рж╕ржорж╕рзНржд ржлрж╛ржВрж╢ржи ржХрж▓ ржХрж░рждрзЗ ржкрж╛рж░рзЗ, рждржмрзЗ ржПржЯрж┐ рж╕рж╣ржЬрзЗ ржЙржЪрзНржЪ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪрзЗрж░ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЦрзБржБржЬрзЗ ржкрж╛ржмрзЗ ржирж╛:

```
echidna-test pushpop.sol --config config.yaml
...
pop used a maximum of 10746 gas
...
check used a maximum of 23730 gas
...
clear used a maximum of 35916 gas
...
push used a maximum of 40839 gas
```

ржПрж░ ржХрж╛рж░ржг рж╣рж▓рзЛ ржЦрж░ржЪ `addrs`-ржПрж░ ржЖржХрж╛рж░рзЗрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗ ржПржмржВ рж░тАНрзНржпрж╛ржирзНржбржо ржХрж▓ржЧрзБрж▓рзЛ ржЕрзНржпрж╛рж░рзЗржЯрж┐ржХрзЗ ржкрзНрж░рж╛ржпрж╝ ржЦрж╛рж▓рж┐ рж░рзЗржЦрзЗ ржжрзЗржпрж╝ред
рждржмрзЗ, `pop` ржПржмржВ `clear`-ржХрзЗ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржХрж░рж╛ ржЖржорж╛ржжрзЗрж░ ржЕржирзЗржХ ржнрж╛рж▓рзЛ ржлрж▓рж╛ржлрж▓ ржжрзЗрзЯ:

```yaml
filterBlacklist: true
filterFunctions: ["pop", "clear"]
```

```
echidna-test pushpop.sol --config config.yaml
...
push used a maximum of 40839 gas
...
check used a maximum of 1484472 gas
```

### рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк: ржЙржЪрзНржЪ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪрзЗрж░ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЦрзЛржБржЬрж╛ {#summary-finding-transactions-with-high-gas-consumption}

`estimateGas` ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржЕржкрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ Echidna ржЙржЪрзНржЪ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪрзЗрж░ ржЯрзНрж░рж╛ржиржЬрзНржпрж╛ржХрж╢ржи ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗ:

```yaml
estimateGas: true
```

```bash
echidna-test contract.sol --config config.yaml
...
```

ржлрж╛ржЬрж┐ржВ ржХрзНржпрж╛ржорзНржкрзЗржЗржи рж╢рзЗрж╖ рж╣ржпрж╝рзЗ ржЧрзЗрж▓рзЗ Echidna ржкрзНрж░рждрж┐ржЯрж┐ ржлрж╛ржВрж╢ржирзЗрж░ ржЬржирзНржп рж╕рж░рзНржмрзЛржЪрзНржЪ ржЧрзНржпрж╛рж╕ ржЦрж░ржЪрзЗрж░ ржПржХржЯрж┐ рж╕рж┐ржХрзЛрзЯрзЗржирзНрж╕ рж░рж┐ржкрзЛрж░рзНржЯ ржХрж░ржмрзЗред
