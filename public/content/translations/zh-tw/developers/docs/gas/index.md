---
title: 燃料和費用
metaTitle: "以太坊燃料和費用：技術概覽"
description: 了解以太坊 Gas Fee、其計算方式，以及在網路安全和交易處理中的作用。
lang: zh-tw
---

燃料對於以太坊網路至關重要。 燃料讓以太坊得以運轉，就像是汽車需要汽油行駛一樣。

## 先決條件 {#prerequisites}

為更佳理解本頁面，我們建議您先閱讀關於 [交易](/developers/docs/transactions/) 和 [EVM](/developers/docs/evm/) 的內容。

## 什麼是燃料？ {#what-is-gas}

燃料是衡量在以太坊網路上執行特定操作所需計算工作量的單位。

因為執行每一筆以太坊交易都需要計算資源，要使用這些資源就必須付費，以確保以太坊不會受到垃圾訊息的影響，或者卡在無窮計算迴圈中。 計算費用以燃料費的形式支付。

燃料費用是**執行某些操作所使用的燃料數量，乘以每單位燃料的成本**。 無論交易成功與否，都要支付燃料費。

![一張圖表顯示 EVM 操作中哪裡需要燃料](./gas.png)
_圖表改編自 [以太坊 EVM 圖解](https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf)_

燃料費須用以太坊原生貨幣以太幣 (ETH) 支付。 燃料價格一般會以 gwei 為單位，gwei 是以太幣的面額之一。 每一 gwei 等於一以太幣的十億分之一（0.000000001 以太幣或 10<sup>-9</sup> 以太幣）。

舉例來說，可以說你的燃料費為 1 gwei，而不是 0.000000001 以太幣。

「gwei」這個字是「giga-wei」的縮寫，意思是「10 億 wei」。 1 gwei 等於 10 億 wei。 Wei 本身（以 [b-money](https://www.investopedia.com/terms/b/bmoney.asp) 創始人 [戴維](https://wikipedia.org/wiki/Wei_Dai) 的名字命名）是 ETH 的最小單位。

## 燃料費是如何計算的？ {#how-are-gas-fees-calculated}

提交交易時，可以設定你願意支付的燃料費數量。 藉由提供一定數量的燃料費，你實際上是在出價，以便將你的交易加入下一個區塊。 如果你的報價過低，驗證者就不太可能選擇將你的交易加入下一個區塊，代表你的交易可能會延遲或根本不會被執行。 如果你報價過高，則可能會浪費一些以太幣。 那麼，該如何判定支付多少費用呢？

您支付的總燃料費分為兩個部分：`基本費用` 和 `優先費用` (小費)。

`基本費用` 由協議設定——您必須至少支付此金額，您的交易才算有效。 `優先費用` 是您加在基本費用上的小費，用來吸引驗證程式，讓他們選擇將您的交易納入下一個區塊。

僅支付 `基本費用` 的交易在技術上有效，但不太可能被納入，因為它沒有提供任何誘因讓驗證程式優先選擇它，而不是其他任何交易。 「正確的」`優先`費用取決於您傳送交易時的網路使用情況——如果需求量大，您可能需要設定較高的 `優先`費用，但當需求較少時，您可以支付較少的費用。

舉例來說，假設 Jordan 要付給 Taylor 1 以太幣。 以太幣轉帳需要 21,000 單位的燃料，而基本費用為 10 gwei。 Jordan 支付 2 gwei 小費。

現在總燃料費為：

`已使用的燃料單位 * (基本費用 + 優先費用)`

其中，`基本費用` 的值由協議設定，而 `優先費用` 的值則是由使用者設置，是給驗證程式的小費。

例如 `21,000 * (10 + 2) = 252,000 gwei` (0.000252 ETH)。

當 Jordan 發送該金額時，1.000252 以太幣將從 Jordan 的帳戶中扣除。 而 Taylor 將獲得 1.0000 以太幣。 驗證者將收到 0.000042 以太幣的小費。 0.00021 ETH 的 `基本費用` 被銷毀。

### 基本費用 {#base-fee}

每個區塊都有基本費用作為底價。 為了達成添加至區塊中的條件，提供的每單位燃料價格必須至少等於基本費用。 基本費用的計算與當前區塊無關，而是由其之前的區塊決定，讓使用者的交易費用更具可預測性。 建立區塊時，此**基本費用會被\"銷毀\"**，從流通中移除。

基本費用是根據一個公式計算出來的，該公式將前一個區塊的大小 (所有交易使用的燃料量) 與目標大小 (燃料限制的一半) 進行比較。 如果目標區塊大小分別高於或低於目標，每個區塊的基本費用最多將增加或減少 12.5%。 這種指數級增長讓區塊大小無限增加在經濟上不可行。

| 區塊編號 | 包含燃料 |                  費用增幅 |                     當前基本費用 |
| ---- | ---: | --------------------: | -------------------------: |
| 1    |  18M |                    0% |                   100 gwei |
| 2    |  36M |                    0% |                   100 gwei |
| 3    |  36M | 12.5% | 112.5 gwei |
| 4    |  36M | 12.5% | 126.6 gwei |
| 5    |  36M | 12.5% | 142.4 gwei |
| 6    |  36M | 12.5% | 160.2 gwei |
| 7    |  36M | 12.5% | 180.2 gwei |
| 8    |  36M | 12.5% | 202.7 gwei |

上表中，以 3600 萬作為燃料限制為例進行了示範。 以上表為例，若要在第 9 號區塊建立交易，錢包會讓使用者明確知道，要新增至下一個區塊的**最高基本費用**為 `目前的基本費用 * 112.5%` 或 `202.7 gwei * 112.5% = 228.1 gwei`。

值得注意的是，因為基本費用在區塊變滿之前增加的速度很快，我們不太可能看到大量已滿區塊連續出現。

| 區塊編號                                                |                                                包含燃料 |                  費用增幅 |                                              當前基本費用 |
| --------------------------------------------------- | --------------------------------------------------: | --------------------: | --------------------------------------------------: |
| 30                                                  |                                                 36M | 12.5% |                         2705.6 gwei |
| ... | ... | 12.5% | ... |
| 50                                                  |                                                 36M | 12.5% |                        28531.3 gwei |
| ... | ... | 12.5% | ... |
| 100                                                 |                                                 36M | 12.5% |                     10302608.6 gwei |

### 優先費用 (小費) {#priority-fee}

優先費用 (小費) 旨在激勵驗證程式在區塊燃料限制的範圍內，盡可能將區塊內的交易數量最大化。 若沒有小費，理性的驗證程式可能會納入較少，甚至是零筆交易，且不會受到執行層或共識層的直接懲罰，因為質押獎勵與區塊中的交易數量無關。 此外，小費讓使用者能以更高價格在同一個區塊中取得優先處理權，有效地表達交易的急迫性。

### 最高費用 {#maxfee}

要在網路上執行交易，使用者可以指定為了執行其交易他們願意支付的最大費用限制。 此選用參數稱為 `maxFeePerGas`。 執行交易所需的最大費用必須超過基本費用與小費的總和。 會向交易發送者退還最大費用與基本費用和小費之總合之間的差額。

### 區塊大小 {#block-size}

每個區塊的目標大小是目前燃料限制的一半，但區塊大小會根據網路需求增減，直到達到區塊上限 (目標區塊大小的 2 倍)。 協議透過 _tâtonnement_ (試探) 過程，使平均區塊大小達到目標值的均衡狀態。 這意味著，如果區塊大小大於目標區塊大小，協議將增加下一個區塊的基本費用。 同樣，如果區塊大小小於目標區塊大小，協議將減少基本費用。

基本費用的調節額度與實際區塊大小與目標區塊大小之間的差異成比例。 這是線性計算：空區塊為 -12.5%，達到目標大小時為 0%，達到燃料限制時最高為 +12.5%。 燃料限制會根據驗證程式的信號以及網路升級而隨時間波動。 您可以在[此處查看燃料限制隨時間的變化](https://eth.blockscout.com/stats/averageGasLimit?interval=threeMonths)。

[更多關於區塊的資訊](/developers/docs/blocks/)

### 實務上如何計算燃料費用 {#calculating-fees-in-practice}

可明確聲明願意支付多少費用，以讓驗證者執行你的交易。 然而，大多數錢包提供商會自動設定推薦的交易費（基本費用 + 推薦的優先費），以降低使用者面臨的複雜度。

## 為何需要燃料費？ {#why-do-gas-fees-exist}

簡言之，燃料費可幫助保障以太坊網路安全。 透過要求為網路上執行的每次計算支付費用，可以阻止惡意行為者利用垃圾郵件攻擊網路。 為避免程式碼中出現意外或是惡意的無限迴圈或其他計算浪費，對於每筆交易，都必須設定一個關於可以使用程式碼執行中多少個計算步驟的限制。 計算的基本單位為「燃料」。

雖然交易設有上限，但交易中任何未使用的燃料都會退還給使用者 (例如，退還的金額為 `最高費用 - (基本費用 + 小費)`)。

![圖表顯示未使用的燃料如何退款](../transactions/gas-tx.png)
_圖表改編自 [以太坊 EVM 圖解](https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf)_

## 什麼是燃料限制？ {#what-is-gas-limit}

燃料限制指的是你在一筆交易中最多願意使用多少燃料。 涉及 [智能合約](/developers/docs/smart-contracts/) 的更複雜交易需要更多計算工作，因此需要的燃料限制比簡單的支付更高。 標準以太幣轉帳需要的燃料限制為 21,000 單位燃料。

例如，如果為一次簡單的以太幣轉帳設定了 50,000 的燃料限制，以太坊虛擬機將消耗 21,000 單位燃料並退還剩餘的 29,000。 然而，如果你指定的 gas 過少，例如，對於一筆簡單的 ETH 轉移，gas 限制設置爲 20,000，那麽交易將在驗證階段失敗。 它會在被包含在區塊之前被拒絕，并且不會消耗任何 gas。 另一方面，如果交易在執行過程中耗盡了 gas（例如，智能合約在執行過程中耗盡了所有 gas），以太坊虛擬機將回滾所有更改，但已提供的 gas 仍將用於已完成的工作。

## 為何燃料費這麼高？ {#why-can-gas-fees-get-so-high}

燃料費高是因為以太坊人氣高。 如果需求過高，使用者必須支付更高的小費，以便超出其他使用者的交易報價。 小費越高，你的交易添加到下一個區塊中的可能性越大。 另外，越複雜的智慧型合約應用程式可能會執行大量操作，以支援其函式，這會消耗許多燃料。

## 降低燃料成本的措施 {#initiatives-to-reduce-gas-costs}

以太坊的[可擴展性升級](/roadmap/) 最終應能解決一些燃料費用問題，從而使該平台能夠每秒處理數千筆交易並在全球範圍內擴展。

二層網路擴容為一項主要倡議，可大幅減低燃料費用並加強用戶體驗及可擴容性。

[更多關於 Layer 2 擴展的資訊](/developers/docs/scaling/#layer-2-scaling)

## 監控燃料費用 {#monitoring-gas-fees}

若你想要監控燃料價格，以便能以更低的費用發送以太幣，你可以使用許多不同的工具，例如：

- [Etherscan](https://etherscan.io/gastracker) _交易燃料價格估算器_
- [Blockscout](https://eth.blockscout.com/gas-tracker) _開源交易燃料價格估算器_
- [ETH Gas Tracker](https://www.ethgastracker.com/) _監控和追蹤以太坊和 L2 的燃料價格，以降低交易費用並節省資金_
- [Blocknative ETH Gas Estimator](https://chrome.google.com/webstore/detail/blocknative-eth-gas-estim/ablbagjepecncofimgjmdpnhnfjiecfm) _支援類型 0 傳統交易和類型 2 EIP-1559 交易的燃料估算 Chrome 擴充功能。_
- [Cryptoneur Gas Fees Calculator](https://www.cryptoneur.xyz/gas-fees-calculator) _在主網、Arbitrum 和 Polygon 上，為不同交易類型以您的當地貨幣計算燃料費用。_

## 相關工具 {#related-tools}

- [Blocknative's Gas Platform](https://www.blocknative.com/gas) _由 Blocknative 的全球記憶體池資料平台提供支援的燃料估算 API_
- [Gas Network](https://gas.network) 鏈上燃料預言機。 支援超過 35 條鏈。

## 延伸閱讀 {#further-reading}

- [以太坊燃料說明](https://defiprime.com/gas)
- [降低您智能合約的燃料消耗](https://medium.com/coinmonks/8-ways-of-reducing-the-gas-consumption-of-your-smart-contracts-9a506b339c0a)
- [開發人員的燃料最佳化策略](https://www.alchemy.com/overviews/solidity-gas-optimization)
- [EIP-1559 文件](https://eips.ethereum.org/EIPS/eip-1559)。
- [Tim Beiko 的 EIP-1559 資源](https://hackmd.io/@timbeiko/1559-resources)
- [EIP-1559：將機制與迷因區分開來](https://web.archive.org/web/20241126205908/https://research.2077.xyz/eip-1559-separating-mechanisms-from-memes)
