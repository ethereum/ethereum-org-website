---
title: Proof-of-stake против proof-of-work
description: Сравнение между механизмом консенсуса proof-of-stake и proof-of-work в сети Ethereum
lang: ru
---

Когда Ethereum был запущен, механизм доказательства владения (proof-of-stake) все еще требовал большого количества исследований и разработок, прежде чем ему можно было доверить обеспечение безопасности Ethereum. Механизм доказательства работы (proof-of-work) был более простым механизмом, который уже был проверен биткоином. Это означало, что основные разработчики могли немедленно реализовать его для запуска Ethereum. Потребовалось еще восемь лет, чтобы довести механизм доказательства владения (proof-of-stake) до такого состояния, чтобы его можно было реализовать.

На этой странице объясняются причины перехода Ethereum с механизма доказательства работы (proof-of-work) на механизм доказательства владения (proof-of-stake), а также связанные с этим компромиссы.

## Безопасность {#security}

Исследователи Ethereum считают механизм proof-of-stake более безопасным, чем proof-of-work. Однако, он совсем недавно был внедрён в основную сеть Ethereum и не прошел достаточную проверку временем, как proof-of-work. В этом разделе рассматриваются плюсы и минусы модели безопасности механизма proof-of-stake по сравнению с proof-of-work.

### Стоимость атаки {#cost-to-attack}

При proof-of-stake, валидаторы обязаны задепонировать ("застейкать") как минимум 32 ETH в смарт-контракте. Сеть Ethereum оставляет за собой право уничтожить застейканый эфир, чтобы наказать валидаторов за несоблюдение правил. Чтобы добиться консенсуса, как минимум 66% от всего застейканого эфира должны проголосовать за определённый набор блоков. Блоки, за которые проголосовали >=66% от общей доли, становятся "финализированными", то есть их нельзя удалить или реорганизовать.

Атака на сеть может означать предотвращение финализации цепочки или обеспечение определенной организации блоков в канонической цепи, что каким-то образом выгодно атакующему. Для этого злоумышленнику необходимо отклонить путь честного консенсуса либо путем накопления большого количества эфира и прямого голосования с его помощью, либо обманом заставить честных валидаторов проголосовать определенным образом. Помимо сложных, маловероятных атак, которые обманывают честных валидаторов, стоимость атаки на Ethereum — это стоимость доли, которую злоумышленник должен накопить, чтобы повлиять на консенсус в свою пользу.

Минимальная стоимость атаки составляет >33% от общей доли. Злоумышленник, владеющий >33% от общей доли, может вызвать задержку финализации, просто отключившись от сети. Это относительно незначительная проблема для сети, поскольку существует механизм, известный как "утечка из-за неактивности", который выводит долю из оффлайн-валидаторов до тех пор, пока онлайн-большинство не будет составлять 66% доли и не сможет снова финализировать цепочку. Теоретически также возможно, что злоумышленник вызовет двойную финализацию, имея чуть более 33% от общей доли, создав два блока вместо одного, когда его попросят стать производителем блока, а затем дважды проголосовав всеми своими валидаторами. Каждый форк требует, чтобы 50% оставшихся честных валидаторов сначала увидели каждый блок, поэтому, если им удастся правильно рассчитать время отправки своих сообщений, они смогут финализировать оба форка. Вероятность успеха этого мала, но если бы злоумышленник смог вызвать двойную финализацию, сообществу Ethereum пришлось бы решить, какому форку следовать, и в этом случае валидаторы злоумышленника обязательно были бы подвергнуты слэшингу на другом форке.

Имея >33% от общей доли, злоумышленник имеет шанс оказать незначительное (задержка финализации) или более серьезное (двойная финализация) влияние на сеть Ethereum. При наличии более 14 000 000 ETH в стейкинге в сети и репрезентативной цене 1000 долларов США за ETH минимальная стоимость проведения этих атак составляет `1000 x 14 000 000 x 0,33 = 4 620 000 000 долларов США`. Злоумышленник потеряет эти деньги в результате слэшинга и будет исключен из сети. Чтобы атаковать снова, им придется (снова) накопить >33% доли и (снова) сжечь ее. Каждая попытка атаки на сеть будет стоить >4,6 миллиарда долларов (при цене 1000 долларов за ETH и 14 млн ETH в стейкинге). Злоумышленник также исключается из сети, когда его валидаторы подвергаются слэшингу, и для повторного присоединения он должен встать в очередь активации. Это означает, что скорость повторной атаки ограничивается не только скоростью, с которой злоумышленник может накопить >33% от общей доли, но и временем, которое требуется для подключения всех его валидаторов к сети. Каждый раз, когда злоумышленник атакует, он становится намного беднее, а остальная часть сообщества становится богаче благодаря возникающему шоку предложения.

Другие атаки, такие как атаки 51% или отмена финализации с 66% общей доли, требуют значительно больше ETH и являются гораздо более дорогостоящими для злоумышленника.

Сравните это с механизмом доказательства работы. Стоимость атаки на Ethereum с механизмом доказательства работы (proof-of-work) была равна стоимости постоянного владения >50% общего хешрейта сети. Это сводилось к затратам на оборудование и эксплуатационным расходам на достаточную вычислительную мощность, чтобы постоянно опережать других майнеров в вычислении решений для доказательства работы. Ethereum в основном майнился с использованием GPU, а не ASIC, что снижало затраты (хотя, если бы Ethereum остался на механизме доказательства работы, майнинг на ASIC мог бы стать более популярным). Злоумышленнику пришлось бы приобрести много оборудования и оплатить электроэнергию для его работы, чтобы атаковать сеть Ethereum на основе механизма доказательства работы, но общая стоимость была бы меньше, чем стоимость, необходимая для накопления достаточного количества ETH для начала атаки. Атака 51% на ~[20 раз дешевле](https://youtu.be/1m12zgJ42dI?t=1562) при использовании механизма доказательства работы (proof-of-work), чем при использовании механизма доказательства владения (proof-of-stake). Если бы атака была обнаружена, а в цепи был проведен хардфорк для удаления внесенных изменений, злоумышленник мог бы многократно использовать то же самое оборудование для атаки на новый форк.

### Сложность {#complexity}

Механизм доказательства владения (proof-of-stake) намного сложнее, чем механизм доказательства работы (proof-of-work). Это можно считать аргументом в пользу механизма доказательства работы (proof-of-work), поскольку в более простые протоколы сложнее случайно внести ошибки или непреднамеренные эффекты. Однако сложность была преодолена благодаря многолетним исследованиям и разработкам, симуляциям и внедрениям в тестовых сетях. Протокол доказательства владения (proof-of-stake) был независимо реализован пятью отдельными командами (на каждом из уровней исполнения и консенсуса) на пяти языках программирования, что обеспечивает устойчивость к ошибкам клиентов.

Для безопасной разработки и тестирования логики консенсуса на основе доказательства владения (proof-of-stake) сеть Beacon Chain была запущена за два года до внедрения этого механизма в основной сети Ethereum. Сеть Beacon Chain выступала в роли "песочницы" для тестирования механизма доказательства владения (proof-of-stake), поскольку это был действующий блокчейн, реализующий логику консенсуса на основе доказательства владения, но не затрагивающий реальные транзакции Ethereum — по сути, он просто приходил к консенсусу относительно самого себя. Как только эта система проработала стабильно и без ошибок достаточное время, Beacon Chain была "объединена" с основной сетью Ethereum. Все это способствовало укрощению сложности механизма доказательства владения (proof-of-stake) до такой степени, что риск непреднамеренных последствий или ошибок клиента стал очень низким.

### Поверхность атаки {#attack-surface}

Механизм доказательства владения (proof-of-stake) сложнее, чем механизм доказательства работы (proof-of-work), а это означает, что существует больше потенциальных векторов атак, которые необходимо учитывать. Вместо одной одноранговой сети, соединяющей клиентов, есть две, каждая из которых реализует отдельный протокол. Предварительный выбор одного конкретного валидатора для предложения блока в каждом слоте создает потенциал для атак типа «отказ в обслуживании», когда большие объемы сетевого трафика выводят этого конкретного валидатора из строя.

Существуют также способы, с помощью которых злоумышленники могут тщательно рассчитывать время выпуска своих блоков или аттестаций, чтобы их получала определенная часть честной сети, влияя на их голосование определенным образом. Наконец, злоумышленник может просто накопить достаточно ETH для стейкинга и доминировать в механизме консенсуса. Для каждого из этих [векторов атак существуют соответствующие средства защиты](/developers/docs/consensus-mechanisms/pos/attack-and-defense), но в механизме доказательства работы (proof-of-work) они не существуют, чтобы от них защищаться.

## Децентрализация {#decentralization}

Механизм доказательства владения (proof-of-stake) более децентрализован, чем механизм доказательства работы (proof-of-work), потому что гонка вооружений в области оборудования для майнинга, как правило, вытесняет с рынка частных лиц и небольшие организации. Хотя технически любой может начать майнинг на скромном оборудовании, вероятность получения какого-либо вознаграждения ничтожно мала по сравнению с институциональными майнинговыми операциями. При использовании механизма доказательства владения (proof-of-stake) стоимость стейкинга и процентная доходность от этой доли одинаковы для всех. В настоящее время запуск валидатора стоит 32 ETH.

С другой стороны, изобретение деривативов ликвидного стейкинга вызвало опасения по поводу централизации, поскольку несколько крупных провайдеров управляют большими объемами ETH в стейкинге. Это проблематично и требует скорейшего исправления, но в то же время здесь больше нюансов, чем кажется. Централизованные провайдеры стейкинга не обязательно имеют централизованный контроль над валидаторами — часто это просто способ создать центральный пул ETH, который многие независимые операторы узлов могут использовать для стейкинга, не требуя от каждого участника наличия собственных 32 ETH.

Лучший вариант для Ethereum — это запуск валидаторов локально на домашних компьютерах, что максимизирует децентрализацию. Вот почему Ethereum сопротивляется изменениям, которые увеличивают требования к оборудованию для запуска узла/валидатора.

## Устойчивость {#sustainability}

Механизм доказательства владения (proof-of-stake) — это способ обеспечения безопасности блокчейна с низким уровнем выбросов углерода. В рамках механизма доказательства работы (proof-of-work) майнеры соревнуются за право добыть блок. Майнеры более успешны, когда они могут выполнять вычисления быстрее, что стимулирует инвестиции в оборудование и потребление энергии. Это наблюдалось в Ethereum до его перехода на механизм доказательства владения (proof-of-stake). Незадолго до перехода на механизм доказательства владения (proof-of-stake) Ethereum потреблял примерно 78 ТВтч/год — столько же, сколько небольшая страна. Однако переход на механизм доказательства владения (proof-of-stake) сократил эти энергозатраты примерно на 99,98%. Механизм доказательства владения (proof-of-stake) сделал Ethereum энергоэффективной платформой с низким уровнем выбросов углерода.

[Подробнее об энергопотреблении Ethereum](/energy-consumption)

## Эмиссия {#issuance}

Ethereum с механизмом доказательства владения (proof-of-stake) может платить за свою безопасность, выпуская гораздо меньше монет, чем Ethereum с механизмом доказательства работы (proof-of-work), поскольку валидаторам не нужно платить высокие затраты на электроэнергию. В результате инфляция ETH может снизиться или даже стать дефляционной, когда сжигаются большие объемы ETH. Более низкие уровни инфляции означают, что безопасность Ethereum обходится дешевле, чем при использовании механизма доказательства работы (proof-of-work).

## Больше увлекаетесь визуализацией? {#visual-learner}

Посмотрите, как Джастин Дрейк объясняет преимущества механизма доказательства владения (proof-of-stake) по сравнению с механизмом доказательства работы (proof-of-work):

<YouTube id="1m12zgJ42dI" />

## Дополнительные материалы {#further-reading}

- [Философия дизайна доказательства владения (proof-of-stake) от Виталика](https://medium.com/@VitalikButerin/a-proof-of-stake-design-philosophy-506585978d51)
- [Часто задаваемые вопросы о доказательстве владения (proof-of-stake) от Виталика](https://vitalik.eth.limo/general/2017/12/31/pos_faq.html#what-is-proof-of-stake)
- [Видео "Просто о сложном" о PoS против PoW](https://www.youtube.com/watch?v=M3EFi_POhps)
