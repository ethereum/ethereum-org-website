---
title: Механизмы консенсуса
description: Объяснение протоколов консенсуса в распределенных системах и роль, которую они играют в Ethereum.
lang: ru
---

Термин 'механизм консенсуса' часто используется в разговорной речи для обозначения 'proof-of-stake', 'proof-of-work' или 'proof-of-authority' протоколов. Однако это всего лишь компоненты в механизмах консенсуса, которые защищают от [атак Сибиллы](/glossary/#sybil-attack). Механизмы консенсуса - это полный набор идей, протоколов и стимулов, позволяющих распределённому набору узлов договариваться о состоянии блокчейна.

## Предварительные условия {#prerequisites}

Для лучшего понимания этой страницы мы рекомендуем вам сначала прочитать [введение в Ethereum](/developers/docs/intro-to-ethereum/).

## Что такое консенсус? {#what-is-consensus}

Под консенсусом мы подразумеваем достижение общего согласия. Рассмотрим группу людей, идущих в кино. Если нет разногласия по предлагаемому выбору фильма, то консенсус достигнут. Если есть разногласия, то группа должна иметь способ для решения, какой фильм смотреть. В крайних случаях группа в конце концов разделится.

Что касается блокчейна Ethereum, этот процесс формализован, и достижение консенсуса означает, что не менее 66 % узлов в сети согласны с глобальным состоянием сети.

## Что такое механизм консенсуса? Что такое механизм консенсуса? {#what-is-a-consensus-mechanism}

Термин механизм консенсуса относится ко всему стеку протоколов, стимулам и идеям, позволяющим сети узлов согласовывать состояние блокчейна.

Ethereum использует механизм консенсуса, основанный на proof-of-stake, который является следствием своей криптовалютной экономической безопасности от набора вознаграждений и штрафов, применяемых к капиталу, закрытому для дольщиков. Эта структура стимулов поощряет отдельных дольщиков быть честными валидаторами, наказывает тех, кто ими не является, и значительно усложняет атаку на сеть.

Кроме этого, имеется протокол, который управляет процессом выбора честных валидаторов для предложения или валидации блоков, обработки транзакций и голосования за главу цепочки. В редких ситуациях, когда несколько блоков находится в одном и том же положении вблизи главы цепочки, применяется механизм выбора ветки, который выбирает блоки, составляющие "самую тяжелую" цепочку по результатам измерений ряда валидаторов, голосовавших за блоки с учетом их баланса эфира.

Некоторые концепции, явно не определенные в коде, важны для консенсуса, например, дополнительная безопасность, обеспечиваемая потенциальной внеполосной социальной координацией, в виде последней линии защиты от атак на сеть.

Эти компоненты вместе образуют механизм консенсуса.

## Типы механизмов консенсуса {#types-of-consensus-mechanisms}

### Доказательство работы {#proof-of-work}

Подобно Биткоину, Ethereum когда-то использовал протокол консенсуса, основанный на **доказательстве работы (PoW)**.

#### Создание блока {#pow-block-creation}

Майнеры соревнуются за создание новых блоков, заполненных обработанными транзакциями. Победитель делится новым блоком с остальной сетью и зарабатывает свежевыпущенные ETH. Гонка выиграна компьютером, который способен всех быстрее решить математическую головоломку. Это порождает криптографическую связь между текущим блоком и предыдущим блоком. Решение этой задачи — это и есть работа в системе с доказательством работы. Затем каноническая цепочка определяется правилом выбора форка, выбирающим набор блоков, для майнинга которых было проделано больше всего работы.

#### Безопасность {#pow-security}

Сеть защищена тем, что вам понадобится 51 % вычислительной мощности сети для компрометации цепочки. Это потребует огромных инвестиций в оборудование и энергию. Вероятно, придется потратить больше, чем удастся получить.

Подробнее о [доказательстве работы](/developers/docs/consensus-mechanisms/pow/)

### Доказательство владения {#proof-of-stake}

Сейчас Ethereum использует протокол консенсуса, основанный на **доказательстве владения (PoS)**.

#### Создание блока {#pos-block-creation}

Валидаторы создают блоки. Один валидатор, выбранный случайным образом в каждом слоте в качестве предлагающего блоков. Их консенсусные клиенты требуют объединения транзакций в 'исполняемую полезную нагрузку' от своего парного клиента исполнения. Они оборачивают ”полезную нагрузку на выполнение" в согласованные данные, чтобы сформировать блок, который они отправляют другим узлам сети Ethereum. Производство этого блока награждается в ETH. В редких случаях, когда в одном слоте имеется несколько возможных блоков-кандидатов или если узлы получают информацию о блоке в разное время, алгоритм выбора вилки выбирает блок, который образует цепочку с наибольшим весом подтверждения (где вес - это количество валидаторов, масштабированное по их балансу ETH).

#### Безопасность {#pos-security}

A proof-of-stake system is secure crypto-economically because an attacker attempting to take control of the chain must destroy a massive amount of ETH. Система вознаграждений побуждает отдельных игроков вести себя честно, а штрафы не позволяют действовать злонамеренно.

Подробнее о [доказательстве владения](/developers/docs/consensus-mechanisms/pos/)

### Визуальное руководство {#types-of-consensus-video}

Узнайте больше о различных типах механизмов консенсуса, используемых в Ethereum:

<YouTube id="ojxfbN78WFQ" />

### Устойчивость к атаке Сибиллы и выбор цепи {#sybil-chain}

Доказательство работы(PoW) и доказательство владения(PoS) не являются протоколами консенсуса, но они часто называются ими для простоты восприятия. На самом деле они являются механизмами сопротивления атаке Сибиллы и селекторами авторов блоков. Они позволяют решить, кто является автором последнего блока. Другой важнейший компонент это алгоритм выбора цепочки (выбора ветвления), позволяющий узлам выбрать последний корректный блок в цепи, в которой существует несколько блоков в одной позиции.

**Устойчивость к атаке Сибиллы** показывает, насколько хорошо протокол противостоит атаке Сибиллы. Устойчивость к этому типу атак имеет важное значение для децентрализованного блокчейна и позволяет майнерам и валидаторам получать одинаковое вознаграждение в зависимости от вложенных ресурсов. Доказательство работы и доказательство владения защищают от этого, заставляя пользователей тратить много энергии или вносить большой залог. Эти средства защиты являются экономическим сдерживающим фактором для атак Сибиллы.

**Правило выбора цепи** используется, чтобы решить, какая цепь является "правильной". Биткоин использует правильно "самой длинной цепи", которое означает что самая длинная цепочка в сети будет принята за действительную и остальные узлы будут обрабатывать её. Для цепей с доказательством работы самая длинная цепочка определяется общей совокупной сложностью выполненной работы. Эфириум, так же использует правило самой длинной цепи. Однако сейчас, Эфириум перешёл на доказательство владения(PoS) и принял обновленный алгоритм ветвления выбора, который измеряет "вес" цепи. Вес - это сумма голосов валидаторов, которая выражается в размере их владения токенами Ethereum(Eth).

Ethereum использует механизм консенсуса, известный как [Gasper](/developers/docs/consensus-mechanisms/pos/gasper/), который сочетает [доказательство владения Casper FFG](https://arxiv.org/abs/1710.09437) с [правилом выбора форка GHOST](https://arxiv.org/abs/2003.03052).

## Дополнительные материалы {#further-reading}

- [Что такое алгоритм консенсуса в блокчейне?](https://academy.binance.com/en/articles/what-is-a-blockchain-consensus-algorithm)
- [Что такое консенсус Накамото? Полное руководство для начинающих](https://blockonomi.com/nakamoto-consensus/)
- [Как работает Casper?](https://medium.com/unitychain/intro-to-casper-ffg-9ed944d98b2d)
- [О безопасности и производительности блокчейнов с доказательством работы](https://eprint.iacr.org/2016/555.pdf)
- [Византийская ошибка](https://en.wikipedia.org/wiki/Byzantine_fault)

_Знаете ресурс сообщества, который вам пригодился? Измените эту страницу и добавьте его!_

## Смежные темы {#related-topics}

- [Доказательство работы](/developers/docs/consensus-mechanisms/pow/)
- [Майнинг](/developers/docs/consensus-mechanisms/pow/mining/)
- [Доказательство владения](/developers/docs/consensus-mechanisms/pos/)
- [Доказательство полномочий](/developers/docs/consensus-mechanisms/poa/)
