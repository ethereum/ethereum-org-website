---
title: "Валидиум"
description: "Введение в Validium как решение для масштабирования, которое в настоящее время используется сообществом Ethereum."
lang: ru
sidebarDepth: 3
---

Валидиум — это [решение для масштабирования](/developers/docs/scaling/), которое обеспечивает целостность транзакций с помощью доказательств действительности, таких как [ZK-роллапы](/developers/docs/scaling/zk-rollups/), но не хранит данные о транзакциях в основной сети Ethereum. Несмотря на то, что доступность данных вне сети (оффчейн) сопряжена с компромиссами, она может привести к значительному улучшению масштабируемости (валидиумы могут обрабатывать [~9000 транзакций в секунду или более](https://blog.matter-labs.io/zkrollup-vs-validium-starkex-5614e38bc263)).

## Предварительные условия {#prerequisites}

Вам следует прочитать и понять нашу страницу о [масштабировании Ethereum](/developers/docs/scaling/) и [уровне 2](/layer-2).

## Что такое валидиум? {#what-is-validium}

Валидиумы — это решения для масштабирования, которые используют доступность данных и вычисления вне сети и предназначены для повышения пропускной способности за счет обработки транзакций за пределами основной сети Ethereum. Подобно роллапам с нулевым разглашением (ZK-роллапы), валидиумы публикуют [доказательства с нулевым разглашением](/glossary/#zk-proof) для проверки транзакций вне сети на Ethereum. Это предотвращает недействительные переходы состояния и повышает гарантии безопасности цепочки валидиума.

Эти "доказательства действительности" могут быть в форме ZK-SNARK (Zero-Knowledge Succinct Non-Interactive Argument of Knowledge) или ZK-STARK (Zero-Knowledge Scalable Transparent ARgument of Knowledge). Подробнее о [доказательствах с нулевым разглашением](https://consensys.net/blog/blockchain-explained/zero-knowledge-proofs-starks-vs-snarks/).

Средства, принадлежащие пользователям валидиума, контролируются смарт-контрактом на Ethereum. Валидиумы предлагают практически мгновенный вывод средств, как и ZK-роллапы; как только доказательство действительности запроса на вывод будет проверено в основной сети, пользователи смогут вывести средства, предоставив [доказательства Меркла](/developers/tutorials/merkle-proofs-for-offline-data-integrity/). Доказательство Меркла подтверждает включение транзакции пользователя на вывод средств в проверенный пакет транзакций, позволяя ончейн-контракту обработать вывод.

Однако средства пользователей валидиума могут быть заморожены, а вывод средств ограничен. Это может произойти, если менеджеры по обеспечению доступности данных в цепочке валидиума скрывают от пользователей данные о состоянии вне сети. Без доступа к данным о транзакциях пользователи не могут рассчитать доказательство Меркла, необходимое для подтверждения владения средствами и выполнения вывода средств.

Это основное различие между валидиумами и ZK-роллапами — их положение в спектре доступности данных. Оба решения по-разному подходят к хранению данных, что сказывается на безопасности и отсутствии необходимости в доверии.

## Как валидиумы взаимодействуют с Ethereum? {#how-do-validiums-interact-with-ethereum}

Валидиумы — это протоколы масштабирования, построенные на основе существующей цепи Ethereum. Хотя транзакции выполняются вне сети, цепочка валидиума управляется набором смарт-контрактов, развернутых в основной сети, включая:

1. **Контракт-верификатор**: контракт-верификатор проверяет действительность доказательств, представленных оператором валидиума при внесении обновлений состояния. Сюда входят доказательства действительности, подтверждающие правильность транзакций вне сети, и доказательства доступности данных, проверяющие существование данных о транзакциях вне сети.

2. **Основной контракт**: основной контракт хранит обязательства по состоянию (корни Меркла), представленные производителями блоков, и обновляет состояние валидиума после проверки доказательства действительности в сети. Этот контракт также обрабатывает депозиты и выводы средств из цепи валидиума.

Валидиумы также зависят от основной сети Ethereum в следующих аспектах:

### Расчет {#settlement}

Транзакции, выполненные в валидиуме, не могут быть полностью подтверждены, пока родительская цепочка не проверит их действительность. Все операции, проводимые в валидиуме, в конечном итоге должны быть рассчитаны в основной сети. Блокчейн Ethereum также предоставляет "гарантии расчета" для пользователей валидиума, что означает, что транзакции вне сети не могут быть отменены или изменены после их фиксации в сети.

### Безопасность {#security}

Ethereum, действуя как уровень расчетов, также гарантирует действительность переходов состояния в валидиуме. Транзакции вне сети, выполненные в цепи валидиума, проверяются с помощью смарт-контракта на базовом уровне Ethereum.

Если ончейн-контракт верификатора сочтет доказательство недействительным, транзакции будут отклонены. Это означает, что операторы должны удовлетворять условиям действительности, установленным протоколом Ethereum, перед обновлением состояния валидиума.

## Как работает валидиум? {#how-does-validium-work}

### Транзакции {#transactions}

Пользователи отправляют транзакции оператору — узлу, ответственному за выполнение транзакций в цепи валидиума. Некоторые валидиумы могут использовать единственного оператора для выполнения цепочки или полагаться на механизм [доказательства доли владения (PoS)](/developers/docs/consensus-mechanisms/pos/) для ротации операторов.

Оператор объединяет транзакции в пакет и отправляет его в схему доказательства для проведения доказательства. Схема доказательства принимает пакет транзакций (и другие соответствующие данные) в качестве входных данных и выдает доказательство действительности, подтверждающее, что операции были выполнены правильно.

### Обязательства по состоянию {#state-commitments}

Состояние валидиума хэшируется в виде дерева Меркла, корень которого хранится в основном контракте на Ethereum. Корень Меркла, также известный как корень состояния, действует как криптографическое обязательство по отношению к текущему состоянию аккаунтов и балансов в валидиуме.

Чтобы выполнить обновление состояния, оператор должен вычислить новый корень состояния (после выполнения транзакций) и отправить его в ончейн-контракт. Если доказательство действительности проходит проверку, предлагаемое состояние принимается, и валидиум переключается на новый корень состояния.

### Депозиты и выводы средств {#deposits-and-withdrawals}

Пользователи переводят средства из Ethereum в валидиум, внося ETH (или любой ERC-совместимый токен) в ончейн-контракт. Контракт передает событие депозита в валидиум вне сети, где на адрес пользователя зачисляется сумма, равная его депозиту. Оператор также включает эту транзакцию пополнения в новый пакет.

Чтобы вернуть средства в основную сеть, пользователь валидиума инициирует транзакцию вывода и отправляет ее оператору, который проверяет запрос на вывод и включает его в пакет. Активы пользователя в цепи валидиума также уничтожаются, прежде чем они смогут покинуть систему. После проверки доказательства действительности, связанного с пакетом, пользователь может вызвать основной контракт для вывода остатка своего первоначального депозита.

В качестве механизма защиты от цензуры протокол валидиума позволяет пользователям выводить средства непосредственно из контракта валидиума, не обращаясь к оператору. В этом случае пользователям необходимо предоставить доказательство Меркла контракту-верификатору, показывающее включение аккаунта в корень состояния. Если доказательство принято, пользователь может вызвать функцию вывода средств основного контракта, чтобы вывести свои средства из валидиума.

### Отправка пакетов {#batch-submission}

После выполнения пакета транзакций оператор представляет связанное с ним доказательство действительности в контракт-верификатор и предлагает новый корень состояния основному контракту. Если доказательство действительное, основной контракт обновляет состояние валидиума и завершает результаты транзакций в пакете.

В отличие от ZK-роллапа, производители блоков в валидиуме не обязаны публиковать данные транзакций для пакетов транзакций (только заголовки блоков). Это делает валидиум исключительно оффчейн-протоколом масштабирования, в отличие от "гибридных" протоколов масштабирования (т. е. [уровень 2](/layer-2/)), которые публикуют данные о состоянии в основной цепи Ethereum, используя данные BLOB-объектов, `calldata` или их комбинацию.

### Доступность данных {#data-availability}

Как уже упоминалось, валидиумы используют модель доступности данных вне сети, где операторы хранят все данные транзакций за пределами основной сети Ethereum. Небольшой объем данных в сети валидиума улучшает масштабируемость (пропускная способность не ограничена мощностью обработки данных Ethereum) и снижает комиссии для пользователей (стоимость публикации данных в сети ниже).

Однако доступность данных вне сети создает проблему: данные, необходимые для создания или проверки доказательств Меркла, могут быть недоступны. Это означает, что пользователи могут быть не в состоянии вывести средства из ончейн-контракта, если операторы будут действовать злонамеренно.

Различные решения на базе валидиума пытаются решить эту проблему путем децентрализации хранения данных о состоянии. Это предполагает принуждение производителей блоков к отправке базовых данных "менеджерам по доступности данных", ответственным за хранение данных вне сети и предоставление их пользователям по запросу.

Менеджеры по доступности данных в валидиуме подтверждают доступность данных для транзакций вне сети, подписывая каждый пакет валидиума. Эти подписи представляют собой форму "доказательства доступности", которую ончейн-контракт верификатора проверяет перед утверждением обновлений состояния.

Валидиумы различаются в своем подходе к управлению доступностью данных. Некоторые полагаются на доверенные стороны для хранения данных о состоянии, в то время как другие используют для этой задачи случайно назначенных валидаторов.

#### Комитет по доступности данных (DAC) {#data-availability-committee}

Чтобы гарантировать доступность данных вне сети, некоторые решения на базе валидиума назначают группу доверенных лиц, совместно именуемую комитетом по доступности данных (DAC), для хранения копий состояния и предоставления доказательства доступности данных. DAC легче реализовать, и они требуют меньшей координации, поскольку количество членов невелико.

Однако пользователи должны доверять DAC в том, что он предоставит данные, когда это необходимо (например, для генерации доказательств Меркла). Существует возможность того, что члены комитетов по доступности данных [будут скомпрометированы злоумышленником](https://notes.ethereum.org/DD7GyItYQ02d0ax_X-UbWg?view), который затем сможет скрыть данные вне сети.

[Подробнее о комитетах по доступности данных в валидиумах](https://medium.com/starkware/data-availability-e5564c416424).

#### Обеспеченная залогом доступность данных {#bonded-data-availability}

Другие валидиумы требуют, чтобы участники, ответственные за хранение данных вне сети, разместили в стейкинге (т. е. заблокировали) токены в смарт-контракте, прежде чем приступить к выполнению своих ролей. Эта ставка служит "залогом" для гарантии честного поведения среди менеджеров по доступности данных и снижает предположения о доверии. Если эти участники не смогут доказать доступность данных, их залог будет уменьшен (слешинг).

В схеме обеспеченной залогом доступности данных любой может быть назначен для хранения данных вне сети, как только он предоставит требуемую ставку. Это расширяет пул подходящих менеджеров по доступности данных, снижая централизацию, которая характерна для комитетов по доступности данных (DAC). Что еще более важно, этот подход опирается на криптоэкономические стимулы для предотвращения злонамеренной деятельности, что значительно безопаснее, чем назначение доверенных сторон для защиты данных вне сети в валидиуме.

[Подробнее об обеспеченной залогом доступности данных в валидиумах](https://blog.matter-labs.io/zkporter-a-breakthrough-in-l2-scaling-ed5e48842fbf).

## Volitions и валидиум {#volitions-and-validium}

Валидиумы предлагают много преимуществ, но сопряжены с компромиссами (в первую очередь, с доступностью данных). Но, как и многие решения для масштабирования, валидиумы подходят для конкретных вариантов использования — именно поэтому были созданы volitions.

Volitions сочетают в себе ZK-роллап и цепь валидиума и позволяют пользователям переключаться между двумя решениями для масштабирования. С помощью volitions пользователи могут использовать доступность данных вне сети валидиума для определенных транзакций, сохраняя при этом свободу переключения на решение с доступностью данных в сети (ZK-роллап) при необходимости. По сути, это дает пользователям свободу выбора компромиссов в зависимости от их уникальных обстоятельств.

Децентрализованная биржа (DEX) может предпочесть использование масштабируемой и частной инфраструктуры валидиума для сделок с высокой стоимостью. Она также может использовать ZK-роллап для пользователей, которым нужны более высокие гарантии безопасности и отсутствие необходимости в доверии, присущие ZK-роллапу.

## Валидиумы и совместимость с EVM {#validiums-and-evm-compatibility}

Как и ZK-роллапы, валидиумы в основном подходят для простых приложений, таких как обмен токенов и платежи. Поддержка общих вычислений и выполнения смарт-контрактов в валидиумах сложна в реализации, учитывая значительные накладные расходы на доказательство инструкций [EVM](/developers/docs/evm/) в схеме доказательства с нулевым разглашением.

Некоторые проекты валидиумов пытаются обойти эту проблему, компилируя EVM-совместимые языки (например, Solidity, Vyper) для создания пользовательского байт-кода, оптимизированного для эффективного доказательства. Недостатком этого подхода является то, что новые, дружественные к доказательствам с нулевым разглашением, виртуальные машины могут не поддерживать важные опкоды EVM, и разработчикам приходится писать непосредственно на языке высокого уровня для оптимальной работы. Это создает еще больше проблем: заставляет разработчиков создавать децентрализованные приложения с совершенно новым стеком разработки и нарушает совместимость с существующей инфраструктурой Ethereum.

Однако некоторые команды пытаются оптимизировать существующие опкоды EVM для схем ZK-доказательств. Это приведет к разработке виртуальной машины Ethereum с нулевым разглашением (zkEVM) — EVM-совместимой ВМ, которая производит доказательства для проверки правильности выполнения программы. С помощью zkEVM цепи валидиума могут выполнять смарт-контракты вне сети и представлять доказательства действительности для проверки вычислений вне сети (без необходимости их повторного выполнения) на Ethereum.

[Подробнее о zkEVM](https://www.alchemy.com/overviews/zkevm).

## Как валидиумы масштабируют Ethereum? {#scaling-ethereum-with-validiums}

### 1. Хранение данных вне сети {#offchain-data-storage}

Проекты масштабирования уровня 2, такие как оптимистические роллапы и ZK-роллапы, обменивают бесконечную масштабируемость чисто оффчейн-протоколов масштабирования (например, [Plasma](/developers/docs/scaling/plasma/)) на безопасность, публикуя некоторые данные о транзакциях на L1. Но это означает, что свойства масштабируемости роллапов ограничены пропускной способностью данных в основной сети Ethereum (по этой причине [шардинг данных](/roadmap/danksharding/) предлагает улучшить емкость хранения данных Ethereum).

Валидиумы достигают масштабируемости, храня все данные транзакций вне сети и публикуя только обязательства по состоянию (и доказательства действительности) при передаче обновлений состояния в основную цепь Ethereum. Существование доказательств действительности, однако, дает валидиумам более высокие гарантии безопасности, чем другим чисто оффчейн-решениям для масштабирования, включая Plasma и [сайдчейны](/developers/docs/scaling/sidechains/). Уменьшая объем данных, которые Ethereum должен обработать перед проверкой транзакций вне сети, конструкции валидиума значительно увеличивают пропускную способность в основной сети.

### 2. Рекурсивные доказательства {#recursive-proofs}

Рекурсивное доказательство — это доказательство действительности, которое проверяет действительность других доказательств. Эти "доказательства доказательств" генерируются путем рекурсивного объединения нескольких доказательств до тех пор, пока не будет создано одно окончательное доказательство, проверяющее все предыдущие доказательства. Рекурсивные доказательства масштабируют скорость обработки блокчейна за счет увеличения количества транзакций, которые могут быть проверены одним доказательством действительности.

Как правило, каждое доказательство действительности, которое оператор валидиума представляет в Ethereum для проверки, подтверждает целостность одного блока. В то время как одно рекурсивное доказательство может быть использовано для подтверждения действительности нескольких блоков валидиума одновременно — это возможно, поскольку схема доказательства может рекурсивно объединять несколько доказательств блоков в одно окончательное доказательство. Если ончейн-контракт верификатора принимает рекурсивное доказательство, все базовые блоки немедленно финализируются.

## Плюсы и минусы валидиума {#pros-and-cons-of-validium}

| Преимущества                                                                                                                                                                 | Недостатки                                                                                                                                                                                                    |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Доказательства действительности обеспечивают целостность транзакций вне сети и не позволяют операторам финализировать недействительные обновления состояния. | Создание доказательств действительности требует специального оборудования, что создает риск централизации.                                                                                    |
| Повышает эффективность капитала для пользователей (нет задержек при выводе средств обратно в Ethereum)                                                    | Ограниченная поддержка общих вычислений и смарт-контрактов; для разработки требуются специализированные языки.                                                                                |
| Неуязвимы для определенных экономических атак, с которыми сталкиваются защищенные от мошенничества системы в важных приложениях.                             | Высокая вычислительная мощность, необходимая для генерации ZK-доказательств; нерентабельно для приложений с низкой пропускной способностью.                                                   |
| Снижает плату за газ для пользователей за счет отказа от публикации calldata в основной сети Ethereum.                                                       | Более медленное субъективное время финализации (10-30 минут на создание ZK-доказательства), но более быстрое до полной финализации, поскольку нет задержки на время спора. |
| Подходит для конкретных вариантов использования, таких как торговля или блокчейн-игры, где важны конфиденциальность транзакций и масштабируемость.           | Пользователям может быть запрещено выводить средства, поскольку для создания доказательств Меркла о праве собственности требуется, чтобы данные вне сети были доступны в любое время.         |
| Доступность данных вне сети обеспечивает более высокий уровень пропускной способности и повышает масштабируемость.                                           | Модель безопасности основана на предположениях о доверии и криптоэкономических стимулах, в отличие от ZK-роллапов, которые полностью полагаются на криптографические механизмы безопасности.  |

### Используйте Validium/Volitions {#use-validium-and-volitions}

Несколько проектов предоставляют реализации Validium и volitions, которые вы можете интегрировать в свои децентрализованные приложения:

**StarkWare StarkEx** — _StarkEx — это решение для масштабирования Ethereum уровня 2 (L2), основанное на доказательствах действительности. Он может работать в режимах доступности данных ZK-Rollup или Validium._

- [Документация](https://docs.starkware.co/starkex-v4/starkex-deep-dive/data-availability-modes#validium)
- [Веб-сайт](https://starkware.co/starkex/)

**Matter Labs zkPorter** — _zkPorter — это протокол масштабирования уровня 2, решающий проблему доступности данных с помощью гибридного подхода, который сочетает в себе идеи zkRollup и шардинга. Он может поддерживать произвольное количество шардов, каждый со своей собственной политикой доступности данных._

- [Блог](https://blog.matter-labs.io/zkporter-a-breakthrough-in-l2-scaling-ed5e48842fbf)
- [Документация](https://docs.zksync.io/zksync-protocol/rollup/data-availability)
- [Веб-сайт](https://zksync.io/)

## Дополнительные материалы {#further-reading}

- [Валидиум и матрица 2х2 для уровня 2 — выпуск № 99](https://www.buildblockchain.tech/newsletter/issues/no-99-validium-and-the-layer-2-two-by-two)
- [ZK-роллапы в сравнении с Validium](https://blog.matter-labs.io/zkrollup-vs-validium-starkex-5614e38bc263)
- [Volition и возникающий спектр доступности данных](https://medium.com/starkware/volition-and-the-emerging-data-availability-spectrum-87e8bfa09bb)
- [Роллапы, валидиумы и volitions: узнайте о самых популярных решениях для масштабирования Ethereum](https://www.defipulse.com/blog/rollups-validiums-and-volitions-learn-about-the-hottest-ethereum-scaling-solutions)
- [Практическое руководство по ролл-апам Ethereum](https://web.archive.org/web/20241108192208/https://research.2077.xyz/the-practical-guide-to-ethereum-rollups)
