---
title: Абстрагирование аккаунта
description: Обзор планов Ethereum по тому, как сделать аккаунты пользователей более простыми и безопасными
lang: ru
summaryPoints:
  - Абстрагирование аккаунта позволяет упростить создание кошельков умных контрактов
  - Кошельки умных контрактов позволяют упростить управление доступом к аккаунтам Ethereum
  - Потерянные и украденные ключи могут быть восстановлены с помощью нескольких резервных копий
---

# Абстрагирование аккаунта {#account-abstraction}

Пользователи взаимодействуют с Ethereum, используя **[внешние аккаунты (EOA)](/glossary/#eoa)**. Это единственный способ отправить транзакцию или выполнить умный контракт. Эта система ограничивает пользователей в способах взаимодействия с Ethereum. Например, из-за нее становится сложным создавать партии транзакций, а также появляется необходимость всегда держать на аккаунте ETH для оплаты газа.

Абстрагирование аккаунта — один из способов решить эту проблему, дав пользователям возможность программировать свои кошельки для улучшения безопасности и упрощения процесса пользования кошельком. Это можно реализовать, [обновив внешние аккаунты](https://eips.ethereum.org/EIPS/eip-3074) таким образом, чтобы их можно было контролировать умными контрактами, либо [обновив умные контракты](https://eips.ethereum.org/EIPS/eip-2938) так, чтобы они могли инициировать транзакции. Оба этих варианта требуют изменений в протоколе Ethereum. Также есть третий способ реализации путем добавления [второй, отдельной системы транзакций](https://eips.ethereum.org/EIPS/eip-4337), работающей параллельно существующему протоколу. Вне зависимости от выбранной реализации результатом будет доступ к Ethereum через кошельки умных контрактов, либо нативно поддерживаемые в существующем протоколе, либо добавленные через дополнительную сеть для транзакций.

Кошельки умных контрактов открывают пользователю множество возможностей, например:

- Определять собственные гибкие правила безопасности
- Восстанавливать аккаунт в случае потери ключей
- Разделить доступ к аккаунту между доверенными устройствами и лицами
- Расплачиваться за чей-либо газ либо давать другим платить за ваш
- Объединять транзакции в партии (например, одобрять и выполнять обмен за раз)
- Больше возможностей для децентрализованных приложений и разработчиков кошельков, чтобы развивать опыт взаимодействия пользователей

Все эти преимущества сейчас нативно не поддерживаются, так как только внешние аккаунты [(EOA)](/glossary/#eoa) могут инициировать транзакции. EOA — это простые пары публичных и приватных ключей. Они работают следующим образом:

- Если у вас есть приватный ключ, вы можете делать _что угодно_ в рамках правил виртуальной машины Ethereum (EVM).
- Если у вас нет приватного ключа, вы не можете делать _ничего_.

Если вы потеряете свои ключи, их нельзя будет восстановить, а украденные ключи дадут похитителю полный доступ ко всем вашим средствам на аккаунте.

Кошельки умных контрактов решают эти проблемы, но в данный момент их сложно программировать, так как в конечном счете любая логика, которую они реализуют, должна переводиться в набор набор транзакций EOA, которые могут обрабатываться в Ethereum. Абстрагирование аккаунта дает возможность умным контрактам инициировать транзакции самостоятельно, поэтому любая логика, которую пользователь захочет реализовать, сможет быть запрограммирована в самом кошельке умного контракта и выполнена в Ethereum.

В конечном счете абстрагирование аккаунта улучшает поддержку кошельков умных контрактов, упрощая их разработку и делая их использование безопаснее. В перспективе абстрагирование аккаунта позволит пользователям наслаждаться всеми преимуществами Ethereum без необходимости разбираться в технологиях, которые за ними стоят, и иметь с ними дело.

## После кодовых фраз {#beyond-seed-phrases}

В настоящий момент все аккаунты защищены приватными ключами, которые вычисляются на основе кодовых фраз. Любой человек, у которого есть доступ к кодовой фразе, может без проблем получить приватный ключ, которым защищен аккаунт, и доступ ко всем средствам, которые в нем хранятся. Если приватный ключ и кодовая фраза потеряны, их невозможно будет восстановить, и все средства, которые они контролируют, будут навечно заморожены. Надежно хранить эти кодовые фразы — непростая задача даже для экспертов, а их получение с помощью фишинга — один из самых распространенных способов сделать пользователей своей жертвой.

Абстрагирование аккаунта решает эту проблему путем использования умного контракта для хранения активов и авторизации транзакций. Эти умные контракты затем можно будет дополнить собственной логикой, чтобы сделать их настолько безопасными и удобными для пользователя, насколько это возможно. В конечном счете вы все равно используете приватные ключи для доступа к вашему аккаунту, но уже с мерами безопасности, которые делают распоряжение ими проще и надежнее.

Например, в кошелек можно будет добавить резервные ключи. Если вы потеряете или случайно раскроете свой основной ключ, его можно будет без труда заменить новым с разрешением от резервных ключей. Вы можете обезопасить каждый из этих ключей по-своему или разделить их между надежными хранителями. Это усложнит потенциальному вору получение полного контроля над вашими средствами. Аналогично вы можете добавить правила в кошелек, чтобы снизить негативное воздействие в случае взлома основного ключа. Например, вы можете разрешить подтверждение мелких транзакций одной подписью, а для подтверждения более крупных транзакций требовать несколько подписей. Существуют и другие способы противодействия мошенничеству с помощью кошельков смарт-контрактов. Например, белый список позволяет блокировать все транзакции, которые отправляются на неизвестные счета или не подтверждены несколькими предварительно одобренными ключами.

### Примеры логики безопасности, которые могут быть встроены в кошелек умного контракта:

- **Авторизация через мультиподпись**. Вы можете разделить учетные данные для авторизации между несколькими доверенными лицами или устройствами. Затем контракт можно настроить так, чтобы транзакции сверх заданной суммы требовали авторизации от определенной доли доверенных сторон (например, 3/5). Например, транзакции на крупные суммы могут требовать разрешения с вашего телефона и аппаратного кошелька одновременно либо подписей от аккаунтов, распределенных среди надежных членов семьи.
- **Заморозка аккаунтов**. Если устройство потеряно или взломано, аккаунт можно заблокировать с другого авторизованного устройства, тем самым защитив средства пользователя.
- **Восстановление аккаунтов**. Потеряли устройство или забыли пароль? При нынешнем подходе это значит, что ваши средства теперь навечно заморожены. С помощью кошелька смарт-контракта вы можете настроить список аккаунтов, которые могут авторизовать новые устройства и сбрасывать доступ.
- **Установите лимиты для транзакций**. Укажите максимальную сумму, которую можно перевести со счета за день/неделю/месяц. Иными словами, если мошенник получит доступ к вашему аккаунту, он не сможет сразу украсть все средства, и у вас будет возможность заморозить и восстановить доступ.
- **Создайте белые списки**. Разрешите транзакции только на определенные адреса, в безопасности которых вы уверены. Это означает, что _даже если_ ваш секретный ключ будет украден, злоумышленник сможет отправить средства только на счета из вашего списка. Для изменения этих белых списков требуется несколько подписей, поэтому злоумышленник не сможет добавить свой собственный адрес в список, если у него нет доступа к нескольким ключам восстановления.

## Повышение удобства {#better-user-experience}

Абстрагирование учетных записей позволяет **улучшить пользовательский опыт в целом**, а также **укрепить безопасность**, потому что оно добавляет поддержку кошельков смарт-контрактов на уровне протокола. Самая важная причина этого заключается в том, что она предоставит разработчикам умных контрактов, кошельков и приложений гораздо большую свободу для инноваций, касающихся пользовательского опыта, таким образом, который еще не в состоянии предвидеть. Некоторые очевидные улучшения, которые придут вместе с абстрагированием аккаунтов, включают группирование транзакций для скорости и эффективности. Например, простой обмен должен выполняться в один клик, но сегодня для этого требуется подписать несколько транзакций, чтобы одобрить использование отдельных токенов. Абстрагирование аккаунта устраняет такое трение, позволяя группировать транзакции. Кроме того, сгруппированные транзакции могут точно утверждать правильную стоимость токенов, необходимых для каждой транзакции, а затем отзывать разрешения после завершения транзакции, обеспечивая дополнительную безопасность.

Управление газом также значительно улучшается пи абстрагировании аккаунтов. Приложения могут предлагать оплату комиссий за газ своих пользователей, а сами комиссии можно оплачивать в токенах, отличных от ЕТН, что освобождает пользователей от необходимости поддерживать баланс ЕТН для финансирования сделок. Это будет работать путем обмена токенов пользователя на ЕТН внутри контракта, а затем использования ЕТН, чтобы заплатить за газ.

<ExpandableCard title="Как абстрагирование аккаунтов поможет решить проблемы с газом?" eventCategory="/roadmap/account-abstraction" eventName="clicked how can account abstraction help with gas?">

Управление газом — одно из основных неудобств для пользователей Ethereum, главным образом потому, что ЕТН — единственный актив, который может быть использован для оплаты транзакций. Представьте, что у вас есть кошелек с балансом USDC, но в нем нет ETH. Вы не можете переместить или поменять эти токены USDC, потому что не можете оплатить газ. Вы также не можете поменять USDC на ETH, потому что это само по себе стоит газа. Для решения проблемы вам придется отправить на свой счет больше ЕТН с биржи или другого адреса. С кошельками смарт-контрактов вы сможете просто заплатить за газ в USDC, освобождая свовй аккаунт. Вам больше не нужно держать баланс ЕТН на всех ваших аккаунтах.

Абстрагирование аккаунтов также позволяет разработчикам децентрализованных приложений креативно подходить к управлению газом. Например, вы можете начать выплачивать своей любимой DEX фиксированный сбор каждый месяц за неограниченные транзакции. Децентрализованные приложения могут вам предложить выплатить все ваши комиссии за газ от вашего имени в качестве вознаграждения за использование своей платформы или пригласительного бонуса. Разработчикам будет намного легче внедрять инновации на газе, если кошельки смарт-контрактов будут поддерживаться на уровне протоколов.

</ExpandableCard>

Доверенные сессии также потенциально преобразуют пользовательский опыт, особенно в таких приложениях, как игры, где большое количество небольших транзакций может потребовать одобрения в течение короткого времени. Индивидуальное одобрение каждой сделки разрушило бы игровой процесс, но постоянное одобрение небезопасно. Кошелек смарт-контракта может утверждать определенные операции на определенное время, до определенного значения или только на определенные адреса.

Также интересно рассмотреть, как могут измениться покупки при абстрагировании аккаунтов. Сегодня каждая транзакция должна быть одобрена и выполнена из кошелька, предварительно профинансированного достаточным количеством правильного токена. С абстрагированием аккаунтов ваш опыт может стать ближе к использованию знакомых интернет-магазинов, где пользователь может наполнить «корзину» с товарами и нажать один раз, чтобы купить все сразу, при этом вся логика обрабатывается контрактом, а не пользователем.

Это лишь несколько примеров того, как абстрагирование аккаунтов может улучшить опыт пользователей, но появится еще много такого, чего мы пока не представляем. Абстрагирование аккаунтов освобождает разработчиков от ограничений современных EOA, позволяет им переносить хорошие аспекты web2 в web3 без ущерба для собственной безопасности и творчески подходить к формированию новых впечатлений у пользователей.

## Как будет внедряться абстрагирование аккаунтов? {#how-will-aa-be-implemented}

Кошельки смарт-контрактов существуют сегодня, но их трудно реализовать, потому что EVM не поддерживает их. Вместо этого они полагаются на свертывание относительно сложного кода вокруг стандартных транзакций Ethereum. Ethereum может изменить это, разрешив смарт-контрактам инициировать сделки, обрабатывать необходимую логику в смарт-контрактах Ethereum, а не вне цепи. Ввод логики в смарт-контракты также увеличивает децентрализацию Ethereum, так как она устраняет необходимость «ретрансляторов» под управлением разработчиков кошельков для перевода сообщений, подписанных пользователем на регулярные транзакции Ethereum.

<ExpandableCard title="EIP-2771: абстрагирование аккаунтов с использованием метатранзакций" eventCategory="/roadmap/account-abstract" eventName="clicked EIP-2771: account abstraction using meta-transactions">

EIP-2771 вводит концепцию метатранзакций, которые позволяют третьим сторонам оплачивать расходы пользователя на газ без внесения изменений в протокол Ethereum. Идея заключается в том, что транзакции, подписанные пользователем, отправляются в контракт «переадресатор» (Forwarder). Переадресатор — доверенное лицо, которое проверяет действительность транзакций перед их отправкой на газовое реле. Это делается вне цепи (офф-чейн), избегая необходимости платить комиссию за газ. Газовое реле передает транзакцию «получателю» (Recipient) контракта, оплачивая необходимый газ, чтобы сделать транзакцию исполняемой на Ethereum. Транзакция выполняется, если «переадресатор» известен «получателю» и пользуется его доверием. Эта модель облегчает разработчикам реализацию безгазовых транзакций для пользователей.

</ExpandableCard>

<ExpandableCard title="EIP-4337: абстрагирование аккаунта без изменения протокола Ethereum" eventCategory="/roadmap/account-abstract" eventName="clicked EIP-4337: account abstraction without changing the Ethereum protocol">

EIP-4337 — это первый шаг к поддержке нативных кошельков смарт-контрактов децентрализованным способом, <em>не требуя изменений в протоколе Ethereum</em>. Вместо внесения изменений в консенсусный уровень для поддержки кошельков смарт-контрактов новая система добавляется отдельно к сплетенному протоколу обычных транзакций. Эта система более высокого уровня построена вокруг нового объекта под названием <code>UserOperation</code> (операция пользователя), который упаковывает действия пользователя вместе с соответствующими подписями. Такие объекты <code>UserOperation</code> затем передаются в выделенный мемпул (пул памяти), где валидаторы могут собирать их в «пакет транзакций». Пакет транзакций представляет собой последовательность многих отдельных элементов <code>UserOperations</code>, может быть включен в блоки Ethereum так же, как и обычная транзакция, и будет подобран валидаторами с использованием аналогичной модели выбора с максимизацией платы.

Способ работы кошельков также изменится в соответствии с EIP-4337. Вместо повторной реализации общей, но сложной логики безопасности каждым кошельком эти функции будут переданы на глобальный контракт кошелька, известный как entry point (точка входа). Это позволит обрабатывать такие операции, как оплата комиссий и выполнение кода EVM, так что разработчики кошелька смогут сосредоточиться на предоставлении отличного пользовательского опыта.

<strong>Примечание</strong>. Контракт точки входа EIP 4337 был развернут в основной сети Ethereum 1 марта 2023 года. Вы можете увидеть этот контракт на <a href="https://etherscan.io/address/0x0576a174D229E3cFA37253523E645A78A0C91B57">Etherscan</a>.

</ExpandableCard>

<ExpandableCard title="EIP-2938: изменение протокола Ethereum для поддержки абстрагирования аккаунта" eventCategory="/roadmap/account-abstract" eventName="clicked EIP-2938: changing the Ethereum protocol to support account abstraction">

<a href="https://eips.ethereum.org/EIPS/eip-2938">EIP-2938</a> стремится обновить протокол Ethereum путем введения нового типа транзакций, <code>AA_TX_TYPE</code>, который включает три области: <code>nonce</code>, <code>target</code> и <code>data</code>, где <code>nonce</code> — это счетчик транзакций, <code>target</code> — это точка входа адреса контракта, а <code>data</code> — это байткод EVM. Для выполнения этих транзакций в EVM должны быть добавлены две новые инструкции (известные как операционный код): <code>NONCE</code> и <code>PAYGAS</code>. Операционный код <code>NONCE</code> отслеживает последовательность транзакций, а <code>PAYGAS</code> вычисляет и выводит газ, необходимый для выполнения транзакции, с баланса контракта. Эти новые функции позволяют Ethereum поддерживать кошельки смарт-контрактов нативно, поскольку необходимая инфраструктура встроена в протокол Ethereum.

Обратите внимание, что EIP-2938 в настоящее время не работает. Сейчас сообщество поддерживает EIP-4337, так как для этого не требуется изменений в протоколе.

</ExpandableCard>

<ExpandableCard title="EIP-3074: обновление внешних аккаунтов для абстрагирования аккаунтов" eventCategory="/roadmap/account-abstract" eventName="clicked EIP-3074: upgrading externally-owned accounts for account abstraction">

<a href="https://eips.ethereum.org/EIPS/eip-3074">EIP-3074</a> нацелен на обновление внешних аккаунтов Ethereum, позволяя им делегировать контроль смарт-контрактам. Это означает, что логика смарт-контрактов может утверждать операции, происходящие из EOA. Это позволило бы использовать такие функции, как спонсирование газа и группировка транзакций. Для этого в EVM необходимо добавить два новых операционных кода: <code>AUTH</code> и <code>AUTHCALL</code>. С EIP-3074 преимущества кошельков смарт-контрактов становятся доступными <em>без необходимости контракта</em>: вместо этого транзакции обрабатывает определенный тип контракта без необходимости состояния, доверия и обновлений, известный как «инициатор» (invoker).

Обратите внимание, что EIP-3074 в настоящее время не работает. Сейчас сообщество поддерживает EIP-4337, так как для этого не требуется изменений в протоколе.

</ExpandableCard>

## Текущий прогресс {#current-progress}

Кошельки смарт-контрактов уже доступны, но требуется больше обновлений, чтобы сделать их как можно более децентрализованными и избавленными от разрешений. EIP-4337 — это зрелое предложение, которое не требует никаких изменений в протоколе Ethereum, поэтому возможна его реализация в краткие сроки. Однако обновления, которые изменяют протокол Ethereum, в настоящее время не находятся в активной разработке, так что эти изменения могут занять гораздо больше времени. Также возможно, что абстрагирование аккаунтов достигается с помощью EIP-4337 достаточно хорошо, чтобы не требовать никаких изменений протокола.

## Дополнительная литература {#further-reading}

- [erc4337.io](https://www.erc4337.io/)
- [Панельное обсуждение абстрагирования аккаунтов от Devcon Bogota](https://www.youtube.com/watch?app=desktop&v=WsZBymiyT-8)
- [«Почему абстрагирование аккаунтов несет радикальные перемены для децентрализованных приложений» от Devcon Bogota](https://www.youtube.com/watch?v=OwppworJGzs)
- [«Абстрагирование аккаунтов — ELI5» от Devcon Bogota](https://www.youtube.com/watch?v=QuYZWJj65AY)
- [Заметки Виталика «Дорога к абстрагированию аккаунтов»](https://notes.ethereum.org/@vbuterin/account_abstraction_roadmap#Transaction-inclusion-lists)
- [Блог Виталика о кошельках для социального восстановления](https://vitalik.eth.limo/general/2021/01/11/recovery.html)
- [Примечания к EIP-2938](https://hackmd.io/@SamWilsn/ryhxoGp4D#What-is-EIP-2938)
- [Документация EIP-2938](https://eips.ethereum.org/EIPS/eip-2938)
- [Примечания к EIP-4337](https://medium.com/infinitism/erc-4337-account-abstraction-without-ethereum-protocol-changes-d75c9d94dc4a)
- [Документация EIP-4337](https://eips.ethereum.org/EIPS/eip-4337)
- [Документация EIP-2771](https://eips.ethereum.org/EIPS/eip-2771)
- [«Основы абстрагирования аккаунтов» — что такое абстрагирование аккаунтов, часть 1](https://www.alchemy.com/blog/account-abstraction)
