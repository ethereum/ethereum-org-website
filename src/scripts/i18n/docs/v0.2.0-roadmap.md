# v0.2.0 Roadmap: Glossary & Consistency Validation

This document outlines planned features for the next major iteration of the i18n automation system.

## Overview

v0.1.0 focused on:
- JSX attribute translation via Gemini API (fallback for Crowdin)
- Build-breaking syntax validation
- Modular architecture for standalone workflow execution

v0.2.0 will focus on **translation quality and consistency** through glossary enforcement and term validation.

---

## Planned Features

### 1. Glossary Supabase Sync (Separate Cron)

**Goal:** Keep Crowdin glossary synchronized with community-curated terms in Supabase.

**Implementation:**
- Dedicated GitHub Action running on cron schedule (e.g., daily at midnight UTC)
- Fetches glossary terms from Supabase `glossary` table
- Uploads/updates terms in Crowdin project glossary via API
- Logs sync status and any conflicts

**Files to create:**
- `src/scripts/i18n/sync-glossary.ts` - Main sync orchestrator
- `src/scripts/i18n/lib/supabase/glossary.ts` - Supabase client for glossary queries
- `.github/workflows/sync-glossary.yml` - Cron workflow

**Environment variables needed:**
- `SUPABASE_URL` - Supabase project URL
- `SUPABASE_KEY` - Supabase anon/service key
- `CROWDIN_PROJECT_ID`, `CROWDIN_API_KEY` (existing)

---

### 2. Term/Phrase Consistency Validation

**Goal:** Validate that translated files use glossary terms consistently.

**Implementation:**
- Post-translation validation step in main workflow
- Extract glossary terms from Crowdin (or local cache from sync)
- Scan translated files for source terms that should have been translated
- Flag inconsistencies in PR validation comment

**Validation rules:**
- Source term appears in translation → likely missed (should be target term)
- Target term varies within same file → inconsistent usage
- Protected terms (ethereum.org, Ethereum, etc.) → should remain unchanged

**Files to create:**
- `src/scripts/i18n/lib/validation/glossary.ts` - Glossary term validation
- Updates to `lib/workflows/validation.ts` - Integrate glossary checks

---

### 3. Confidence Scoring

**Goal:** Provide per-file and per-language confidence scores based on validation results.

**Scoring factors:**
- JSX attribute untranslated percentage (from v0.1.0)
- Glossary term consistency rate
- Syntax validation pass/fail
- Source file complexity (length, technical density)

**Output:**
- Confidence score (0-100) per file in PR comment
- Aggregate confidence per language
- Suggested review priority based on low-confidence files

**Files to create:**
- `src/scripts/i18n/lib/validation/confidence.ts` - Scoring algorithm
- Updates to PR comment formatting

---

## Architecture Considerations

### Supabase Schema (Proposed)

```sql
-- Glossary terms table
CREATE TABLE glossary (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  source_term TEXT NOT NULL,
  language_code TEXT NOT NULL,
  target_term TEXT NOT NULL,
  context TEXT, -- e.g., "technical", "UI", "marketing"
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(source_term, language_code)
);

-- Translation memory (future)
CREATE TABLE translation_memory (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  source_text TEXT NOT NULL,
  language_code TEXT NOT NULL,
  target_text TEXT NOT NULL,
  source_file TEXT,
  created_at TIMESTAMPTZ DEFAULT now()
);
```

### Crowdin API Endpoints

- `POST /projects/{projectId}/glossaries/{glossaryId}/terms` - Add/update terms
- `GET /projects/{projectId}/glossaries/{glossaryId}/terms` - List terms for validation

---

## Timeline (Tentative)

| Feature | Estimated Effort | Priority |
|---------|------------------|----------|
| Glossary Supabase sync | 2-3 days | High |
| Term consistency validation | 2-3 days | High |
| Confidence scoring | 1-2 days | Medium |
| Documentation & testing | 1-2 days | High |

---

## Dependencies

- Supabase project setup with glossary table
- Crowdin glossary ID configuration
- Community glossary data migration (if existing)

---

## Open Questions

1. Should glossary sync be bidirectional (Supabase ↔ Crowdin)?
2. What threshold for glossary inconsistency should trigger a warning vs error?
3. Should confidence scores block PR merge below a certain threshold?
4. How to handle language-specific glossary exceptions?

---

*This roadmap was created as part of the v0.1.0 development cycle. Updates will be made as requirements evolve.*
