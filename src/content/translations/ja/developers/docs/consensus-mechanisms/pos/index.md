---
title: プルーフ・オブ・ステーク(PoS)
description: イーサリアムにおけるプルーフ・オブ・ステーク (PoS)プロトコルとその役割
lang: ja
---

プルーフ・オブ・ステーク(PoS)は、イーサリアムの[合意形成のメカニズム](/developers/docs/consensus-mechanisms/)の基礎となっています。 イーサリアムは 2022 年プルーフ・オブ・ステークのメカニズムに移行しました。これまでの[プルーフ・オブ・ワーク](/developers/docs/consensus-mechanisms/pow)のアーキテクチャと比較して、より安全で、エネルギー消費量が少なく、新たなスケーリングソリューションの導入に適しています。

## 前提知識 {#prerequisites}

このページをより理解するために、まずは[合意メカニズム](/developers/docs/consensus-mechanisms/)を読むことをお勧めします。

## プルーフ・オブ・ステーク(PoS)とは {#what-is-pos}

プルーフ・オブ・ステークとは、分散型コンセンサスを実現するためにブロックチェーンが使用する[合意メカニズム](/developers/docs/consensus-mechanisms/)のことです。 プルーフ・オブ・ワークでは、マイナーがエネルギーを消費することにより自分の資本を費やします。 プルーフ・オブ・ステークでは、バリデータが ETH でイーサリアム上のスマートコントラクトに明示的に自身の資本をステーキングします。 このステーキングされた ETH は、バリデータが不正行為を行ったり、怠慢な場合は失われるため、担保として機能します。 バリデータはネットワーク上で伝播された新しいブロックが有効であることを確認し、また時折バリデータ自身が新しいブロックを作成し伝播します。

プルーフ・オブ・ステークは、現在は廃止されたプルーフ・オブ・ワークシステムに比べて、数多くの利点があります。

- エネルギー効率の向上 - プルーフ・オブ・ワークの計算に多くのエネルギーを必要としない
- ハードウェア要件の低減 - 新しいブロックを作成するのに高性能なハードウェアが不要
- 中央集権化リスクの減少 - プルーフ・オブ・ステークでは、より多くのノードの参加を促進し、ネットワークの保護につながる
- エネルギー消費量が減るため、インセンティブに必要な ETH の発行が減る
- 不正に対する経済制裁により、プルーフ・オブ・ワークと比較して 51%攻撃のコストが指数関数的に高くなる
- 51%攻撃が暗号経済の防御を乗り越えた場合でも、正当なチェーンの社会的な回復が可能

## バリデータ {#validators}

バリデータとして参加するには、デポジットコントラクトに 32 ETH を預け入れ、実行クライアント、 コンセンサスクライアント、バリデータの 3 つのソフトウェアを実行する必要があります。 ETH を預け入れたユーザーはアクティベーションキューに参加します。このアクティベーションキューは新規バリデータのネットワークへの参加率を制限するものです。 アクティベートされると、バリデータはイーサリアムネットワーク上の他のバリデータから新しいブロックを受け取ります。 ブロック内で配信されたトランザクションが再実行され、ブロックの署名が確認され、ブロックの有効性が検証されます。 その後、バリデータはネットワーク全体に対して、アテステーションと呼ばれる、ブロックを支持する票を投じます。

プルーフ・オブ・ワークの下では、ブロックのタイミングはマイニングの難易度によって決まりますが、プルーフ・オブ・ステークでは間隔は固定されています。 プルーフ・オブ・ステークのイーサリアムにおける時間は、スロット(12 秒)とエポック(32 スロット)に分かれています。 すべてのスロットで 1 つのバリデータがランダムに選択され、ブロックを提案できます。 このバリデータは新しいブロックを作成後、ネットワーク上の他のノードに新しいブロックを送信します。 また、すべてのスロットでバリデータの委員会がランダムに選択され、提案されているブロックの有効性を判断し、投票が行われます。

## ファイナリティ {#finality}

分散ネットワークにおいてトランザクションがファイナリティを持つのは、相当量の ETH が消費されなければ変更できないブロックの一部になった時です。 プルーフ・オブ・ステークのイーサリアムでは、「チェックポイント」ブロックを使用してこれが管理されています。 各エポックの最初のブロックはチェックポイントです。 バリデータが有効と認めるチェックポイントのペアに投票します。 チェックポイントのペアが、ステーキングされた ETH の少なくとも 3 分の 2 に相当する票を集めると、チェックポイントがアップグレードされます。 2 つのうちより新しいもの(ターゲット)が「正当」となります。 2 つのうちより早いもの(古いもの)は、前のエポックでターゲットだったためすでに正当化されており、 「ファイナライズ(確定)」にアップグレードされます。 ファイナライズされたブロックを元に戻そうとするには、攻撃者はステーキングされた全 ETH の少なくとも 3 分の 1 を失うことになります。 この理由については、こちらの[イーサリアム・ファウンデーションのブログ記事](https://blog.ethereum.org/2016/05/09/on-settlement-finality/)で説明されています。 ファイナリティには 3 分の 2 のマジョリティが必要なため、攻撃者はステークされた全体の 3 分の 1 にあたる投票で、ネットワークのファイナリティを阻止することができます。 これを防ぐメカニズムが[インアクティビティ・リーク](https://arxiv.org/pdf/2003.03052.pdf)で、 チェーンが 4 回以上のエポックのファイナライズに失敗したときに有効になります。 インアクティビティ・リークは、マジョリティに反する投票を行うバリデータのステーキング ETH を流出させ、3 分の 2 のマジョリティを取り戻し、チェーンをファイナライズさせます。

## 暗号経済のセキュリティ {#crypto-economic-security}

バリデータの実行はコミットメントです。 バリデータは、ブロックの検証とブロックの提案に参加するための十分なハードウェアと接続性を維持する必要があります。 報酬として、バリデータには ETH が支払われ、ステーキング残高が増加します。 一方、バリデータの参加は、個人的な利益や妨害のためにネットワークを攻撃する新しい抜け道を開くことにもなります。 これを防ぐため、呼び出されたときに参加しなかった場合、バリデータは ETH 報酬を逃し、不誠実な行動を行うとステーキングを失う仕組みをとっています。 不誠実と考えられる行動には主に 2 つあり、1 つのスロットで複数のブロックを提案すること(曖昧) と、矛盾するアテステーションを行うことです。 スラッシングされる ETH は、同時にスラッシングされるバリデータの数によって変動します。 これは[「コリレーション・ペナルティ」](https://arxiv.org/pdf/2003.03052.pdf)として知られ、バリデータが単独でステーキングの 1%弱を失う小さなペナルティから、バリデータ全員の 100%のステーキングが破棄されるようなマススラッシングイベントが起こる場合があります。 これは 1 日目の即時ペナルティ(最大 0.5 ETH)から始まり、18 日目のコリレーション・ペナルティ、最後に 36 日目のネットワークからの強制退出までの期間に課されます。 ネットワークには存在するものの、バリデータが投票に不参加のため、毎日少しづつアテステーションペナルティーが課されます。 総じて、組織的な攻撃には多大なコストがかかることを意味します。

## フォークの選択 {#fork-choice}

ネットワークが最適かつ誠実に実行されている場合は、チェーンの先頭には 1 つの新しいブロックしか存在せず、すべてのバリデータがそれにアテステーションを行います。 ただし、 ネットワークの遅延により、またはブロック提案者が曖昧であった場合、バリデータによっては、チェーンの先頭についての見解が異なりアテステーションをしない場合があります。 このため、コンセンサスクライアントはどちらを選択するのかを決めるアルゴリズムを必要とします。 プルーフ・オブ・ステークのイーサリアムで使用されるアルゴリズムは、[LMD-GHOST](https://arxiv.org/pdf/2003.03052.pdf)と呼ばれ、履歴の中で最も重みのあるフォークを選択します。

## プルーフ・オブ・ステークとセキュリティ {#pos-and-security}

[51%攻撃](https://www.investopedia.com/terms/1/51-attack.asp)の脅威は、プルーフ・オブ・ステークにも依然として存在しますが、攻撃者側のリスクのほうが非常に高くなります。 攻撃を試みるには、ステーキングされた ETH の 51%を必要とします。 自らのアテステーションを使って、攻撃者は自分に都合の良いフォークが最も票を集めるようにすることができます。 集められたアテステーションの「重み」は、コンセンサスクライアントが正しいチェーンを判断する際に使用されるため、攻撃者は自分自身のフォークが「正当な」ものにすることができます。 しかしながら、プルーフ・オブ・ワークに勝るプルーフ・オブ・ステークの強みは、コミュニティが反撃を行う柔軟性を備えていることです。 例えば、誠実なバリデータ達は攻撃者のフォークを無視し、マイノリティのチェーンを構築し続け、アプリ、取引所やプールにも同様の対応を取るように推奨することができます。 また、ネットワークから攻撃者を強制的に排除し、攻撃者がステーキングした ETH を破壊することを決定できます。 これらは 51%攻撃に対する強力な経済的防衛です。

51%攻撃は悪意のある行為の 1 つに過ぎません。 他にもロング・レンジ攻撃(ファイナリティガジェットがこの攻撃ベクトルを無効化)、ショート・レンジ再編成攻撃(ブロック提案者のブースティングとアテステーション期限により軽減)、バウンス攻撃とバランシング攻撃(これも提案者のブースティングによって緩和される上、これらの攻撃は理想的なネットワーク条件下でのみ実現)、またはアバランチ攻撃(最新メッセージのみを考慮するフォーク・チョイス・アルゴリズムによって無力化)といった攻撃があります。

総合的に、イーサリアムに実装されているプルーフ・オブ・ステークはプルーフ・オブ・ワークよりも経済的に安全であることが実証されています。

## メリットとデメリット {#pros-and-cons}

| メリット                                                                                                                                                                                          | デメリット                                                                               |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| ステーキングにより個人がネットワークの安全性に参画しやすくなり、分散化を促進。 バリデータノードは通常のラップトップで実行可能。 ステーキングプールを利用すると、32 ETH 未満でもステーキング可能。 | プルーフ・オブ・ステークは若く、プルーフ・オブ・ワークと比較して実環境でのテストが少ない |
| ステーキングはより分散型であり、 規模の経済がプルーフ・オブ・ワークのマイニングの場合と同じようには適用されない。                                                                                 | プルーフ・オブ・ステークは、プルーフ・オブ・ワークよりも実装が複雑                       |
| プルーフ・オブ・ワークと比較して、プルーフ・オブ・ステークでは暗号経済的なセキュリティが向上                                                                                                      | イーサリアムのプルーフ・オブ・ステークに参加するには、3 つのソフトウェアの実行が必要     |
| ネットワーク参加者へのインセンティブに、新規 ETH の発行が少なくて済む                                                                                                                             |                                                                                          |

## 映像による学習教材 {#visual-learner}

<YouTube id="psKDXvXdr7k" />

## 参考文献 {#further-reading}

- [プルーフ・オブ・ステークに関するよくある質問](https://vitalik.ca/general/2017/12/31/pos_faq.html) _Vitalik Buterin_
- [プルーフ・オブ・ステークとは](https://consensys.net/blog/blockchain-explained/what-is-proof-of-stake/) _ConsenSys_
- [プルーフ・オブ・ステークとは何か、またその重要性](https://bitcoinmagazine.com/culture/what-proof-of-stake-is-and-why-it-matters-1377531463) _Vitalik Buterin_
- [まず読むべきビーコンチェーンイーサリアム 2.0 の説明](https://ethos.dev/beacon-chain) _Ethos.dev_
- [プルーフ・オブ・ステークの重要性(2020 年 11 月)](https://vitalik.ca/general/2020/11/06/pos2020.html) _Vitalik Buterin_
- [プルーフ・オブ・ステーク: 低い客観性の利点](https://blog.ethereum.org/2014/11/25/proof-stake-learned-love-weak-subjectivity/) _Vitalik Buterin_
- [プルーフ・オブ・ステークのイーサリアム対する攻撃と防御](https://mirror.xyz/jmcook.eth/YqHargbVWVNRQqQpVpzrqEQ8IqwNUJDIpwRP7SS5FXs)
- [プルーフ・オブ・ステーク設計理論](https://medium.com/@VitalikButerin/a-proof-of-stake-design-philosophy-506585978d51) _Vitalik Buterin_

## 関連トピック {#related-topics}

- [プルーフ・オブ・ワーク](/developers/docs/consensus-mechanisms/pow/)
